<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="plot functions of probability pssm">

<title>pssm.plot – python-katlas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-45a6b1ee3682cc1dbb0c772b170fe9b7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="pssm.plot – python-katlas">
<meta property="og:description" content="plot functions of probability pssm">
<meta property="og:image" content="https://sky1ove.github.io/katlas/02b_pssm_plot_files/figure-html/cell-5-output-1.png">
<meta property="og:site_name" content="python-katlas">
<meta property="og:image:height" content="567">
<meta property="og:image:width" content="760">
<meta name="twitter:title" content="pssm.plot – python-katlas">
<meta name="twitter:description" content="plot functions of probability pssm">
<meta name="twitter:image" content="https://sky1ove.github.io/katlas/02b_pssm_plot_files/figure-html/cell-5-output-1.png">
<meta name="twitter:image-height" content="567">
<meta name="twitter:image-width" content="760">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">python-katlas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sky1ove/katlas"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data.html">Modules</a></li><li class="breadcrumb-item"><a href="./pssm_plot.html">pssm.plot</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get Started</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_core.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pssm.core</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_plot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">pssm.plot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_lo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pssm.lo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_pspa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pssm.pspa</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm_compare.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">pssm.compare</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hierarchical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pathway analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Train ML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Train DL</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">Heatmap</a>
  <ul class="collapse">
  <li><a href="#black-white-simple" id="toc-black-white-simple" class="nav-link" data-scroll-target="#black-white-simple">Black-white simple</a></li>
  <li><a href="#plot_heatmap_simple" id="toc-plot_heatmap_simple" class="nav-link" data-scroll-target="#plot_heatmap_simple">plot_heatmap_simple</a></li>
  <li><a href="#formal" id="toc-formal" class="nav-link" data-scroll-target="#formal">Formal</a></li>
  <li><a href="#psty2sty" id="toc-psty2sty" class="nav-link" data-scroll-target="#psty2sty">pSTY2sty</a></li>
  <li><a href="#sty2psty" id="toc-sty2psty" class="nav-link" data-scroll-target="#sty2psty">sty2pSTY</a></li>
  <li><a href="#sty2psty_df" id="toc-sty2psty_df" class="nav-link" data-scroll-target="#sty2psty_df">sty2pSTY_df</a></li>
  <li><a href="#plot_heatmap" id="toc-plot_heatmap" class="nav-link" data-scroll-target="#plot_heatmap">plot_heatmap</a></li>
  <li><a href="#two-heatmaps-comparison" id="toc-two-heatmaps-comparison" class="nav-link" data-scroll-target="#two-heatmaps-comparison">Two heatmaps comparison</a></li>
  <li><a href="#plot_two_heatmaps" id="toc-plot_two_heatmaps" class="nav-link" data-scroll-target="#plot_two_heatmaps">plot_two_heatmaps</a></li>
  </ul></li>
  <li><a href="#logo-motif" id="toc-logo-motif" class="nav-link" data-scroll-target="#logo-motif">Logo motif</a>
  <ul class="collapse">
  <li><a href="#plot_logo_raw" id="toc-plot_logo_raw" class="nav-link" data-scroll-target="#plot_logo_raw">plot_logo_raw</a></li>
  <li><a href="#change_center_name" id="toc-change_center_name" class="nav-link" data-scroll-target="#change_center_name">change_center_name</a></li>
  <li><a href="#get_pos_min_max" id="toc-get_pos_min_max" class="nav-link" data-scroll-target="#get_pos_min_max">get_pos_min_max</a></li>
  <li><a href="#scale_zero_position" id="toc-scale_zero_position" class="nav-link" data-scroll-target="#scale_zero_position">scale_zero_position</a></li>
  <li><a href="#scale_pos_neg_values" id="toc-scale_pos_neg_values" class="nav-link" data-scroll-target="#scale_pos_neg_values">scale_pos_neg_values</a></li>
  <li><a href="#convert_logo_df" id="toc-convert_logo_df" class="nav-link" data-scroll-target="#convert_logo_df">convert_logo_df</a></li>
  <li><a href="#get_logo_ic" id="toc-get_logo_ic" class="nav-link" data-scroll-target="#get_logo_ic">get_logo_IC</a></li>
  <li><a href="#plot_logo" id="toc-plot_logo" class="nav-link" data-scroll-target="#plot_logo">plot_logo</a></li>
  </ul></li>
  <li><a href="#multiple-logos" id="toc-multiple-logos" class="nav-link" data-scroll-target="#multiple-logos">Multiple logos</a>
  <ul class="collapse">
  <li><a href="#plot_logos_idx" id="toc-plot_logos_idx" class="nav-link" data-scroll-target="#plot_logos_idx">plot_logos_idx</a></li>
  <li><a href="#plot_logos" id="toc-plot_logos" class="nav-link" data-scroll-target="#plot_logos">plot_logos</a></li>
  </ul></li>
  <li><a href="#logo-motif-heatmap" id="toc-logo-motif-heatmap" class="nav-link" data-scroll-target="#logo-motif-heatmap">Logo motif + Heatmap</a>
  <ul class="collapse">
  <li><a href="#plot_logo_heatmap" id="toc-plot_logo_heatmap" class="nav-link" data-scroll-target="#plot_logo_heatmap">plot_logo_heatmap</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/sky1ove/katlas/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data.html">Modules</a></li><li class="breadcrumb-item"><a href="./pssm_plot.html">pssm.plot</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">pssm.plot</h1>
</div>

<div>
  <div class="description">
    plot functions of probability pssm
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p><strong>String Conversion Utilities</strong></p>
<p>To convert between lowercase phosphorylation notation (s/t/y) and formal notation (pS/pT/pY):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pSTY2sty(string<span class="op">=</span><span class="st">'pS-peptide-pT'</span>)  <span class="co"># converts pS/pT/pY → s/t/y</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sty2pSTY(string<span class="op">=</span><span class="st">'s-peptide-t'</span>)    <span class="co"># converts s/t/y → pS/pT/pY</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sty2pSTY_df(df<span class="op">=</span>pssm_df)           <span class="co"># applies sty→pSTY to dataframe index</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Simple Heatmaps</strong></p>
<p>To plot a basic black-and-white heatmap of PSSM values:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap_simple(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    matrix<span class="op">=</span>pssm_df,      <span class="co"># a matrix of values (positions × amino acids)</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'kinase'</span>,      <span class="co"># title displayed above heatmap</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">7</span>),     <span class="co"># (width, height) of figure</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    cmap<span class="op">=</span><span class="st">'binary'</span>,       <span class="co"># colormap, default is black &amp; white</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Formal Heatmaps</strong></p>
<p>To plot a publication-ready heatmap with diverging colors centered at zero:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    heatmap_df<span class="op">=</span>pssm_df,       <span class="co"># PSSM dataframe (positions × amino acids)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span><span class="va">None</span>,                  <span class="co"># optional matplotlib axes</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    position_label<span class="op">=</span><span class="va">True</span>,      <span class="co"># show position numbers on x-axis</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">6</span>),          <span class="co"># (width, height) of figure</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    include_zero<span class="op">=</span><span class="va">True</span>,        <span class="co"># whether to show position 0</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    scale_pos_neg<span class="op">=</span><span class="va">False</span>,      <span class="co"># use TwoSlopeNorm for balanced pos/neg scaling</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    colorbar_title<span class="op">=</span><span class="st">'Prob.'</span>,   <span class="co"># title for the colorbar</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Comparative Heatmaps</strong></p>
<p>To plot two heatmaps side-by-side for comparing kinase motifs:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot_two_heatmaps(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    pssm1<span class="op">=</span>pssm_df1,           <span class="co"># first PSSM dataframe</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    pssm2<span class="op">=</span>pssm_df2,           <span class="co"># second PSSM dataframe</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    kinase_name<span class="op">=</span><span class="st">'AKT'</span>,        <span class="co"># shared title above both plots</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    title1<span class="op">=</span><span class="st">'CDDM'</span>,            <span class="co"># title for left heatmap</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    title2<span class="op">=</span><span class="st">'PSPA'</span>,            <span class="co"># title for right heatmap</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">4</span>, <span class="fl">4.5</span>),         <span class="co"># (width, height) of figure</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    cbar<span class="op">=</span><span class="va">True</span>,                <span class="co"># show colorbars below each heatmap</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    scale_01<span class="op">=</span><span class="va">False</span>,           <span class="co"># force color scale to [0, 1] range</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Logo Motifs</strong></p>
<p>To plot a raw sequence logo from a PSSM:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plot_logo_raw(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    pssm_df<span class="op">=</span>pssm_df,      <span class="co"># PSSM dataframe (positions × amino acids)</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span><span class="va">None</span>,              <span class="co"># optional matplotlib axes</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Motif'</span>,        <span class="co"># title above the logo</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    ytitle<span class="op">=</span><span class="st">'Bits'</span>,        <span class="co"># y-axis label</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span>),      <span class="co"># (width, height) of figure</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To plot an information-content-scaled logo (recommended):</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>plot_logo(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>    pssm_df<span class="op">=</span>pssm_df,      <span class="co"># frequency PSSM dataframe</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Motif'</span>,        <span class="co"># title above the logo</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    scale_zero<span class="op">=</span><span class="va">True</span>,      <span class="co"># scale position 0 to match neighbor heights</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    ax<span class="op">=</span><span class="va">None</span>,              <span class="co"># optional matplotlib axes</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">1</span>),      <span class="co"># (width, height) of figure</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Multiple Logos</strong></p>
<p>To plot logos for specific kinases by index:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>plot_logos_idx(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    pssms_df<span class="op">=</span>pssms,       <span class="co"># dataframe with flattened PSSMs (kinases as rows)</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'AKT1'</span>, <span class="st">'AKT2'</span>,       <span class="co"># kinase IDs to plot (as positional args)</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">1</span>),      <span class="co"># (width, height) per logo</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>To plot multiple logos as subplots in one figure:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>plot_logos(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    pssms_df<span class="op">=</span>pssms.head(<span class="dv">2</span>),   <span class="co"># dataframe with flattened PSSMs</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    count_dict<span class="op">=</span><span class="va">None</span>,          <span class="co"># optional dict mapping idx → count for titles</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    path<span class="op">=</span><span class="va">None</span>,                <span class="co"># optional save path</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    prefix<span class="op">=</span><span class="st">'Motif'</span>,           <span class="co"># prefix for subplot titles</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">14</span>, <span class="dv">1</span>),          <span class="co"># (width, height) per logo</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<hr>
<p><strong>Combined Logo + Heatmap</strong></p>
<p>To plot a logo motif above its corresponding heatmap:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>plot_logo_heatmap(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    pssm_df<span class="op">=</span>pssm_df,      <span class="co"># PSSM dataframe (positions × amino acids)</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">'Kinase'</span>,       <span class="co"># title above the logo</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    figsize<span class="op">=</span>(<span class="dv">17</span>, <span class="dv">10</span>),     <span class="co"># (width, height) of combined figure</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    include_zero<span class="op">=</span><span class="va">False</span>,   <span class="co"># whether to include position 0 in heatmap</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div id="5bb1fa89" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load data for testing</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.data <span class="im">import</span> <span class="op">*</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.utils <span class="im">import</span> <span class="op">*</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.pssm.core <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="3d906ad1-52ce-4c23-b334-1eea19633680" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>Data.get_cddm()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>pssm_df <span class="op">=</span> recover_pssm(df.loc[<span class="st">'AKT1'</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="heatmap" class="level2">
<h2 class="anchored" data-anchor-id="heatmap">Heatmap</h2>
<section id="black-white-simple" class="level3">
<h3 class="anchored" data-anchor-id="black-white-simple">Black-white simple</h3>
<hr>
</section>
<section id="plot_heatmap_simple" class="level3">
<h3 class="anchored" data-anchor-id="plot_heatmap_simple">plot_heatmap_simple</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_heatmap_simple(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    matrix, <span class="co"># a matrix of values</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    title:<span class="bu">str</span><span class="op">=</span><span class="st">'heatmap'</span>, <span class="co"># title of the heatmap</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">6</span>, <span class="dv">7</span>), <span class="co"># (width, height)</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    cmap:<span class="bu">str</span><span class="op">=</span><span class="st">'binary'</span>, <span class="co"># color map, default is dark&amp;white</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    vmin:NoneType<span class="op">=</span><span class="va">None</span>, vmax:NoneType<span class="op">=</span><span class="va">None</span>, center:NoneType<span class="op">=</span><span class="va">None</span>, robust:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, annot:NoneType<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    fmt:<span class="bu">str</span><span class="op">=</span><span class="st">'.2g'</span>, annot_kws:NoneType<span class="op">=</span><span class="va">None</span>, linewidths:<span class="bu">int</span><span class="op">=</span><span class="dv">0</span>, linecolor:<span class="bu">str</span><span class="op">=</span><span class="st">'white'</span>, cbar:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    cbar_kws:NoneType<span class="op">=</span><span class="va">None</span>, cbar_ax:NoneType<span class="op">=</span><span class="va">None</span>, square:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, xticklabels:<span class="bu">str</span><span class="op">=</span><span class="st">'auto'</span>, yticklabels:<span class="bu">str</span><span class="op">=</span><span class="st">'auto'</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    mask:NoneType<span class="op">=</span><span class="va">None</span>, ax:NoneType<span class="op">=</span><span class="va">None</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot heatmap based on a matrix of values</em></p>
<div id="1cb82e81-ec7b-43d0-840a-2d6d950da405" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap_simple(pssm_df,<span class="st">'kinase'</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">7</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-5-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="formal" class="level3">
<h3 class="anchored" data-anchor-id="formal">Formal</h3>
<p>It will convert s,t,y to pS,pT,pY in the heatmap.</p>
<hr>
</section>
<section id="psty2sty" class="level3">
<h3 class="anchored" data-anchor-id="psty2sty">pSTY2sty</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> pSTY2sty(</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>    string</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Convert pS/pT/pY to s/t/y in a string.</em></p>
<hr>
</section>
<section id="sty2psty" class="level3">
<h3 class="anchored" data-anchor-id="sty2psty">sty2pSTY</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sty2pSTY(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    string</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Convert s/t/y to pS/pT/pY in a string.</em></p>
<hr>
</section>
<section id="sty2psty_df" class="level3">
<h3 class="anchored" data-anchor-id="sty2psty_df">sty2pSTY_df</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sty2pSTY_df(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Applies sty→pSTY to dataframe index</em></p>
<hr>
</section>
<section id="plot_heatmap" class="level3">
<h3 class="anchored" data-anchor-id="plot_heatmap">plot_heatmap</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_heatmap(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    heatmap_df, ax:NoneType<span class="op">=</span><span class="va">None</span>, position_label:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">5</span>, <span class="dv">6</span>), include_zero:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    scale_pos_neg:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, colorbar_title:<span class="bu">str</span><span class="op">=</span><span class="st">'Prob.'</span>, vmin:NoneType<span class="op">=</span><span class="va">None</span>, vmax:NoneType<span class="op">=</span><span class="va">None</span>, cmap:NoneType<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    center:NoneType<span class="op">=</span><span class="va">None</span>, robust:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, annot:NoneType<span class="op">=</span><span class="va">None</span>, fmt:<span class="bu">str</span><span class="op">=</span><span class="st">'.2g'</span>, annot_kws:NoneType<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    linewidths:<span class="bu">int</span><span class="op">=</span><span class="dv">0</span>, linecolor:<span class="bu">str</span><span class="op">=</span><span class="st">'white'</span>, cbar:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, cbar_kws:NoneType<span class="op">=</span><span class="va">None</span>, cbar_ax:NoneType<span class="op">=</span><span class="va">None</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    square:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, xticklabels:<span class="bu">str</span><span class="op">=</span><span class="st">'auto'</span>, yticklabels:<span class="bu">str</span><span class="op">=</span><span class="st">'auto'</span>, mask:NoneType<span class="op">=</span><span class="va">None</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot a heatmap of pssm.</em></p>
<p>This function visualizes a PSSM or log-odds matrix as a heatmap with diverging color scales centered at 0.</p>
<p><strong>Color scale behavior</strong>:</p>
<ul>
<li><p>By default (<code>scale_pos_neg=False</code>), the colormap is <strong>centered at 0</strong>, but the full data range determines the color intensity:</p>
<p><span class="math display">\[
\text{color range} = [\min(\text{data}), \max(\text{data})], \quad \text{with center at } 0
\]</span></p>
<p>This is useful when you want to emphasize whether values are <strong>above or below zero</strong>, but without enforcing symmetry.</p></li>
<li><p>If <code>scale_pos_neg=True</code>, the function uses a <strong>balanced diverging scale</strong> via <code>TwoSlopeNorm</code>, such that:</p>
<p><span class="math display">\[
\text{min color} = \min(\text{data}), \quad
\text{center} = 0, \quad
\text{max color} = \max(\text{data})
\]</span></p>
<p>The positive and negative ranges are <strong>scaled separately</strong>, ensuring that both ends of the heatmap have equal visual weight — especially helpful for symmetric data like log-odds matrices.</p></li>
</ul>
<p><strong>Additional visual features</strong>: - The center position (<span class="math inline">\(i = 0\)</span>) can be masked out using <code>include_zero=False</code>.</p>
<div id="75f47e7e-a890-479d-9225-ed89f88d80f4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap(pssm_df<span class="op">-</span><span class="fl">0.3</span>,scale_pos_neg<span class="op">=</span><span class="va">False</span>,figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">6</span>))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="7811a4e9-2ebc-4e8d-919a-12e0a2b438ad" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>plot_heatmap(pssm_df<span class="op">-</span><span class="fl">0.3</span>,scale_pos_neg<span class="op">=</span><span class="va">True</span>,figsize<span class="op">=</span>(<span class="dv">20</span>, <span class="dv">6</span>))<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="df42307a-0a7b-4db0-a33b-438e18917aeb" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>plt.close(<span class="st">'all'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="two-heatmaps-comparison" class="level3">
<h3 class="anchored" data-anchor-id="two-heatmaps-comparison">Two heatmaps comparison</h3>
<hr>
</section>
<section id="plot_two_heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="plot_two_heatmaps">plot_two_heatmaps</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_two_heatmaps(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>    pssm1, pssm2, kinase_name:<span class="bu">str</span><span class="op">=</span><span class="st">'Kinase'</span>, title1:<span class="bu">str</span><span class="op">=</span><span class="st">'CDDM'</span>, title2:<span class="bu">str</span><span class="op">=</span><span class="st">'PSPA'</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">4</span>, <span class="fl">4.5</span>),</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    cbar:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, scale_01:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span>, cbar_fontsize:<span class="bu">int</span><span class="op">=</span><span class="dv">10</span>, kwargs:VAR_KEYWORD</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot two side-by-side heatmaps with black rectangle borders,</em> titles on top, shared kinase label below, and only left plot showing y-axis labels.</p>
<div id="5ccb4651-cf00-4cb2-b1ca-f65590515999" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pssm_df2 <span class="op">=</span> pssm_df.loc[:,<span class="op">-</span><span class="dv">5</span>:<span class="dv">5</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="7c4c7659-489c-4050-a23e-026e2fb8e307" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plot_two_heatmaps(pssm_df2,pssm_df2,<span class="st">'AKT'</span>,<span class="st">'AKT1'</span>,<span class="st">'AKT2'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="logo-motif" class="level2">
<h2 class="anchored" data-anchor-id="logo-motif">Logo motif</h2>
<p>To distinguish sty from STY, sty (lowercase) in the input df are automatically converted to pS,pT,pY in logo motif.</p>
<hr>
<section id="plot_logo_raw" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_raw">plot_logo_raw</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_logo_raw(</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    pssm_df, ax:NoneType<span class="op">=</span><span class="va">None</span>, title:<span class="bu">str</span><span class="op">=</span><span class="st">'Motif'</span>, ytitle:<span class="bu">str</span><span class="op">=</span><span class="st">'Bits'</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">10</span>, <span class="dv">2</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot logo motif using Logomaker.</em></p>
<div id="affa0264-6b4f-4e27-b4dc-6de1462eadac" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>plot_logo_raw(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can find the center name is in lower case, so need to change them</p>
<hr>
</section>
<section id="change_center_name" class="level3">
<h3 class="anchored" data-anchor-id="change_center_name">change_center_name</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> change_center_name(</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    df</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Transfer the middle s,t,y to S,T,Y for plot if s,t,y have values; otherwise keep the original.</em></p>
<p>Now instead of s,t,y, the center name becomes S, T and Y:</p>
<div id="0dc43371-6ef9-493a-8e65-799f53829896" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>change_center_name(pssm_df)[<span class="dv">0</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>aa
P    0.000000
G    0.000000
A    0.000000
C    0.000000
S    0.744152
T    0.248538
V    0.000000
I    0.000000
L    0.000000
M    0.000000
F    0.000000
Y    0.007310
W    0.000000
H    0.000000
K    0.000000
R    0.000000
Q    0.000000
N    0.000000
D    0.000000
E    0.000000
s    0.000000
t    0.000000
y    0.000000
Name: 0, dtype: float64</code></pre>
</div>
</div>
<hr>
</section>
<section id="get_pos_min_max" class="level3">
<h3 class="anchored" data-anchor-id="get_pos_min_max">get_pos_min_max</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_pos_min_max(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    pssm_df</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Get min and max value of sum of positive and negative values across each position.</em></p>
<hr>
</section>
<section id="scale_zero_position" class="level3">
<h3 class="anchored" data-anchor-id="scale_zero_position">scale_zero_position</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale_zero_position(</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    pssm_df</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Scale position 0 so that:</em> - Positive values match the max positive column sum of other positions - Negative values match the min (most negative) column sum of other positions</p>
<p>This function rescales <strong>position 0</strong> in a log-odds PSSM so that its total positive and negative stack heights match those of the most extreme positions on either side.</p>
<p>This ensures the central position visually matches the dynamic range of surrounding positions in log-odds logo plots.</p>
<hr>
</section>
<section id="scale_pos_neg_values" class="level3">
<h3 class="anchored" data-anchor-id="scale_pos_neg_values">scale_pos_neg_values</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale_pos_neg_values(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    pssm_df</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Globally scale all positive values by max positive column sum,</em> and negative values by min negative column sum (preserving sign).</p>
<hr>
</section>
<section id="convert_logo_df" class="level3">
<h3 class="anchored" data-anchor-id="convert_logo_df">convert_logo_df</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_logo_df(</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    pssm_df, scale_zero:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, scale_pos_neg:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Change center name from s,t,y to S, T, Y in a pssm and scaled zero position to the max of neigbors.</em></p>
<hr>
</section>
<section id="get_logo_ic" class="level3">
<h3 class="anchored" data-anchor-id="get_logo_ic">get_logo_IC</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_logo_IC(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    pssm_df</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>For plotting purpose, calculate the scaled information content (bits) from a frequency matrix,</em> using log2(3) for the middle position and log2(len(pssm_df)) for others.</p>
<p>To visualize the motif using Logomaker, the scaled PSSM is computed by weighting each amino acid’s frequency at position <span class="math inline">\(i\)</span> by the position’s information content:</p>
<p><span class="math display">\[
\text{PSSM\_scaled}_i(x) = P_i(x) \cdot \mathrm{IC}_i
\]</span></p>
<p>This results in a matrix where the total stack height at each position equals the information content, and each letter’s height is proportional to its contribution. This is the standard format used by Logomaker to generate sequence logos.</p>
<div id="4f305edb-8648-4c9e-a354-3418ec6a3178" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>get_logo_IC(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.019253</td>
<td>0.011378</td>
<td>0.016632</td>
<td>0.014723</td>
<td>0.027341</td>
<td>0.017469</td>
<td>0.018061</td>
<td>0.020054</td>
<td>0.018999</td>
<td>0.021432</td>
<td>...</td>
<td>0.022264</td>
<td>0.016570</td>
<td>0.017585</td>
<td>0.025658</td>
<td>0.024024</td>
<td>0.024794</td>
<td>0.016453</td>
<td>0.018620</td>
<td>0.011564</td>
<td>0.017775</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.020457</td>
<td>0.011642</td>
<td>0.018254</td>
<td>0.019222</td>
<td>0.033016</td>
<td>0.012927</td>
<td>0.018462</td>
<td>0.023318</td>
<td>0.019358</td>
<td>0.020458</td>
<td>...</td>
<td>0.023748</td>
<td>0.019803</td>
<td>0.018025</td>
<td>0.017396</td>
<td>0.018739</td>
<td>0.023716</td>
<td>0.020762</td>
<td>0.014741</td>
<td>0.014455</td>
<td>0.016590</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>0.023666</td>
<td>0.015347</td>
<td>0.015820</td>
<td>0.018404</td>
<td>0.025278</td>
<td>0.020613</td>
<td>0.022074</td>
<td>0.022852</td>
<td>0.021867</td>
<td>0.025329</td>
<td>...</td>
<td>0.023748</td>
<td>0.018186</td>
<td>0.018904</td>
<td>0.027833</td>
<td>0.024505</td>
<td>0.019943</td>
<td>0.017237</td>
<td>0.011637</td>
<td>0.016383</td>
<td>0.018170</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">C</th>
<td>0.003209</td>
<td>0.003704</td>
<td>0.004462</td>
<td>0.003272</td>
<td>0.006191</td>
<td>0.004891</td>
<td>0.008428</td>
<td>0.000933</td>
<td>0.002151</td>
<td>0.003897</td>
<td>...</td>
<td>0.003463</td>
<td>0.005658</td>
<td>0.002198</td>
<td>0.004349</td>
<td>0.003844</td>
<td>0.003234</td>
<td>0.001959</td>
<td>0.003879</td>
<td>0.003212</td>
<td>0.003160</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">S</th>
<td>0.016044</td>
<td>0.007144</td>
<td>0.014198</td>
<td>0.012678</td>
<td>0.019087</td>
<td>0.009782</td>
<td>0.008830</td>
<td>0.018188</td>
<td>0.012188</td>
<td>0.020945</td>
<td>...</td>
<td>0.013853</td>
<td>0.016570</td>
<td>0.011431</td>
<td>0.013916</td>
<td>0.015376</td>
<td>0.017248</td>
<td>0.012928</td>
<td>0.014741</td>
<td>0.014134</td>
<td>0.013430</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">T</th>
<td>0.009627</td>
<td>0.005292</td>
<td>0.007707</td>
<td>0.016359</td>
<td>0.008254</td>
<td>0.010830</td>
<td>0.008428</td>
<td>0.010726</td>
<td>0.007170</td>
<td>0.008281</td>
<td>...</td>
<td>0.009400</td>
<td>0.008083</td>
<td>0.007474</td>
<td>0.010437</td>
<td>0.012012</td>
<td>0.015092</td>
<td>0.014495</td>
<td>0.009698</td>
<td>0.005782</td>
<td>0.013035</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">V</th>
<td>0.015242</td>
<td>0.008467</td>
<td>0.015415</td>
<td>0.021267</td>
<td>0.020635</td>
<td>0.013276</td>
<td>0.014850</td>
<td>0.012592</td>
<td>0.011471</td>
<td>0.007793</td>
<td>...</td>
<td>0.014843</td>
<td>0.020611</td>
<td>0.013189</td>
<td>0.021744</td>
<td>0.018258</td>
<td>0.022099</td>
<td>0.012536</td>
<td>0.014353</td>
<td>0.013170</td>
<td>0.008690</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">I</th>
<td>0.015643</td>
<td>0.007144</td>
<td>0.013792</td>
<td>0.013496</td>
<td>0.011865</td>
<td>0.008734</td>
<td>0.010034</td>
<td>0.010260</td>
<td>0.011113</td>
<td>0.009742</td>
<td>...</td>
<td>0.009400</td>
<td>0.011720</td>
<td>0.011431</td>
<td>0.006958</td>
<td>0.011532</td>
<td>0.011858</td>
<td>0.011752</td>
<td>0.013189</td>
<td>0.009637</td>
<td>0.010665</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">L</th>
<td>0.016044</td>
<td>0.012171</td>
<td>0.021905</td>
<td>0.022494</td>
<td>0.022183</td>
<td>0.018517</td>
<td>0.020067</td>
<td>0.026116</td>
<td>0.016848</td>
<td>0.023867</td>
<td>...</td>
<td>0.022759</td>
<td>0.016166</td>
<td>0.025059</td>
<td>0.020875</td>
<td>0.030751</td>
<td>0.026950</td>
<td>0.021546</td>
<td>0.021335</td>
<td>0.015098</td>
<td>0.022910</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M</th>
<td>0.003209</td>
<td>0.006086</td>
<td>0.007707</td>
<td>0.002863</td>
<td>0.005159</td>
<td>0.005590</td>
<td>0.002809</td>
<td>0.005130</td>
<td>0.003226</td>
<td>0.007306</td>
<td>...</td>
<td>0.003463</td>
<td>0.002425</td>
<td>0.006155</td>
<td>0.005654</td>
<td>0.004324</td>
<td>0.003773</td>
<td>0.005876</td>
<td>0.003491</td>
<td>0.004818</td>
<td>0.004345</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">F</th>
<td>0.004412</td>
<td>0.008202</td>
<td>0.005679</td>
<td>0.008589</td>
<td>0.008254</td>
<td>0.007686</td>
<td>0.007224</td>
<td>0.007462</td>
<td>0.008962</td>
<td>0.005845</td>
<td>...</td>
<td>0.010885</td>
<td>0.009295</td>
<td>0.008793</td>
<td>0.007393</td>
<td>0.009610</td>
<td>0.007546</td>
<td>0.003526</td>
<td>0.006594</td>
<td>0.005140</td>
<td>0.007505</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Y</th>
<td>0.003209</td>
<td>0.001852</td>
<td>0.002840</td>
<td>0.003272</td>
<td>0.007222</td>
<td>0.002795</td>
<td>0.004013</td>
<td>0.003265</td>
<td>0.003943</td>
<td>0.004871</td>
<td>...</td>
<td>0.004453</td>
<td>0.003637</td>
<td>0.003517</td>
<td>0.003479</td>
<td>0.003844</td>
<td>0.003773</td>
<td>0.005484</td>
<td>0.004267</td>
<td>0.002570</td>
<td>0.005135</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">W</th>
<td>0.004813</td>
<td>0.002646</td>
<td>0.001217</td>
<td>0.002863</td>
<td>0.002064</td>
<td>0.002446</td>
<td>0.002408</td>
<td>0.004664</td>
<td>0.002151</td>
<td>0.002435</td>
<td>...</td>
<td>0.001484</td>
<td>0.002021</td>
<td>0.002198</td>
<td>0.005219</td>
<td>0.003363</td>
<td>0.000539</td>
<td>0.002742</td>
<td>0.002327</td>
<td>0.006425</td>
<td>0.002765</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">H</th>
<td>0.003610</td>
<td>0.003175</td>
<td>0.005679</td>
<td>0.006544</td>
<td>0.007738</td>
<td>0.004542</td>
<td>0.004816</td>
<td>0.006529</td>
<td>0.008245</td>
<td>0.005358</td>
<td>...</td>
<td>0.003958</td>
<td>0.005254</td>
<td>0.009672</td>
<td>0.006958</td>
<td>0.005285</td>
<td>0.007007</td>
<td>0.004701</td>
<td>0.003491</td>
<td>0.004176</td>
<td>0.006320</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">K</th>
<td>0.015643</td>
<td>0.009261</td>
<td>0.018660</td>
<td>0.010633</td>
<td>0.027857</td>
<td>0.016420</td>
<td>0.014449</td>
<td>0.017255</td>
<td>0.014339</td>
<td>0.025816</td>
<td>...</td>
<td>0.021769</td>
<td>0.015762</td>
<td>0.027257</td>
<td>0.024354</td>
<td>0.017778</td>
<td>0.033418</td>
<td>0.021546</td>
<td>0.020947</td>
<td>0.012849</td>
<td>0.013825</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">R</th>
<td>0.016446</td>
<td>0.011642</td>
<td>0.022311</td>
<td>0.024539</td>
<td>0.030953</td>
<td>0.014324</td>
<td>0.016857</td>
<td>0.021453</td>
<td>0.016490</td>
<td>0.018996</td>
<td>...</td>
<td>0.035127</td>
<td>0.018186</td>
<td>0.027257</td>
<td>0.016961</td>
<td>0.025946</td>
<td>0.030184</td>
<td>0.016453</td>
<td>0.013577</td>
<td>0.012207</td>
<td>0.013035</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Q</th>
<td>0.012033</td>
<td>0.008996</td>
<td>0.015415</td>
<td>0.009815</td>
<td>0.008770</td>
<td>0.010132</td>
<td>0.017258</td>
<td>0.012592</td>
<td>0.010754</td>
<td>0.018022</td>
<td>...</td>
<td>0.029685</td>
<td>0.011720</td>
<td>0.010551</td>
<td>0.007828</td>
<td>0.012493</td>
<td>0.016709</td>
<td>0.010969</td>
<td>0.013965</td>
<td>0.007709</td>
<td>0.008295</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">N</th>
<td>0.008423</td>
<td>0.005557</td>
<td>0.012575</td>
<td>0.012269</td>
<td>0.013929</td>
<td>0.009782</td>
<td>0.008027</td>
<td>0.013991</td>
<td>0.010396</td>
<td>0.013151</td>
<td>...</td>
<td>0.009895</td>
<td>0.016974</td>
<td>0.007474</td>
<td>0.009133</td>
<td>0.006727</td>
<td>0.009702</td>
<td>0.008227</td>
<td>0.007370</td>
<td>0.008673</td>
<td>0.011060</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">D</th>
<td>0.017649</td>
<td>0.008996</td>
<td>0.010547</td>
<td>0.013496</td>
<td>0.019087</td>
<td>0.013276</td>
<td>0.016054</td>
<td>0.020986</td>
<td>0.013622</td>
<td>0.025329</td>
<td>...</td>
<td>0.016327</td>
<td>0.010508</td>
<td>0.018465</td>
<td>0.013916</td>
<td>0.021622</td>
<td>0.026950</td>
<td>0.011361</td>
<td>0.012025</td>
<td>0.009958</td>
<td>0.015405</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">E</th>
<td>0.020858</td>
<td>0.010848</td>
<td>0.021905</td>
<td>0.020858</td>
<td>0.025794</td>
<td>0.016770</td>
<td>0.028897</td>
<td>0.033578</td>
<td>0.013622</td>
<td>0.039941</td>
<td>...</td>
<td>0.024738</td>
<td>0.023036</td>
<td>0.021103</td>
<td>0.020440</td>
<td>0.026907</td>
<td>0.026411</td>
<td>0.018020</td>
<td>0.019395</td>
<td>0.014776</td>
<td>0.020145</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">s</th>
<td>0.008022</td>
<td>0.009790</td>
<td>0.011764</td>
<td>0.009407</td>
<td>0.010318</td>
<td>0.008036</td>
<td>0.009231</td>
<td>0.014924</td>
<td>0.008245</td>
<td>0.012177</td>
<td>...</td>
<td>0.012864</td>
<td>0.009295</td>
<td>0.012310</td>
<td>0.008698</td>
<td>0.008168</td>
<td>0.011858</td>
<td>0.009010</td>
<td>0.015904</td>
<td>0.010922</td>
<td>0.017380</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">t</th>
<td>0.004412</td>
<td>0.004234</td>
<td>0.004057</td>
<td>0.003681</td>
<td>0.003095</td>
<td>0.004192</td>
<td>0.005218</td>
<td>0.003731</td>
<td>0.004302</td>
<td>0.003897</td>
<td>...</td>
<td>0.004948</td>
<td>0.002425</td>
<td>0.007034</td>
<td>0.002609</td>
<td>0.005766</td>
<td>0.005390</td>
<td>0.003526</td>
<td>0.003491</td>
<td>0.001927</td>
<td>0.001975</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">y</th>
<td>0.003209</td>
<td>0.001852</td>
<td>0.000811</td>
<td>0.001636</td>
<td>0.000000</td>
<td>0.000699</td>
<td>0.002007</td>
<td>0.001865</td>
<td>0.001792</td>
<td>0.003897</td>
<td>...</td>
<td>0.004453</td>
<td>0.002021</td>
<td>0.001319</td>
<td>0.003044</td>
<td>0.001441</td>
<td>0.001617</td>
<td>0.003134</td>
<td>0.002327</td>
<td>0.001927</td>
<td>0.001185</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
<hr>
</section>
<section id="plot_logo" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo">plot_logo</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_logo(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    pssm_df, title:<span class="bu">str</span><span class="op">=</span><span class="st">'Motif'</span>, scale_zero:<span class="bu">bool</span><span class="op">=</span><span class="va">True</span>, ax:NoneType<span class="op">=</span><span class="va">None</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">10</span>, <span class="dv">1</span>)</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot logo of information content given a frequency PSSM.</em></p>
<div id="bdc93513-695c-48c9-9a6f-980d08670a94" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo(pssm_df,scale_zero=False,figsize=(10,1))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Set scale_zero to default True can have better vision of the side amino acids</p>
<div id="2582ad37-f02b-4b0b-954b-7ffd2bd83e24" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>plot_logo(pssm_df,title<span class="op">=</span><span class="st">'Motif'</span>,figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">1</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-28-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="ffa9058e-efc0-48af-9950-bcb72bb128a8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>plt.close(<span class="st">'all'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="multiple-logos" class="level2">
<h2 class="anchored" data-anchor-id="multiple-logos">Multiple logos</h2>
<p>As multiple figures:</p>
<hr>
<section id="plot_logos_idx" class="level3">
<h3 class="anchored" data-anchor-id="plot_logos_idx">plot_logos_idx</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_logos_idx(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    pssms_df, idxs:VAR_POSITIONAL, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">14</span>, <span class="dv">1</span>)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot logos of a dataframe with flattened PSSMs with index ad IDs.</em></p>
<div id="73dc5fd6-bef1-4e10-8d67-2e1b4cb2bff4" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pssms<span class="op">=</span>Data.get_cddm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="662d872c-7908-4dc2-8e6a-d36f7166dab9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>plot_logos_idx(pssms,<span class="st">'AKT1'</span>,<span class="st">'AKT2'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-32-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>In one figure:</p>
<hr>
</section>
<section id="plot_logos" class="level3">
<h3 class="anchored" data-anchor-id="plot_logos">plot_logos</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_logos(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    pssms_df, count_dict:NoneType<span class="op">=</span><span class="va">None</span>, <span class="co"># used to display n in motif title</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    prefix:<span class="bu">str</span><span class="op">=</span><span class="st">'Motif'</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">14</span>, <span class="dv">1</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot all logos from a dataframe of flattened PSSMs as subplots in a single figure.</em></p>
<div id="825b4703-7e4d-4182-aefa-a1cfc9780f57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>plot_logos(pssms.head(<span class="dv">2</span>),prefix<span class="op">=</span><span class="va">None</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="6965293d-62c1-457c-9580-4669b7b80e2b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>plt.close(<span class="st">'all'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="logo-motif-heatmap" class="level2">
<h2 class="anchored" data-anchor-id="logo-motif-heatmap">Logo motif + Heatmap</h2>
<hr>
<section id="plot_logo_heatmap" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_heatmap">plot_logo_heatmap</h3>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_logo_heatmap(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    pssm_df, <span class="co"># column is position, index is aa</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    title:<span class="bu">str</span><span class="op">=</span><span class="st">'Motif'</span>, figsize:<span class="bu">tuple</span><span class="op">=</span>(<span class="dv">17</span>, <span class="dv">10</span>), include_zero:<span class="bu">bool</span><span class="op">=</span><span class="va">False</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>):</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p><em>Plot logo and heatmap vertically</em></p>
<div id="7a135b3a-cd2a-4ed9-9264-735b95c0615b" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>plot_logo_heatmap(pssm_df,title<span class="op">=</span><span class="st">'Kinase'</span>,figsize<span class="op">=</span>(<span class="dv">17</span>,<span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="02b_pssm_plot_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sky1ove\.github\.io\/katlas");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sky1ove/katlas/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>