[
  {
    "objectID": "feature.html",
    "href": "feature.html",
    "title": "Feature",
    "section": "",
    "text": "This module provides tools to extract features from SMILES (chemical compounds) and protein sequences for machine learning applications.\n\nUtility Functions\nremove_hi_corr(df, thr) - Removes highly correlated features from a DataFrame based on Pearson correlation threshold. Useful for reducing multicollinearity before modeling.\ndf_cleaned = remove_hi_corr(\n    df=my_features,  # DataFrame with features as columns\n    thr=0.98,        # correlation threshold above which to drop columns\n)\npreprocess(df, thr) - Combines zero-variance removal with correlation filtering. Drops columns with no variance (e.g., constant values) and highly correlated features.\ndf_processed = preprocess(\n    df=my_features,  # DataFrame with features\n    thr=0.98,        # correlation threshold\n)\nstandardize(df) - Standardizes features to zero mean and unit variance using sklearn’s StandardScaler.\ndf_scaled = standardize(\n    df=my_features,  # DataFrame to standardize\n)\n\nCompound Features (SMILES)\nget_rdkit(SMILES) - Extracts ~200 RDKit molecular descriptors from a SMILES string.\nfeatures = get_rdkit(\n    SMILES=\"CC(=O)O\",  # SMILES representation of molecule\n)\nget_rdkit_3d(SMILES) - Extracts 3D molecular descriptors after generating a conformer using ETKDG embedding.\nfeatures_3d = get_rdkit_3d(\n    SMILES=\"CC(=O)O\",  # SMILES representation of molecule\n)\nget_rdkit_df(df, col, postprocess) - Batch extracts RDKit features (2D + 3D) from a DataFrame column containing SMILES. Optionally removes redundant features and standardizes.\nrdkit_features = get_rdkit_df(\n    df=compounds_df,   # DataFrame containing SMILES\n    col='SMILES',      # column name with SMILES strings\n    postprocess=True,  # remove redundant columns & standardize\n)\nget_morgan(df, col, radius) - Generates 2048-bit Morgan fingerprints (circular fingerprints) from SMILES.\nmorgan_fps = get_morgan(\n    df=compounds_df,  # DataFrame containing SMILES\n    col='SMILES',     # column name with SMILES strings\n    radius=3,         # radius for Morgan fingerprint\n)\n\nProtein Sequence Features - One-Hot Encoding\nonehot_encode(sequences, transform_colname, n) - Converts amino acid sequences to one-hot encoded matrix.\nencoded = onehot_encode(\n    sequences=df['site_seq'],  # iterable of AA sequences\n    transform_colname=True,    # convert column names to position format\n    n=20,                      # number of standard amino acids\n)\nonehot_encode_df(df, seq_col) - Convenience wrapper for one-hot encoding from a DataFrame.\nencoded = onehot_encode_df(\n    df=my_df,            # DataFrame with sequences\n    seq_col='site_seq',  # column name containing sequences\n)\nfilter_range_columns(df, low, high) - Filters one-hot encoded columns to specific sequence positions (e.g., -10 to +10 around a site).\nfiltered = filter_range_columns(\n    df=onehot_df,  # one-hot encoded DataFrame with position+AA column names\n    low=-10,       # minimum position to include\n    high=10,       # maximum position to include\n)\n\nClustering\nrun_kmeans(onehot, n, seed) - Performs K-means clustering on encoded data and returns cluster assignments.\nclusters = run_kmeans(\n    onehot=encoded_df,  # one-hot or other feature matrix\n    n=10,               # number of clusters\n    seed=42,            # random seed for reproducibility\n)\nget_clusters_elbow(encoded_data, max_cluster, interval) - Plots the elbow curve (WCSS vs. # clusters) to help choose optimal k.\nget_clusters_elbow(\n    encoded_data=onehot_df,  # feature matrix for clustering\n    max_cluster=400,         # maximum clusters to test\n    interval=50,             # step size between cluster counts\n)\n\nProtein Language Model Embeddings\nget_esm(df, col, model_name) - Extracts ESM2 embeddings (mean-pooled) from protein sequences. Requires GPU.\nesm_features = get_esm(\n    df=kinase_df,                      # DataFrame with protein sequences\n    col='sequence',                    # column name with AA sequences\n    model_name='esm2_t33_650M_UR50D',  # ESM2 model variant\n)\nget_t5(df, col) - Extracts ProtT5-XL-UniRef50 embeddings from protein sequences.\nt5_features = get_t5(\n    df=kinase_df,       # DataFrame with protein sequences\n    col='sequence',     # column name with AA sequences\n)\nget_t5_bfd(df, col) - Extracts ProtT5-XL-BFD embeddings (trained on Big Fantastic Database).\nt5bfd_features = get_t5_bfd(\n    df=kinase_df,       # DataFrame with protein sequences\n    col='sequence',     # column name with AA sequences\n)",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "feature.html#overview",
    "href": "feature.html#overview",
    "title": "Feature",
    "section": "",
    "text": "This module provides tools to extract features from SMILES (chemical compounds) and protein sequences for machine learning applications.\n\nUtility Functions\nremove_hi_corr(df, thr) - Removes highly correlated features from a DataFrame based on Pearson correlation threshold. Useful for reducing multicollinearity before modeling.\ndf_cleaned = remove_hi_corr(\n    df=my_features,  # DataFrame with features as columns\n    thr=0.98,        # correlation threshold above which to drop columns\n)\npreprocess(df, thr) - Combines zero-variance removal with correlation filtering. Drops columns with no variance (e.g., constant values) and highly correlated features.\ndf_processed = preprocess(\n    df=my_features,  # DataFrame with features\n    thr=0.98,        # correlation threshold\n)\nstandardize(df) - Standardizes features to zero mean and unit variance using sklearn’s StandardScaler.\ndf_scaled = standardize(\n    df=my_features,  # DataFrame to standardize\n)\n\nCompound Features (SMILES)\nget_rdkit(SMILES) - Extracts ~200 RDKit molecular descriptors from a SMILES string.\nfeatures = get_rdkit(\n    SMILES=\"CC(=O)O\",  # SMILES representation of molecule\n)\nget_rdkit_3d(SMILES) - Extracts 3D molecular descriptors after generating a conformer using ETKDG embedding.\nfeatures_3d = get_rdkit_3d(\n    SMILES=\"CC(=O)O\",  # SMILES representation of molecule\n)\nget_rdkit_df(df, col, postprocess) - Batch extracts RDKit features (2D + 3D) from a DataFrame column containing SMILES. Optionally removes redundant features and standardizes.\nrdkit_features = get_rdkit_df(\n    df=compounds_df,   # DataFrame containing SMILES\n    col='SMILES',      # column name with SMILES strings\n    postprocess=True,  # remove redundant columns & standardize\n)\nget_morgan(df, col, radius) - Generates 2048-bit Morgan fingerprints (circular fingerprints) from SMILES.\nmorgan_fps = get_morgan(\n    df=compounds_df,  # DataFrame containing SMILES\n    col='SMILES',     # column name with SMILES strings\n    radius=3,         # radius for Morgan fingerprint\n)\n\nProtein Sequence Features - One-Hot Encoding\nonehot_encode(sequences, transform_colname, n) - Converts amino acid sequences to one-hot encoded matrix.\nencoded = onehot_encode(\n    sequences=df['site_seq'],  # iterable of AA sequences\n    transform_colname=True,    # convert column names to position format\n    n=20,                      # number of standard amino acids\n)\nonehot_encode_df(df, seq_col) - Convenience wrapper for one-hot encoding from a DataFrame.\nencoded = onehot_encode_df(\n    df=my_df,            # DataFrame with sequences\n    seq_col='site_seq',  # column name containing sequences\n)\nfilter_range_columns(df, low, high) - Filters one-hot encoded columns to specific sequence positions (e.g., -10 to +10 around a site).\nfiltered = filter_range_columns(\n    df=onehot_df,  # one-hot encoded DataFrame with position+AA column names\n    low=-10,       # minimum position to include\n    high=10,       # maximum position to include\n)\n\nClustering\nrun_kmeans(onehot, n, seed) - Performs K-means clustering on encoded data and returns cluster assignments.\nclusters = run_kmeans(\n    onehot=encoded_df,  # one-hot or other feature matrix\n    n=10,               # number of clusters\n    seed=42,            # random seed for reproducibility\n)\nget_clusters_elbow(encoded_data, max_cluster, interval) - Plots the elbow curve (WCSS vs. # clusters) to help choose optimal k.\nget_clusters_elbow(\n    encoded_data=onehot_df,  # feature matrix for clustering\n    max_cluster=400,         # maximum clusters to test\n    interval=50,             # step size between cluster counts\n)\n\nProtein Language Model Embeddings\nget_esm(df, col, model_name) - Extracts ESM2 embeddings (mean-pooled) from protein sequences. Requires GPU.\nesm_features = get_esm(\n    df=kinase_df,                      # DataFrame with protein sequences\n    col='sequence',                    # column name with AA sequences\n    model_name='esm2_t33_650M_UR50D',  # ESM2 model variant\n)\nget_t5(df, col) - Extracts ProtT5-XL-UniRef50 embeddings from protein sequences.\nt5_features = get_t5(\n    df=kinase_df,       # DataFrame with protein sequences\n    col='sequence',     # column name with AA sequences\n)\nget_t5_bfd(df, col) - Extracts ProtT5-XL-BFD embeddings (trained on Big Fantastic Database).\nt5bfd_features = get_t5_bfd(\n    df=kinase_df,       # DataFrame with protein sequences\n    col='sequence',     # column name with AA sequences\n)",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "feature.html#setup",
    "href": "feature.html#setup",
    "title": "Feature",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "feature.html#utils",
    "href": "feature.html#utils",
    "title": "Feature",
    "section": "Utils",
    "text": "Utils\n\n\nremove_hi_corr\n\ndef remove_hi_corr(\n    df:DataFrame, thr:float=0.98, # threshold\n):\n\nRemove highly correlated features in a dataframe given a pearson threshold\nremove_hi_corr is a function to remove highly correlated features based on threshold of Pearson correlation between features.\n\n# Load data\ndf = Data.get_aa_rdkit()\ndf.shape\n\n\nremove_hi_corr(df,thr=0.9).shape\n\n\n\n\npreprocess\n\ndef preprocess(\n    df:DataFrame, thr:float=0.98\n):\n\nRemove features with no variance, and highly correlated features based on threshold\nThis function is similar to remove_hi_corr, but can additionaly remove features of zero variance (e.g., 1 across all samples)\n\npreprocess(df,thr=0.9).shape\n\n\n\n\nstandardize\n\ndef standardize(\n    df\n):\n\nStandardize features from a df",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "feature.html#compound-features",
    "href": "feature.html#compound-features",
    "title": "Feature",
    "section": "Compound features",
    "text": "Compound features\n\nRDKit descriptors\n\n\n\nget_rdkit\n\ndef get_rdkit(\n    SMILES\n):\n\nExtract chemical features from SMILES Reference: https://greglandrum.github.io/rdkit-blog/posts/2022-12-23-descriptor-tutorial.html\n\n\n\nget_rdkit_3d\n\ndef get_rdkit_3d(\n    SMILES\n):\n\nExtract 3d features from SMILES\n\n\n\nget_rdkit_all\n\ndef get_rdkit_all(\n    SMILES\n):\n\nExtract chemical features and 3d features from SMILES\n\n\n\nget_rdkit_df\n\ndef get_rdkit_df(\n    df, col, # column of SMILES\n    postprocess:bool=True, # remove redundant columns and standardize features for dimension reduction\n):\n\nExtract rdkit features (including 3d) from SMILES in a df\n\naa = Data.get_aa_info()\naa.head()\n\n\naa_rdkit = get_rdkit_df(aa, 'SMILES')\naa_rdkit.head()\n\n\n\nMorgan fingerprint\n\n\n\nget_morgan\n\ndef get_morgan(\n    df:DataFrame, # a dataframe that contains smiles\n    col:str='SMILES', # colname of smile\n    radius:int=3\n):\n\nGet 2048 morgan fingerprint (binary feature) from smiles in a dataframe\n\naa_morgan = get_morgan(aa, 'SMILES')\naa_morgan.head()\n\n\naa_morgan = get_morgan(aa, 'SMILES')\naa_morgan.head()",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "feature.html#protein-sequence",
    "href": "feature.html#protein-sequence",
    "title": "Feature",
    "section": "Protein sequence",
    "text": "Protein sequence\n\nOnehot\n\n\n\nonehot_encode\n\ndef onehot_encode(\n    sequences, transform_colname:bool=True, n:int=20\n):\n\n\n\n\nonehot_encode_df\n\ndef onehot_encode_df(\n    df, seq_col:str='site_seq', kwargs:VAR_KEYWORD\n):\n\n\ndf=Data.get_combine_site_psp_ochoa()\n\n\ndf_k = df.head(1000)\n\n\nonehot = onehot_encode_df(df_k, seq_col='site_seq')\nonehot\n\n\n\nKemans of onehot\n\n\n\nrun_kmeans\n\ndef run_kmeans(\n    onehot, n:int=2, seed:int=42\n):\n\nTake onehot encoded and regurn the cluster number.\n\nrun_kmeans(onehot.head(100),n=10)\n\n\nonehot\n\n\n\n\nfilter_range_columns\n\ndef filter_range_columns(\n    df, # df need to have column names of position + aa\n    low:int=-10, high:int=10\n):\n\n\nonehot_10 = filter_range_columns(onehot,low=-10,high=10)\nonehot_10\n\nPipeline:\nonehot = onehot_encode(df_k.site_seq)\nonehot_10 = filter_range_columns(onehot)\ndf_k['Cluster'] = run_kmeans(onehot_10,n=n,seed=42)\nThen plot onehot of onehot_10 with hue =‘Cluster’\n\n\nElbow method\n\n\n\nget_clusters_elbow\n\ndef get_clusters_elbow(\n    encoded_data, max_cluster:int=400, interval:int=50\n):\n\n\nget_clusters_elbow(onehot,5,2)\n\n\n\nESM2\n\n\n\nget_esm\n\ndef get_esm(\n    df:DataFrame, # DataFrame containing protein sequences\n    col:str, # column with amino acid sequences\n    model_name:str='esm2_t33_650M_UR50D', batch_size:int=1, # Number of sequences per batch\n):\n\nExtract ESM2 embeddings (mean pooled per sequence).\nESM2 model is trained on UniRef sequence. The default model in the function is esm2_t33_650M_UR50D, which is trained on UniRef50.\nUncheck below to use:\n\n# # Examples\n# df = Data.get_kinase_info().set_index('kinase')\n# sample = df[:5]\n# esmfeature = get_esm(sample,'sequence')\n# esmfeature.head()\n\n\n\nProtT5\n\n\n\nget_t5\n\ndef get_t5(\n    df:DataFrame, col:str='sequence'\n):\n\nExtract ProtT5-XL-uniref50 embeddings from protein sequence in a dataframe\nXL-uniref50 model is a t5-3b model trained on Uniref50 Dataset.\nUncheck below to use:\n\n# t5feature = get_t5(sample,'sequence')\n# t5feature.head()\n\n\n\n\nget_t5_bfd\n\ndef get_t5_bfd(\n    df:DataFrame, col:str='sequence'\n):\n\nExtract ProtT5-XL-BFD embeddings from protein sequence in a dataframe\nXL-BFD model is a t5-3b model trained on Big Fantastic Database(BFD).\nUncheck below to use:\n\n# t5bfd = get_t5_bfd(sample,'sequence')\n# t5bfd.head()",
    "crumbs": [
      "Modules",
      "Feature"
    ]
  },
  {
    "objectID": "utils.html",
    "href": "utils.html",
    "title": "Utils",
    "section": "",
    "text": "Path Handling\nTo ensure parent directories exist before saving files:\npath = prepare_path(\n    path='fig/results/my_plot.svg',  # path to create (parent dirs auto-created)\n)\nSequence Validation & Cleaning\nTo convert non-s/t/y characters to uppercase and replace invalid amino acids with underscores:\nclean_seq = check_seq(\n    seq='AAkUuPSFstTH',  # site sequence with s/t/y at center\n)  # → 'AAK__PSFstTH'\nTo batch process multiple sequences (DataFrame, Series, or list):\ndf['clean_seq'] = check_seqs(\n    data=df,        # DataFrame, Series, or list of sequences\n    col='site_seq', # column name (required if DataFrame)\n)\nSite Validation\nTo verify that a site position matches the expected residue in the protein sequence:\nis_valid = validate_site(\n    site_info='S610',    # site identifier (e.g., S610, T25, Y100)\n    seq=protein_seq,     # full protein sequence\n)\nTo validate all sites in a DataFrame:\ndf['valid'] = validate_site_df(\n    df=df,                                    # DataFrame with site and sequence info\n    site_info_col='site',                     # column containing site identifiers\n    protein_seq_col='substrate_sequence',     # column containing protein sequences\n)\nPhosphorylation\nTo mark phosphorylation sites as lowercase in a protein sequence:\nphospho_seq = phosphorylate_seq(\n    seq=protein_seq,         # full protein sequence\n    *['S95', 'S22', 'T25'],  # phosphosites to mark as lowercase\n)\nTo phosphorylate all proteins in a DataFrame (groups by protein ID and marks all sites):\ndf_phospho = phosphorylate_seq_df(\n    df=df,                          # DataFrame with protein info\n    id_col='substrate_uniprot',     # column for grouping by protein\n    seq_col='substrate_sequence',   # column with full protein sequence\n    site_col='site',                # column with site identifiers\n)\nExtract Site Sequences\nTo extract flanking sequences around phosphorylation sites (e.g., -7 to +7 residues):\ndf['site_seq'] = extract_site_seq(\n    df=df,                          # DataFrame with protein and site info\n    seq_col='substrate_phosphoseq', # column with (phosphorylated) protein sequence\n    site_col='site',                # column with site identifiers\n    n=7,                            # flanking length (-n to +n around site)\n)\nMultiple Sequence Alignment\nTo generate a FASTA file from sequences in a DataFrame:\nget_fasta(\n    df=df,                   # DataFrame with sequences\n    seq_col='kd_seq',        # column containing sequences\n    id_col='kd_ID',          # column containing sequence IDs\n    path='kinases.fasta',    # output FASTA file path\n)\nTo run Clustal Omega multiple sequence alignment:\nrun_clustalo(\n    input_fasta='kinases.fasta',  # input FASTA file\n    output_aln='kinases.aln',     # output alignment file\n    outfmt='clu',                 # output format (clustal)\n)\nTo load a Clustal alignment file as a DataFrame:\naln_df = aln2df(\n    fname='kinases.aln',  # clustal alignment file to parse\n)\nTo calculate amino acid frequencies at each position in the alignment:\nfreq_df = get_aln_freq(\n    df=aln_df,  # alignment DataFrame from aln2df\n)",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#overview",
    "href": "utils.html#overview",
    "title": "Utils",
    "section": "",
    "text": "Path Handling\nTo ensure parent directories exist before saving files:\npath = prepare_path(\n    path='fig/results/my_plot.svg',  # path to create (parent dirs auto-created)\n)\nSequence Validation & Cleaning\nTo convert non-s/t/y characters to uppercase and replace invalid amino acids with underscores:\nclean_seq = check_seq(\n    seq='AAkUuPSFstTH',  # site sequence with s/t/y at center\n)  # → 'AAK__PSFstTH'\nTo batch process multiple sequences (DataFrame, Series, or list):\ndf['clean_seq'] = check_seqs(\n    data=df,        # DataFrame, Series, or list of sequences\n    col='site_seq', # column name (required if DataFrame)\n)\nSite Validation\nTo verify that a site position matches the expected residue in the protein sequence:\nis_valid = validate_site(\n    site_info='S610',    # site identifier (e.g., S610, T25, Y100)\n    seq=protein_seq,     # full protein sequence\n)\nTo validate all sites in a DataFrame:\ndf['valid'] = validate_site_df(\n    df=df,                                    # DataFrame with site and sequence info\n    site_info_col='site',                     # column containing site identifiers\n    protein_seq_col='substrate_sequence',     # column containing protein sequences\n)\nPhosphorylation\nTo mark phosphorylation sites as lowercase in a protein sequence:\nphospho_seq = phosphorylate_seq(\n    seq=protein_seq,         # full protein sequence\n    *['S95', 'S22', 'T25'],  # phosphosites to mark as lowercase\n)\nTo phosphorylate all proteins in a DataFrame (groups by protein ID and marks all sites):\ndf_phospho = phosphorylate_seq_df(\n    df=df,                          # DataFrame with protein info\n    id_col='substrate_uniprot',     # column for grouping by protein\n    seq_col='substrate_sequence',   # column with full protein sequence\n    site_col='site',                # column with site identifiers\n)\nExtract Site Sequences\nTo extract flanking sequences around phosphorylation sites (e.g., -7 to +7 residues):\ndf['site_seq'] = extract_site_seq(\n    df=df,                          # DataFrame with protein and site info\n    seq_col='substrate_phosphoseq', # column with (phosphorylated) protein sequence\n    site_col='site',                # column with site identifiers\n    n=7,                            # flanking length (-n to +n around site)\n)\nMultiple Sequence Alignment\nTo generate a FASTA file from sequences in a DataFrame:\nget_fasta(\n    df=df,                   # DataFrame with sequences\n    seq_col='kd_seq',        # column containing sequences\n    id_col='kd_ID',          # column containing sequence IDs\n    path='kinases.fasta',    # output FASTA file path\n)\nTo run Clustal Omega multiple sequence alignment:\nrun_clustalo(\n    input_fasta='kinases.fasta',  # input FASTA file\n    output_aln='kinases.aln',     # output alignment file\n    outfmt='clu',                 # output format (clustal)\n)\nTo load a Clustal alignment file as a DataFrame:\naln_df = aln2df(\n    fname='kinases.aln',  # clustal alignment file to parse\n)\nTo calculate amino acid frequencies at each position in the alignment:\nfreq_df = get_aln_freq(\n    df=aln_df,  # alignment DataFrame from aln2df\n)",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#setup",
    "href": "utils.html#setup",
    "title": "Utils",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#common-funcs",
    "href": "utils.html#common-funcs",
    "title": "Utils",
    "section": "Common funcs",
    "text": "Common funcs\n\n\nprepare_path\n\ndef prepare_path(\n    path\n):\n\nEnsure the parent directory exists and return the full file path.\npssm_df = get_prob(df_k,'site_seq')\nplot_logo_heatmap(pssm_df,title=f'{k} (n={len(df_k):,})',figsize=(17,10))\n# check if directory exist; if not, create one, then return the full path\npath1=prepare_path(f'fig/cddm/{k}/pssm_freq.svg')\nsave_show(path1,show_only=SHOW)",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#checker",
    "href": "utils.html#checker",
    "title": "Utils",
    "section": "Checker",
    "text": "Checker\nIn many phosphorylation datsets, there are amino acids in the site sequence that are in lower case but does not belong to s/t/y. Also, there are uncommon amino acids such as U or O that appear in the sequence. Therefore, it is essential to convert the sequence string for kinase ranking.\n\n\ncheck_seq\n\ndef check_seq(\n    seq\n):\n\nConvert non-s/t/y characters to uppercase and replace disallowed characters with underscores.\n\ntry:\n    check_seq('aaadaaa')\nexcept Exception as e:\n    print(e)\n\nCenter must be s/t/y; got d in 'aaadaaa'\n\n\n\ncheck_seq('AAkUuPSFstTH') # if the center amino acid does not belong to sty/STY, will raise an error\n\n'AAK__PSFstTH'\n\n\n\n\n\ncheck_seqs\n\ndef check_seqs(\n    data, col:NoneType=None\n):\n\nConvert non-s/t/y to upper case & replace with underscore if the character is not in the allowed set\n\ndf=Data.get_human_site()\ncheck_seqs(df.head(),'site_seq')\n\n0    _MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\n1    QKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\n2    EDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKTHRAIADHLF\n3    EDCMSVPGKTHRAIADHLFWsEETKSRFTEYsMTssVMRRN\n4    RAIADHLFWsEETKSRFTEYsMTssVMRRNEQLTLHDERFE\nName: site_seq, dtype: object\n\n\n\ncheck_seqs(df['site_seq'].head())\n\n0    _MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\n1    QKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\n2    EDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKTHRAIADHLF\n3    EDCMSVPGKTHRAIADHLFWsEETKSRFTEYsMTssVMRRN\n4    RAIADHLFWsEETKSRFTEYsMTssVMRRNEQLTLHDERFE\nName: site_seq, dtype: object\n\n\n\n\n\nvalidate_site\n\ndef validate_site(\n    site_info, seq\n):\n\nValidate site position residue match with site residue.\n\nsite='S610'\nseq = 'MSVPSSLSQSAINANSHGGPALSLPLPLHAAHNQLLNAKLQATAVGPKDLRSAMGEGGGPEPGPANAKWLKEGQNQLRRAATAHRDQNRNVTLTLAEEASQEPEMAPLGPKGLIHLYSELELSAHNAANRGLRGPGLIISTQEQGPDEGEEKAAGEAEEEEEDDDDEEEEEDLSSPPGLPEPLESVEAPPRPQALTDGPREHSKSASLLFGMRNSAASDEDSSWATLSQGSPSYGSPEDTDSFWNPNAFETDSDLPAGWMRVQDTSGTYYWHIPTGTTQWEPPGRASPSQGSSPQEESQLTWTGFAHGEGFEDGEFWKDEPSDEAPMELGLKEPEEGTLTFPAQSLSPEPLPQEEEKLPPRNTNPGIKCFAVRSLGWVEMTEEELAPGRSSVAVNNCIRQLSYHKNNLHDPMSGGWGEGKDLLLQLEDETLKLVEPQSQALLHAQPIISIRVWGVGRDSGRERDFAYVARDKLTQMLKCHVFRCEAPAKNIATSLHEICSKIMAERRNARCLVNGLSLDHSKLVDVPFQVEFPAPKNELVQKFQVYYLGNVPVAKPVGVDVINGALESVLSSSSREQWTPSHVSVAPATLTILHQQTEAVLGECRVRFLSFLAVGRDVHTFAFIMAAGPASFCCHMFWCEPNAASLSEAVQAACMLRYQKCLDARSQASTSCLPAPPAESVARRVGWTVRRGVQSLWGSLKPKRLGAHTP'\n\n\nvalidate_site(site,seq)\n\n1\n\n\n\n\n\nvalidate_site_df\n\ndef validate_site_df(\n    df, site_info_col, protein_seq_col\n):\n\nValidate site position residue match with site residue in a dataframe.\n\nvalidate_site_df(df.head(),'site','substrate_sequence')\n\n0    1\n1    1\n2    1\n3    1\n4    1\ndtype: int64",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#phosphorylate-protein-seq",
    "href": "utils.html#phosphorylate-protein-seq",
    "title": "Utils",
    "section": "Phosphorylate protein seq",
    "text": "Phosphorylate protein seq\n\n\nphosphorylate_seq\n\ndef phosphorylate_seq(\n    seq, # full protein sequence\n    sites:VAR_POSITIONAL, # site info, e.g., S140\n):\n\nPhosphorylate protein sequence based on phosphosites (e.g.,S140).\n\nseq = 'MSKSESPKEPEQLRKLFIGGLSFETTDESLRSHFEQWGTLTDCVVMRDPNTKRSRGFGFVTYATVEEVDAAMNARPHKVDGRVVEPKRAVSREDSQRPDAHLTVKKIFVGGIKEDTEEHHLRDYFEQYGKIEVIEIMTDRGSGKKRGFAFVTFDDHDSVDKIVIQKYHTVNGHNCEVRKALSKQEMASASSSQRGRSGSGNFGGGRGGGFGGNDNFGRGGNFSGRGGFGGSRGGGGYGGSGDGYNGFGNDGSNFGGGGSYNDFGNYNNQSSNFGPMKGGNFEGRSSGPHGGGGQYFAKPRNQGGYGGSSSSSSYGSGRRF'\nphosphorylate_seq(seq,*['S95', 'S22', 'T25', 'S6', 'S158'])\n\n'MSKSEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTDCVVMRDPNTKRSRGFGFVTYATVEEVDAAMNARPHKVDGRVVEPKRAVSREDsQRPDAHLTVKKIFVGGIKEDTEEHHLRDYFEQYGKIEVIEIMTDRGSGKKRGFAFVTFDDHDsVDKIVIQKYHTVNGHNCEVRKALSKQEMASASSSQRGRSGSGNFGGGRGGGFGGNDNFGRGGNFSGRGGFGGSRGGGGYGGSGDGYNGFGNDGSNFGGGGSYNDFGNYNNQSSNFGPMKGGNFEGRSSGPHGGGGQYFAKPRNQGGYGGSSSSSSYGSGRRF'\n\n\n\n\n\nphosphorylate_seq_df\n\ndef phosphorylate_seq_df(\n    df, id_col:str='substrate_uniprot', # column of sequence ID\n    seq_col:str='substrate_sequence', # column that contains protein sequence\n    site_col:str='site', # column that contains site info, e.g., S140\n):\n\nPhosphorylate whole sequence based on phosphosites in a dataframe\n\ndf=Data.get_human_site()\ndf.head()\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsubstrate_genes\nsite\nsource\nAM_pathogenicity\nsubstrate_sequence\nsubstrate_species\nsub_site\nsubstrate_phosphoseq\nposition\nsite_seq\n\n\n\n\n0\nA0A024R4G9\nC19orf48 MGC13170 hCG_2008493\nS20\npsp\nNaN\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nHomo sapiens (Human)\nA0A024R4G9_S20\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n20\n_MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\n\n\n1\nA0A075B6Q4\nNone\nS24\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S24\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n24\nQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\n\n\n2\nA0A075B6Q4\nNone\nS35\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S35\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n35\nEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKTHRAIADHLF\n\n\n3\nA0A075B6Q4\nNone\nS57\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S57\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n57\nEDCMSVPGKTHRAIADHLFWsEETKSRFTEYsMTssVMRRN\n\n\n4\nA0A075B6Q4\nNone\nS68\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S68\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n68\nRAIADHLFWsEETKSRFTEYsMTssVMRRNEQLTLHDERFE\n\n\n\n\n\n\n\n\nphosphorylate_seq_df(df.head(100),'substrate_uniprot','substrate_sequence','site')\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsite\nsubstrate_sequence\nphosphoseq\n\n\n\n\n0\nA0A024R4G9\n[S20]\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n\n\n1\nA0A075B6Q4\n[S24, S35, S57, S68, S71, S72]\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n\n\n...\n...\n...\n...\n...\n\n\n22\nA0A0A6YYL6\n[S5, Y139, S141, S142]\nMVRYSLDPENPTKSCKSRGSNLRVHFKNTRETAQAIKGMHIRKATK...\nMVRYsLDPENPTKSCKSRGSNLRVHFKNTRETAQAIKGMHIRKATK...\n\n\n23\nA0A0B4J1R7\n[T6, S43, S45, S46]\nMMATGTPESQARFGQSVKGLLTEKVTTCGTDVIALTKQVLKGSRSS...\nMMATGtPESQARFGQSVKGLLTEKVTTCGTDVIALTKQVLKGsRss...\n\n\n\n\n24 rows × 4 columns",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#extract-site-seq",
    "href": "utils.html#extract-site-seq",
    "title": "Utils",
    "section": "Extract site seq",
    "text": "Extract site seq\n\n\nextract_site_seq\n\ndef extract_site_seq(\n    df:DataFrame, # dataframe that contains protein sequence\n    seq_col:str, # column name of protein sequence\n    site_col:str, # column name of site information (e.g., S10)\n    n:int=7, # length of surrounding sequence (default -7 to +7)\n):\n\nExtract -n to +n site sequence from protein sequence\nAs some datasets only contains protein information and position of phosphorylation sites, but not phosphorylation site sequence, we can retreive protein sequence and use this function to get -7 to +7 phosphorylation site sequence (as numpy array).\nRemember to validate the phospho-acceptor at position 0 before extract the site sequence, as there could be mismatch due to the protein sequence database updates.\n\ndf.head()\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsubstrate_genes\nsite\nsource\nAM_pathogenicity\nsubstrate_sequence\nsubstrate_species\nsub_site\nsubstrate_phosphoseq\nposition\nsite_seq\n\n\n\n\n0\nA0A024R4G9\nC19orf48 MGC13170 hCG_2008493\nS20\npsp\nNaN\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nHomo sapiens (Human)\nA0A024R4G9_S20\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n20\n_MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\n\n\n1\nA0A075B6Q4\nNone\nS24\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S24\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n24\nQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\n\n\n2\nA0A075B6Q4\nNone\nS35\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S35\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n35\nEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKTHRAIADHLF\n\n\n3\nA0A075B6Q4\nNone\nS57\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S57\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n57\nEDCMSVPGKTHRAIADHLFWsEETKSRFTEYsMTssVMRRN\n\n\n4\nA0A075B6Q4\nNone\nS68\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S68\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n68\nRAIADHLFWsEETKSRFTEYsMTssVMRRNEQLTLHDERFE\n\n\n\n\n\n\n\n\nextract_site_seq(df.head(),\n                 seq_col='substrate_sequence',\n                 site_col='site',\n                 n=30\n                 )\n\n100%|██████████| 5/5 [00:00&lt;00:00, 13408.90it/s]\n\n\narray(['___________MTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSHTPRR',\n       '_______MDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKTHRAIADHL',\n       'KSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKTHRAIADHLFWSEETKSRFT',\n       'DYDSAGLLSDEDCMSVPGKTHRAIADHLFWSEETKSRFTEYSMTSSVMRRNEQLTLHDERF',\n       'DCMSVPGKTHRAIADHLFWSEETKSRFTEYSMTSSVMRRNEQLTLHDERFEKFYEQYDDDE'],\n      dtype='&lt;U61')",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "utils.html#alignment",
    "href": "utils.html#alignment",
    "title": "Utils",
    "section": "Alignment",
    "text": "Alignment\n\n\nget_fasta\n\ndef get_fasta(\n    df, seq_col:str='kd_seq', id_col:str='kd_ID', path:str='out.fasta'\n):\n\nGenerate fasta file from sequences.\nget_fasta(kd,seq_col='kd_seq',id_col='kd_ID',path='raw/kinase_domains.fasta')\nTo run clustalo alignment, can run either through terminal or the function\nsudo apt-get update\nsudo apt-get install clustalo\nclustalo -i kinase_domains.fasta -o kinase_domains.aln --force --outfmt=clu\n\n\n\nrun_clustalo\n\ndef run_clustalo(\n    input_fasta, # .fasta fname\n    output_aln, # .aln output fname\n    outfmt:str='clu'\n):\n\nRun Clustal Omega to perform multiple sequence alignment.\nrun_clustalo(\"kinase_domains.fasta\", \"raw/kinase_domains.aln\")\n\n\n\naln2df\n\ndef aln2df(\n    fname\n):\n\ndf = aln2df(\"raw/kinase_domains.aln\")\n\n\n\nget_aln_freq\n\ndef get_aln_freq(\n    df\n):\n\nGet frequency of each amino acid across each position from the aln2df output.\nfreq_df = get_aln_freq(df)",
    "crumbs": [
      "Modules",
      "Utils"
    ]
  },
  {
    "objectID": "plot.html",
    "href": "plot.html",
    "title": "Plot",
    "section": "",
    "text": "Utilities\nTo set seaborn resolution for notebook display:\nset_sns(\n    dpi=300,  # resolution for figure display\n)\nTo save plot as SVG with editable text:\nsave_svg(\n    path='figure.svg',  # output file path\n)\nTo save plot as PDF with Illustrator-compatible fonts:\nsave_pdf(\n    path='figure.pdf',  # output file path\n)\nTo show plot or save to file:\nsave_show(\n    path='figure.png',  # image path; if None, calls plt.show()\n    show_only=False,    # if True, always show instead of save\n)\n\nColor & Palette\nTo assign colors to a list of category names:\ncolor_dict = get_color_dict(\n    categories=['A', 'B', 'C'],  # list of names to assign colors\n    palette='tab20',             # seaborn palette name\n)\nTo get a list of colors for plotting from a dict, list, or palette name:\ncolors = get_plt_color(\n    palette=color_dict,  # dict, list, or palette name like 'tab10'\n    columns=df.columns,  # column names to match colors\n)\nTo filter hue categories by count threshold (for cleaner plots):\nhue_big = get_hue_big(\n    df=info,        # dataframe containing categories\n    hue_col='group',  # column name for hue\n    cnt_thr=10,     # minimum count to include category\n)\n\nDimensionality Reduction\nTo reduce dimensionality using PCA, TSNE, or UMAP:\nembedding_df = reduce_feature(\n    df=df,           # dataframe of values\n    method='pca',    # 'pca', 'tsne', or 'umap'\n    complexity=20,   # perplexity for TSNE, n_neighbors for UMAP\n    n=2,             # number of components\n    load=None,       # path to load pre-trained model\n    save=None,       # path to save trained model\n    seed=123,        # random state for reproducibility\n)\n\n2D Scatter Plots\nTo plot a 2D scatter from pre-computed embeddings:\nplot_2d(\n    embedding_df=feat,     # dataframe with 2 columns (e.g., PCA1, PCA2)\n    hue=info['group'],     # series/list for coloring points\n    palette='tab20',       # color palette\n    legend=True,           # show legend\n    legend_title='Group',  # custom legend title\n    name_list=None,        # list of names to annotate points\n    s=20,                  # dot size\n)\nTo reduce dimensions and plot in one step:\nplot_cluster(\n    df=df,              # dataframe of values\n    method='umap',      # 'pca', 'tsne', or 'umap'\n    hue=info['group'],  # series for coloring\n    complexity=15,      # perplexity/n_neighbors\n    palette='tab20',    # color palette\n    legend=True,        # show legend\n    name_list=None,     # list of names to annotate\n    seed=123,           # random state\n    s=50,               # dot size\n)\nTo create an interactive Bokeh plot with search box:\nplot_bokeh(\n    X=embedding_df,       # 2-column dataframe from reduce_feature\n    idx=info['Name'],     # identity labels for search\n    hue=info['Group'],    # category for coloring\n    s=7,                  # dot size\n    smiles=info['SMILES'], # additional hover info (kwargs)\n)\n\nRank & Distribution\nTo plot ranked values with top/bottom annotations:\nplot_rank(\n    sorted_df=sorted_df,  # pre-sorted dataframe\n    x='kinase',           # column for x-axis labels\n    y='values',           # column for y-axis values\n    n_hi=10,              # number of top values to label\n    n_lo=10,              # number of bottom values to label\n    figsize=(10, 8),      # figure size\n)\nTo plot a histogram with KDE:\nplot_hist(\n    df=sorted_df,      # dataframe with values\n    x='values',        # column name for histogram\n    figsize=(6, 2),    # figure size\n)\n\nBar & Box Plots\nTo plot horizontal bar counts from value_counts:\nplot_count(\n    cnt=df['col'].value_counts(),  # value counts series\n    tick_spacing=10,               # x-axis tick interval\n    palette='tab20',               # color palette\n)\nTo plot bar graph with optional strip dots:\nplot_bar(\n    df=info,           # unstacked dataframe\n    value='MW',        # column name for values\n    group='category',  # column name for grouping\n    title='Title',     # plot title\n    figsize=(12, 5),   # figure size\n    dots=True,         # add strip dots\n    rotation=90,       # x-tick rotation\n    ascending=False,   # sort order\n)\nTo plot grouped bar chart for multiple value columns:\nplot_group_bar(\n    df=info,                    # dataframe\n    value_cols=['pKa1', 'pKb2'],  # list of value columns\n    group='Name',               # grouping column\n    figsize=(12, 5),            # figure size\n    order=None,                 # custom x-axis order\n    rotation=90,                # x-tick rotation\n)\nTo plot box plot with optional dots:\nplot_box(\n    df=info,           # dataframe\n    value='MW',        # value column\n    group='category',  # grouping column\n    figsize=(6, 3),    # figure size\n    dots=True,         # show individual points\n    rotation=90,       # x-tick rotation\n)\n\nViolin Plot\nTo plot violin plot with optional strip dots:\nax = plot_violin(\n    data=df_long,        # long-form dataframe\n    value='value',       # column for values\n    group='variable',    # column for grouping\n    ylabel='Accuracy',   # y-axis label\n    dots=True,           # add strip dots\n    figsize=(5, 3),      # figure size\n)\nTo add statistical annotations to violin/box plots:\nadd_stats(\n    ax=ax,                 # axes from plot_violin\n    data=df_long,          # same dataframe\n    value='value',         # value column\n    group='variable',      # group column\n    pairs=None,            # comparison pairs (auto-generated if None)\n    test='t-test_ind',     # statistical test\n    text_format='star',    # annotation format ('star' or 'simple')\n)\n\nCorrelation & Heatmap\nTo plot correlation scatter with Spearman/Pearson stats:\nplot_rel(\n    df=norm,                   # dataframe with columns to correlate\n    x='AAK1',                  # x-axis column\n    y='BIKE',                  # y-axis column\n    method='spearman',         # 'spearman' or 'pearson'\n    text_location=(0.8, 0.1),  # position for stats text\n    index_list=None,           # indices to annotate\n    hue=None,                  # optional hue column\n    reg_line=True,             # show regression line\n)\nTo calculate distance/similarity matrices:\ndist_df, sim_df = get_similarity(\n    df=df,              # dataframe of features\n    metric='euclidean',  # distance metric\n)\nTo plot correlation/similarity heatmap:\nplot_corr(\n    df_corr=corr,          # correlation matrix\n    inverse_color=False,   # reverse colormap\n    figsize=(15, 10),      # figure size\n)\n\nEvaluation Metrics\nTo plot AUCDF (Area Under CDF) for ranking evaluation:\naucdf = get_AUCDF(\n    df=sorted_df,                   # dataframe with rank values\n    col='values',                   # column name for ranks\n    reverse=False,                  # reverse CDF direction\n    plot=True,                      # show plot\n    xlabel='Rank of reported kinase',  # x-axis label\n)\nTo plot normalized confusion matrix:\nplot_confusion_matrix(\n    target=y_true,            # true labels\n    pred=y_pred,              # predicted labels\n    class_names=['0', '1'],   # class label names\n    normalize=True,           # normalize by row\n    title='Confusion matrix',  # plot title\n    cmap=plt.cm.Blues,        # colormap\n)\n\nPie & Composition\nTo plot pie chart from value counts:\nplot_pie(\n    value_counts=df['col'].value_counts(),  # value counts series\n    hue_order=None,        # custom category order\n    labeldistance=1,       # label distance from center\n    fontsize=10,           # label font size\n    fontcolor='black',     # label color\n    palette='tab20',       # color palette\n    figsize=(4, 3),        # figure size\n)\nTo plot stacked bar showing composition percentages:\nplot_composition(\n    df=df,                # dataframe\n    bin_col='bin',        # column for x-axis bins\n    hue_col='category',   # column for stacked hue\n    palette='tab20',      # color palette\n    legend_title='Type',  # legend title\n    rotate=45,            # x-tick rotation\n    xlabel=None,          # x-axis label\n    ylabel='Percentage',  # y-axis label\n    figsize=(5, 3),       # figure size\n)\nTo plot bar count with value labels on top:\nplot_cnt(\n    cnt=df['col'].value_counts(),  # value counts series\n    xlabel=None,                   # x-axis label\n    ylabel='Count',                # y-axis label\n    figsize=(6, 3),                # figure size\n)",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#overview",
    "href": "plot.html#overview",
    "title": "Plot",
    "section": "",
    "text": "Utilities\nTo set seaborn resolution for notebook display:\nset_sns(\n    dpi=300,  # resolution for figure display\n)\nTo save plot as SVG with editable text:\nsave_svg(\n    path='figure.svg',  # output file path\n)\nTo save plot as PDF with Illustrator-compatible fonts:\nsave_pdf(\n    path='figure.pdf',  # output file path\n)\nTo show plot or save to file:\nsave_show(\n    path='figure.png',  # image path; if None, calls plt.show()\n    show_only=False,    # if True, always show instead of save\n)\n\nColor & Palette\nTo assign colors to a list of category names:\ncolor_dict = get_color_dict(\n    categories=['A', 'B', 'C'],  # list of names to assign colors\n    palette='tab20',             # seaborn palette name\n)\nTo get a list of colors for plotting from a dict, list, or palette name:\ncolors = get_plt_color(\n    palette=color_dict,  # dict, list, or palette name like 'tab10'\n    columns=df.columns,  # column names to match colors\n)\nTo filter hue categories by count threshold (for cleaner plots):\nhue_big = get_hue_big(\n    df=info,        # dataframe containing categories\n    hue_col='group',  # column name for hue\n    cnt_thr=10,     # minimum count to include category\n)\n\nDimensionality Reduction\nTo reduce dimensionality using PCA, TSNE, or UMAP:\nembedding_df = reduce_feature(\n    df=df,           # dataframe of values\n    method='pca',    # 'pca', 'tsne', or 'umap'\n    complexity=20,   # perplexity for TSNE, n_neighbors for UMAP\n    n=2,             # number of components\n    load=None,       # path to load pre-trained model\n    save=None,       # path to save trained model\n    seed=123,        # random state for reproducibility\n)\n\n2D Scatter Plots\nTo plot a 2D scatter from pre-computed embeddings:\nplot_2d(\n    embedding_df=feat,     # dataframe with 2 columns (e.g., PCA1, PCA2)\n    hue=info['group'],     # series/list for coloring points\n    palette='tab20',       # color palette\n    legend=True,           # show legend\n    legend_title='Group',  # custom legend title\n    name_list=None,        # list of names to annotate points\n    s=20,                  # dot size\n)\nTo reduce dimensions and plot in one step:\nplot_cluster(\n    df=df,              # dataframe of values\n    method='umap',      # 'pca', 'tsne', or 'umap'\n    hue=info['group'],  # series for coloring\n    complexity=15,      # perplexity/n_neighbors\n    palette='tab20',    # color palette\n    legend=True,        # show legend\n    name_list=None,     # list of names to annotate\n    seed=123,           # random state\n    s=50,               # dot size\n)\nTo create an interactive Bokeh plot with search box:\nplot_bokeh(\n    X=embedding_df,       # 2-column dataframe from reduce_feature\n    idx=info['Name'],     # identity labels for search\n    hue=info['Group'],    # category for coloring\n    s=7,                  # dot size\n    smiles=info['SMILES'], # additional hover info (kwargs)\n)\n\nRank & Distribution\nTo plot ranked values with top/bottom annotations:\nplot_rank(\n    sorted_df=sorted_df,  # pre-sorted dataframe\n    x='kinase',           # column for x-axis labels\n    y='values',           # column for y-axis values\n    n_hi=10,              # number of top values to label\n    n_lo=10,              # number of bottom values to label\n    figsize=(10, 8),      # figure size\n)\nTo plot a histogram with KDE:\nplot_hist(\n    df=sorted_df,      # dataframe with values\n    x='values',        # column name for histogram\n    figsize=(6, 2),    # figure size\n)\n\nBar & Box Plots\nTo plot horizontal bar counts from value_counts:\nplot_count(\n    cnt=df['col'].value_counts(),  # value counts series\n    tick_spacing=10,               # x-axis tick interval\n    palette='tab20',               # color palette\n)\nTo plot bar graph with optional strip dots:\nplot_bar(\n    df=info,           # unstacked dataframe\n    value='MW',        # column name for values\n    group='category',  # column name for grouping\n    title='Title',     # plot title\n    figsize=(12, 5),   # figure size\n    dots=True,         # add strip dots\n    rotation=90,       # x-tick rotation\n    ascending=False,   # sort order\n)\nTo plot grouped bar chart for multiple value columns:\nplot_group_bar(\n    df=info,                    # dataframe\n    value_cols=['pKa1', 'pKb2'],  # list of value columns\n    group='Name',               # grouping column\n    figsize=(12, 5),            # figure size\n    order=None,                 # custom x-axis order\n    rotation=90,                # x-tick rotation\n)\nTo plot box plot with optional dots:\nplot_box(\n    df=info,           # dataframe\n    value='MW',        # value column\n    group='category',  # grouping column\n    figsize=(6, 3),    # figure size\n    dots=True,         # show individual points\n    rotation=90,       # x-tick rotation\n)\n\nViolin Plot\nTo plot violin plot with optional strip dots:\nax = plot_violin(\n    data=df_long,        # long-form dataframe\n    value='value',       # column for values\n    group='variable',    # column for grouping\n    ylabel='Accuracy',   # y-axis label\n    dots=True,           # add strip dots\n    figsize=(5, 3),      # figure size\n)\nTo add statistical annotations to violin/box plots:\nadd_stats(\n    ax=ax,                 # axes from plot_violin\n    data=df_long,          # same dataframe\n    value='value',         # value column\n    group='variable',      # group column\n    pairs=None,            # comparison pairs (auto-generated if None)\n    test='t-test_ind',     # statistical test\n    text_format='star',    # annotation format ('star' or 'simple')\n)\n\nCorrelation & Heatmap\nTo plot correlation scatter with Spearman/Pearson stats:\nplot_rel(\n    df=norm,                   # dataframe with columns to correlate\n    x='AAK1',                  # x-axis column\n    y='BIKE',                  # y-axis column\n    method='spearman',         # 'spearman' or 'pearson'\n    text_location=(0.8, 0.1),  # position for stats text\n    index_list=None,           # indices to annotate\n    hue=None,                  # optional hue column\n    reg_line=True,             # show regression line\n)\nTo calculate distance/similarity matrices:\ndist_df, sim_df = get_similarity(\n    df=df,              # dataframe of features\n    metric='euclidean',  # distance metric\n)\nTo plot correlation/similarity heatmap:\nplot_corr(\n    df_corr=corr,          # correlation matrix\n    inverse_color=False,   # reverse colormap\n    figsize=(15, 10),      # figure size\n)\n\nEvaluation Metrics\nTo plot AUCDF (Area Under CDF) for ranking evaluation:\naucdf = get_AUCDF(\n    df=sorted_df,                   # dataframe with rank values\n    col='values',                   # column name for ranks\n    reverse=False,                  # reverse CDF direction\n    plot=True,                      # show plot\n    xlabel='Rank of reported kinase',  # x-axis label\n)\nTo plot normalized confusion matrix:\nplot_confusion_matrix(\n    target=y_true,            # true labels\n    pred=y_pred,              # predicted labels\n    class_names=['0', '1'],   # class label names\n    normalize=True,           # normalize by row\n    title='Confusion matrix',  # plot title\n    cmap=plt.cm.Blues,        # colormap\n)\n\nPie & Composition\nTo plot pie chart from value counts:\nplot_pie(\n    value_counts=df['col'].value_counts(),  # value counts series\n    hue_order=None,        # custom category order\n    labeldistance=1,       # label distance from center\n    fontsize=10,           # label font size\n    fontcolor='black',     # label color\n    palette='tab20',       # color palette\n    figsize=(4, 3),        # figure size\n)\nTo plot stacked bar showing composition percentages:\nplot_composition(\n    df=df,                # dataframe\n    bin_col='bin',        # column for x-axis bins\n    hue_col='category',   # column for stacked hue\n    palette='tab20',      # color palette\n    legend_title='Type',  # legend title\n    rotate=45,            # x-tick rotation\n    xlabel=None,          # x-axis label\n    ylabel='Percentage',  # y-axis label\n    figsize=(5, 3),       # figure size\n)\nTo plot bar count with value labels on top:\nplot_cnt(\n    cnt=df['col'].value_counts(),  # value counts series\n    xlabel=None,                   # x-axis label\n    ylabel='Count',                # y-axis label\n    figsize=(6, 3),                # figure size\n)",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#setup",
    "href": "plot.html#setup",
    "title": "Plot",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#utils",
    "href": "plot.html#utils",
    "title": "Plot",
    "section": "Utils",
    "text": "Utils\n\n\nset_sns\n\ndef set_sns(\n    dpi:int=300\n):\n\nSet seaborn resolution for notebook display\n\n\n\nsave_svg\n\ndef save_svg(\n    path\n):\n\n\n\n\nsave_pdf\n\ndef save_pdf(\n    path\n):\n\n\n\n\nsave_show\n\ndef save_show(\n    path:NoneType=None, # image path, e.g., img.svg, if not None, will save, else plt.show()\n    show_only:bool=False\n):\n\nShow plot or save path",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#colorpalette",
    "href": "plot.html#colorpalette",
    "title": "Plot",
    "section": "Color/palette",
    "text": "Color/palette\n\n\nget_color_dict\n\ndef get_color_dict(\n    categories, # list of names to assign color\n    palette:str='tab20', # choose from sns.color_palette\n):\n\nAssign colors to a list of names (allow duplicates), returns a dictionary of unique name with corresponding color\n\ninfo = Data.get_kinase_info()\n\n\ninfo.modi_group.value_counts().index\n\nIndex(['TK', 'CAMK', 'Other', 'CMGC', 'AGC', 'STE', 'TKL', 'Atypical', 'CK1',\n       'NEK', 'RGC'],\n      dtype='object', name='modi_group')\n\n\n\ninfo.pspa_category_big.str.split('_').str[0].value_counts()[:20].index\n\nIndex(['Basophilic', 'Pro-directed', 'Acidophilic', 'Map3k', 'Map4k',\n       'Alpha/mlk', 'Fgf and vegf receptors', 'Assorted', 'Ripk/wnk', 'Pkc',\n       'Ephrin receptors', 'Eif2ak/tlk', 'Nek/ask', 'Pdgf receptors', 'Src',\n       'Jak', 'Tam receptors', 'Cmgc', 'Tec', 'Ulk/ttbk'],\n      dtype='object', name='pspa_category_big')\n\n\n\n\n\nget_subfamily_color\n\ndef get_subfamily_color(\n    \n):\n\n\n# get_subfamily_color()\n\nSometimes plot functions do not take dict of colors but list of colors:\n\n\n\nget_plt_color\n\ndef get_plt_color(\n    palette, # dict, list, or set name (tab10)\n    columns, # columns in the df for plot\n):\n\nGiven a dict, list or set name, return the list of names; if dict, need to provide column names of the df.\n\nget_plt_color('Set2',['a','b'])\n\n\n\n\n\n\n\nget_hue_big\n\ndef get_hue_big(\n    df, hue_col, # column of hue\n    cnt_thr:int=10, # higher or equal to this threshold will be considered\n):\n\nGet part of hue according to its value counts; applied when the groups are too many.\nWhen the categories are too many to show on the plot, we can filter and only show those big categories:\n\nhue_big=get_hue_big(info,'pspa_category_big',10)\nhue_big\n\n5      Acidophilic\n6      Acidophilic\n11      Basophilic\n12      Basophilic\n13      Basophilic\n          ...     \n516    Acidophilic\n517    Acidophilic\n519          Map4k\n520          Map3k\n521          Map3k\nName: pspa_category_big, Length: 294, dtype: object\n\n\n\n# plot_2d(embed,hue=hue_pspa,hue_title='PSPA category',palette='tab20')",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#dimensionality-reduction",
    "href": "plot.html#dimensionality-reduction",
    "title": "Plot",
    "section": "Dimensionality reduction",
    "text": "Dimensionality reduction\n\n\nreduce_feature\n\ndef reduce_feature(\n    df:DataFrame, method:str='pca', # dimensionality reduction method, accept both capital and lower case\n    complexity:int=20, # None for PCA; perfplexity for TSNE, recommend: 30; n_neigbors for UMAP, recommend: 15\n    n:int=2, # n_components\n    load:str=None, # load a previous model, e.g. model.pkl\n    save:str=None, # pkl file to be saved, e.g. pca_model.pkl\n    seed:int=123, # seed for random_state\n    kwargs:VAR_KEYWORD\n):\n\nReduce the dimensionality given a dataframe of values\nA very common way to reduce feature number is to use dimensionality reduction method. reduce_feature is a dimensionality reduction function that can apply three dimensionality reduction methods: PCA, UMAP, TSNE. The later two is non-linear transformation, and PCA is linear transformation. Therefore, for plotting purpose, it is good to use UMAP/TSNE, by setting n (n_components) to 2 for 2d plot; for featuring purpose, it is good to use PCA, and set n to values to a rational values, like 64, 128 etc.\n\n# Load data\ndf=Data.get_aa_morgan()\n\n# Use PCA to reduce dimension; reduce the number of features to 20\nfeat = reduce_feature(df,'pca',n=2)\nfeat.head()\n\n\n\n\n\n\n\n\nPCA1\nPCA2\n\n\naa\n\n\n\n\n\n\nA\n-0.954819\n-0.953761\n\n\nC\n-0.041108\n0.205091\n\n\nD\n-0.087707\n0.245634\n\n\nE\n-0.271097\n1.023801\n\n\nF\n2.253264\n-0.251185",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#d-scatter-plot",
    "href": "plot.html#d-scatter-plot",
    "title": "Plot",
    "section": "2D scatter plot",
    "text": "2D scatter plot\n\n\nplot_2d\n\ndef plot_2d(\n    embedding_df:DataFrame, # a dataframe of values that is waited for dimensionality reduction\n    hue:str=None, # colname of color\n    palette:str='tab20', # color scheme, could be tab10 if less categories\n    legend:bool=False, # whether or not add the legend on the side\n    name_list:NoneType=None, # a list of names to annotate each dot in the plot\n    s:int=20, # size of the dot\n    legend_title:str=None, # new argument to override legend title\n    kwargs:VAR_KEYWORD\n):\n\nGiven a dataframe of values, plot it in 2D.  The method could be ‘pca’, ‘tsne’, or ‘umap’.\n\nplot_2d(feat)\n\n/tmp/ipykernel_674/2710618909.py:17: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.\n  g = sns.relplot(",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#dimensionality-reduction-2d-plot",
    "href": "plot.html#dimensionality-reduction-2d-plot",
    "title": "Plot",
    "section": "Dimensionality reduction + 2d plot",
    "text": "Dimensionality reduction + 2d plot\n\n\nplot_cluster\n\ndef plot_cluster(\n    df:DataFrame, # a dataframe of values that is waited for dimensionality reduction\n    method:str='pca', # dimensionality reduction method, choose from pca, umap, and tsne\n    hue:str=None, # colname of color\n    complexity:int=30, # this argument does not affect pca but others; recommend 30 for tsne, 15 for umap\n    palette:str='tab20', # color scheme, could be tab10 if less categories\n    legend:bool=False, # whether or not add the legend on the side\n    name_list:NoneType=None, # a list of names to annotate each dot in the plot\n    seed:int=123, # seed for dimensionality reduction\n    s:int=50, # size of the dot\n    legend_title:str=None, # new argument to override legend title\n    kwargs:VAR_KEYWORD\n):\n\nGiven a dataframe of values, plot it in 2D.  The method could be ‘pca’, ‘tsne’, or ‘umap’.\n\nplot_cluster(df,method='pca',legend=True)\n\n/tmp/ipykernel_674/39475780.py:22: UserWarning: Ignoring `palette` because no `hue` variable has been assigned.\n  g = sns.relplot(",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#bokeh-interactive-plot",
    "href": "plot.html#bokeh-interactive-plot",
    "title": "Plot",
    "section": "Bokeh interactive plot",
    "text": "Bokeh interactive plot\n\n\nplot_bokeh\n\ndef plot_bokeh(\n    X:DataFrame, # a dataframe of two columns from dimensionality reduction\n    idx, # pd.Series or list that indicates identities for searching box\n    hue:None, # pd.Series or list that indicates category for each sample\n    s:int=3, # dot size\n    kwargs:VAR_KEYWORD\n):\n\nMake interactive 2D plot with a searching box and window of dot information when pointing\n\n# PCA reduce dimension to 2\nX = reduce_feature(df)\n\n# get info\ninfo=Data.get_aa_info()\n\n#plot\nplot_bokeh(X, \n           idx = info.Name,\n           hue = info.Name,\n           s=7, \n           smiles = info.SMILES)\n\n    \n    \n        \n        Loading BokehJS ...",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#rank",
    "href": "plot.html#rank",
    "title": "Plot",
    "section": "Rank",
    "text": "Rank\n\n\nplot_rank\n\ndef plot_rank(\n    sorted_df:DataFrame, # a sorted dataframe\n    x:str, # column name for x axis\n    y:str, # column name for y aixs\n    n_hi:int=10, # if not None, show the head n names\n    n_lo:int=10, # if not None, show the tail n names\n    figsize:tuple=(10, 8), # figure size\n    data:NoneType=None, hue:NoneType=None, size:NoneType=None, style:NoneType=None, palette:NoneType=None,\n    hue_order:NoneType=None, hue_norm:NoneType=None, sizes:NoneType=None, size_order:NoneType=None,\n    size_norm:NoneType=None, markers:bool=True, style_order:NoneType=None, legend:str='auto', ax:NoneType=None\n):\n\nPlot rank from a sorted dataframe\n\n# load data\n# df = Data.get_pspa_raw().set_index('kinase')\ndf = pd.read_csv('https://github.com/sky1ove/katlas_raw/raw/refs/heads/main/nbs/raw/pspa_st_raw.csv').set_index('kinase')\n\n\n# get sorted dataframe\nsorted_df = df.max(1).reset_index(name='values').sort_values('values')\nsorted_df.head()\n\n\n\n\n\n\n\n\nkinase\nvalues\n\n\n\n\n68\nCK1G2\n189898.392\n\n\n294\nVRK2\n4191709.640\n\n\n8\nALPHAK3\n4573611.730\n\n\n249\nPRPK\n8495330.790\n\n\n38\nCAMLCK\n9413689.600\n\n\n\n\n\n\n\n\nplot_rank(sorted_df,x='kinase',y='values')\nplt.xlabel('kinase');",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#distribution-histogram",
    "href": "plot.html#distribution-histogram",
    "title": "Plot",
    "section": "Distribution histogram",
    "text": "Distribution histogram\n\n\nplot_hist\n\ndef plot_hist(\n    df:DataFrame, # a dataframe that contain values for plot\n    x:str, # column name of values\n    figsize:tuple=(6, 2), data:NoneType=None, y:NoneType=None, hue:NoneType=None,\n    weights:NoneType=None, # Vector variables\n    stat:str='count', bins:str='auto', binwidth:NoneType=None,\n    binrange:NoneType=None, # Histogram computation parameters\n    discrete:NoneType=None, cumulative:bool=False, common_bins:bool=True, common_norm:bool=True,\n    multiple:str='layer', element:str='bars', fill:bool=True, shrink:int=1, # Histogram appearance parameters\n    kde:bool=False, kde_kws:NoneType=None,\n    line_kws:NoneType=None, # Histogram smoothing with a kernel density estimate\n    thresh:int=0, pthresh:NoneType=None, pmax:NoneType=None, cbar:bool=False, cbar_ax:NoneType=None,\n    cbar_kws:NoneType=None, # Bivariate histogram parameters\n    palette:NoneType=None, hue_order:NoneType=None, hue_norm:NoneType=None,\n    color:NoneType=None, # Hue mapping parameters\n    log_scale:NoneType=None, legend:bool=True, ax:NoneType=None, # Axes information\n):\n\n\n# we can use the same df\nsorted_df.head()\n\n\n\n\n\n\n\n\nkinase\nvalues\n\n\n\n\n68\nCK1G2\n189898.392\n\n\n294\nVRK2\n4191709.640\n\n\n8\nALPHAK3\n4573611.730\n\n\n249\nPRPK\n8495330.790\n\n\n38\nCAMLCK\n9413689.600\n\n\n\n\n\n\n\n\nplot_hist(sorted_df,'values')",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#bar-graph",
    "href": "plot.html#bar-graph",
    "title": "Plot",
    "section": "Bar graph",
    "text": "Bar graph\n\n\nplot_count\n\ndef plot_count(\n    cnt, # from df['x'].value_counts()\n    tick_spacing:float=None, # tick spacing for x axis\n    palette:str='tab20'\n):\n\nMake bar plot from df[‘x’].value_counts()\n\ncnt = info.Name.value_counts()\n\n\nplot_count(cnt)\n\n\n\n\n\n\n\n\n\n\n\nplot_bar\n\ndef plot_bar(\n    df, value, # colname of value\n    group, # colname of group\n    title:NoneType=None, figsize:tuple=(12, 5), fontsize:int=14,\n    dots:bool=True, # whether or not add dots in the graph\n    rotation:int=90, ascending:bool=False, ymin:NoneType=None, data:NoneType=None, x:NoneType=None, y:NoneType=None,\n    hue:NoneType=None, order:NoneType=None, hue_order:NoneType=None, estimator:str='mean', errorbar:tuple=('ci', 95),\n    n_boot:int=1000, seed:NoneType=None, units:NoneType=None, weights:NoneType=None, orient:NoneType=None,\n    color:NoneType=None, palette:NoneType=None, saturation:float=0.75, fill:bool=True, hue_norm:NoneType=None,\n    width:float=0.8, dodge:str='auto', gap:int=0, log_scale:NoneType=None, native_scale:bool=False,\n    formatter:NoneType=None, legend:str='auto', capsize:int=0, err_kws:NoneType=None, ci:Deprecated=&lt;deprecated&gt;,\n    errcolor:Deprecated=&lt;deprecated&gt;, errwidth:Deprecated=&lt;deprecated&gt;, ax:NoneType=None\n):\n\nPlot bar graph from unstacked dataframe; need to indicate columns of values and categories\n\ninfo['cat'] = (info.pKa1&gt;2).astype(int)\n\n\n# get an unstacked dataframe\nplot_bar(info,value='MW',group='cat',palette='tab20')\n\n\n\n\n\n\n\n\n\n\n\nplot_group_bar\n\ndef plot_group_bar(\n    df, value_cols, # list of column names for values, the order depends on the first item\n    group, # column name of group (e.g., 'kinase')\n    figsize:tuple=(12, 5), order:NoneType=None, title:NoneType=None, fontsize:int=14, rotation:int=90,\n    data:NoneType=None, x:NoneType=None, y:NoneType=None, hue:NoneType=None, hue_order:NoneType=None,\n    estimator:str='mean', errorbar:tuple=('ci', 95), n_boot:int=1000, seed:NoneType=None, units:NoneType=None,\n    weights:NoneType=None, orient:NoneType=None, color:NoneType=None, palette:NoneType=None, saturation:float=0.75,\n    fill:bool=True, hue_norm:NoneType=None, width:float=0.8, dodge:str='auto', gap:int=0, log_scale:NoneType=None,\n    native_scale:bool=False, formatter:NoneType=None, legend:str='auto', capsize:int=0, err_kws:NoneType=None,\n    ci:Deprecated=&lt;deprecated&gt;, errcolor:Deprecated=&lt;deprecated&gt;, errwidth:Deprecated=&lt;deprecated&gt;, ax:NoneType=None\n):\n\nPlot grouped bar graph from dataframe.\n\nplot_group_bar(info,['pKa1','pKb2'],'Name')",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#stacked-bar-graph",
    "href": "plot.html#stacked-bar-graph",
    "title": "Plot",
    "section": "Stacked bar graph",
    "text": "Stacked bar graph\n\n\nplot_stacked\n\ndef plot_stacked(\n    df, column, hue, figsize:tuple=(5, 4), xlabel:NoneType=None, ylabel:NoneType=None, add_value:bool=True,\n    kwargs:VAR_KEYWORD\n):",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#violin-plot",
    "href": "plot.html#violin-plot",
    "title": "Plot",
    "section": "Violin plot",
    "text": "Violin plot\n\n\nplot_violin\n\ndef plot_violin(\n    data, value:str='value', group:str='variable', ylabel:NoneType=None, dots:bool=True, figsize:tuple=(5, 3),\n    kwargs:VAR_KEYWORD\n):\n\nPlot violin plots (with optional strip dots) for long-form data.\n\n# plot_violin(data,ylabel='Accuracy',figsize=(4,3))\n\n\n\n\nadd_stats\n\ndef add_stats(\n    ax, data, value:str='value', group:str='variable', pairs:NoneType=None, test:str='t-test_ind', loc:str='inside',\n    text_format:str='star', kwargs:VAR_KEYWORD\n):",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#box-plot",
    "href": "plot.html#box-plot",
    "title": "Plot",
    "section": "Box plot",
    "text": "Box plot\n\n\nplot_box\n\ndef plot_box(\n    df, value, # colname of value\n    group, # colname of group\n    title:NoneType=None, figsize:tuple=(6, 3), fontsize:int=14, dots:bool=True, rotation:int=90, data:NoneType=None,\n    x:NoneType=None, y:NoneType=None, hue:NoneType=None, order:NoneType=None, hue_order:NoneType=None,\n    orient:NoneType=None, color:NoneType=None, palette:NoneType=None, saturation:float=0.75, fill:bool=True,\n    dodge:str='auto', width:float=0.8, gap:int=0, whis:float=1.5, linecolor:str='auto', linewidth:NoneType=None,\n    fliersize:NoneType=None, hue_norm:NoneType=None, native_scale:bool=False, log_scale:NoneType=None,\n    formatter:NoneType=None, legend:str='auto', ax:NoneType=None\n):\n\nPlot box plot.\n\nplot_box(info,value='MW',group='cat',palette='tab20')",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#correlation",
    "href": "plot.html#correlation",
    "title": "Plot",
    "section": "Correlation",
    "text": "Correlation\n\n\nplot_rel\n\ndef plot_rel(\n    df, # dataframe that contains data\n    x, # x axis values, or colname of x axis\n    y, # y axis values, or colname of y axis\n    text_location:tuple=(0.8, 0.1), # relative coords in Axes (0–1)\n    method:str='spearman', # correlation method: 'pearson' or 'spearman'\n    index_list:NoneType=None, # list of indices to annotate\n    hue:NoneType=None, reg_line:bool=True, data:NoneType=None, x_estimator:NoneType=None, x_bins:NoneType=None,\n    x_ci:str='ci', scatter:bool=True, fit_reg:bool=True, ci:int=95, n_boot:int=1000, units:NoneType=None,\n    seed:NoneType=None, order:int=1, logistic:bool=False, lowess:bool=False, robust:bool=False, logx:bool=False,\n    x_partial:NoneType=None, y_partial:NoneType=None, truncate:bool=True, dropna:bool=True, x_jitter:NoneType=None,\n    y_jitter:NoneType=None, label:NoneType=None, color:NoneType=None, marker:str='o', scatter_kws:NoneType=None,\n    line_kws:NoneType=None, ax:NoneType=None\n):\n\nGiven a dataframe and the name of two columns,  plot the two columns’ correlation with either Pearson or Spearman. Annotate points if their index is in index_list.\n\nnorm = Data.get_pspa().iloc[:,:-6].T\n\nnorm.head()\n\n\n\n\n\n\n\nkinase\nAAK1\nACVR2A\nACVR2B\nAKT1\nAKT2\nAKT3\nALK2\nALK4\nALPHAK3\nAMPKA1\n...\nNTRK3\nTXK\nTYK2\nTYRO3\nFLT1\nKDR\nFLT4\nWEE1_TYR\nYES1\nZAP70\n\n\n\n\n-5P\n0.0720\n0.0415\n0.0533\n0.0603\n0.0602\n0.0705\n0.0536\n0.0552\n0.0571\n0.0555\n...\n0.0656\n0.0784\n0.0606\n0.0661\n0.0642\n0.0634\n0.0457\n0.0531\n0.0677\n0.0602\n\n\n-5G\n0.0245\n0.0481\n0.0517\n0.0594\n0.0617\n0.0624\n0.0659\n0.0574\n0.0478\n0.0504\n...\n0.0751\n0.0795\n0.0674\n0.0666\n0.0688\n0.0672\n0.0531\n0.0640\n0.0571\n0.0880\n\n\n-5A\n0.0284\n0.0584\n0.0566\n0.0552\n0.0643\n0.0745\n0.0662\n0.0605\n0.0253\n0.0534\n...\n0.0594\n0.0669\n0.0561\n0.0548\n0.0597\n0.0556\n0.0488\n0.0559\n0.0537\n0.0623\n\n\n-5C\n0.0456\n0.0489\n0.0772\n0.0605\n0.0582\n0.0628\n0.0762\n0.0483\n0.0384\n0.0588\n...\n0.0517\n0.0662\n0.0521\n0.0533\n0.0618\n0.0517\n0.0553\n0.0560\n0.0530\n0.0496\n\n\n-5S\n0.0425\n0.0578\n0.0533\n0.0516\n0.0534\n0.0442\n0.0567\n0.0574\n0.0571\n0.0504\n...\n0.0452\n0.0561\n0.0506\n0.0543\n0.0614\n0.0541\n0.0512\n0.0433\n0.0527\n0.0471\n\n\n\n\n5 rows × 396 columns\n\n\n\n\nplot_rel(df=norm, x='AAK1', y='BIKE')",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#matrix-heatmap",
    "href": "plot.html#matrix-heatmap",
    "title": "Plot",
    "section": "Matrix heatmap",
    "text": "Matrix heatmap\n\n\nget_similarity\n\ndef get_similarity(\n    df, metric:str='euclidean'\n):\n\nCalculate distance matrix of a df; also return inverse df (similarity df)\n\n\n\nplot_corr\n\ndef plot_corr(\n    df_corr, mask_method:str='upper', # \"upper\", \"lower\", or None\n    inverse_color:bool=False, figsize:tuple=(15, 10), annot:bool=True, linewidths:float=0.1, kwargs:VAR_KEYWORD\n):\n\nPlot distance/similarity matrix\n\ncorr = info.head(8).corr(numeric_only=True)\n\n\nplot_corr(corr)",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#aucdf",
    "href": "plot.html#aucdf",
    "title": "Plot",
    "section": "AUCDF",
    "text": "AUCDF\nWe compute the area under the empirical cumulative distribution function (CDF) as a function of kinase rank using the trapezoidal rule.\nLet $ r_{(1)} &lt; r_{(2)} &lt; &lt; r_{(n)} $ be the sorted rank values (e.g., \\(1,2,\\dots,n\\)), and define the empirical CDF values as:\n\\[\nF(r_{(i)}) = \\frac{i}{n}\n\\]\nThe normalized area under this CDF-vs-rank curve (AUCDF) is then computed via the trapezoidal rule:\n\\[\n\\text{AUC}_{\\text{CDF}} =\n\\frac{1}{r_{\\max} - r_{\\min}} \\sum_{i=1}^{n-1}\n\\frac{F(r_{(i)}) + F(r_{(i+1)})}{2} \\cdot (r_{(i+1)} - r_{(i)})\n\\]\nwhere $ r_{} = r_{(1)} $, typically 1; $ r_{} = r_{(n)} $, typically \\(n\\).\nThis measures how quickly the cumulative mass increases across the ranked kinases. If better kinases (lower rank) tend to appear earlier in the CDF, the AUCDF will be higher.\n\n\nget_AUCDF\n\ndef get_AUCDF(\n    df, col, reverse:bool=False, plot:bool=True, xlabel:str='Rank of reported kinase'\n):\n\nPlot CDF curve and get relative area under the curve\n\nget_AUCDF(sorted_df,'values')\n\n/tmp/ipykernel_674/2030375725.py:15: DeprecationWarning: `trapz` is deprecated. Use `trapezoid` instead, or one of the numerical integration functions in `scipy.integrate`.\n  area_under_curve = np.trapz(y_values, x_values)\n\n\n\n\n\n\n\n\n\nnp.float64(0.872608302329996)",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#confusion-matrix",
    "href": "plot.html#confusion-matrix",
    "title": "Plot",
    "section": "Confusion matrix",
    "text": "Confusion matrix\n\n\nplot_confusion_matrix\n\ndef plot_confusion_matrix(\n    target, # pd.Series\n    pred, # pd.Series\n    class_names:list=['0', '1'], normalize:bool=False, title:str='Confusion matrix',\n    cmap:LinearSegmentedColormap=&lt;matplotlib.colors.LinearSegmentedColormap object at 0x7fdce51fb380&gt;\n):\n\nPlot the confusion matrix.\n\ntarget = info.MW&lt;160\npred = info.pKa1&gt;2.1\n\n\nplot_confusion_matrix(target,pred,normalize=True)\n\nNormalized confusion matrix",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#pie-plot",
    "href": "plot.html#pie-plot",
    "title": "Plot",
    "section": "Pie plot",
    "text": "Pie plot\n\n\nplot_pie\n\ndef plot_pie(\n    value_counts, # value counts\n    hue_order:NoneType=None, # list of strings\n    labeldistance:float=0.8, fontsize:int=12, fontcolor:str='black', palette:str='tab20', figsize:tuple=(4, 3)\n):\n\n\ninfo=Data.get_kinase_info()\n\n\nplot_pie(info.modi_group.value_counts(),\n         fontsize=10,\n         labeldistance=1)",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#bar-composition",
    "href": "plot.html#bar-composition",
    "title": "Plot",
    "section": "Bar composition",
    "text": "Bar composition\n\n\ncalculate_pct\n\ndef calculate_pct(\n    df, bin_col, hue_col\n):\n\nGet percentage for hue in each bin; with hue adding up to 1 in each bin.\n\n\n\nplot_composition\n\ndef plot_composition(\n    df, bin_col, hue_col, palette:str='tab20', legend_title:NoneType=None, rotate:int=45, xlabel:NoneType=None,\n    ylabel:str='Percentage', figsize:tuple=(5, 3)\n):",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "plot.html#plot-bar-count-with-value-text",
    "href": "plot.html#plot-bar-count-with-value-text",
    "title": "Plot",
    "section": "Plot bar count with value text",
    "text": "Plot bar count with value text\n\n\nplot_cnt\n\ndef plot_cnt(\n    cnt, xlabel:NoneType=None, ylabel:str='Count', figsize:tuple=(6, 3)\n):",
    "crumbs": [
      "Modules",
      "Plot"
    ]
  },
  {
    "objectID": "clustering.html",
    "href": "clustering.html",
    "title": "Hierarchical clustering",
    "section": "",
    "text": "This module provides tools for computing pairwise distances between PSSMs (Position-Specific Scoring Matrices), performing hierarchical clustering, and visualizing results as dendrograms.\n\nDistance Computation\nget_1d_distance(df, func_flat) — Computes pairwise distances between all rows in a dataframe using a specified distance function. Returns a 1D condensed distance array suitable for scipy’s linkage functions.\ndist = get_1d_distance(\n    df=pssms.head(10),      # dataframe where each row is a flattened PSSM\n    func_flat=js_divergence_flat,  # distance function taking two rows, returns scalar\n)\nget_1d_js(df) — Convenience wrapper that computes pairwise JS (Jensen-Shannon) divergence distances.\ndist = get_1d_js(\n    df=pssms.head(20),  # dataframe of flattened PSSMs\n)\nget_1d_distance_parallel(df, func_flat, max_workers, chunksize) — Parallelized version for large dataframes.\ndist = get_1d_distance_parallel(\n    df=pssms,              # dataframe of flattened PSSMs\n    func_flat=js_divergence_flat,  # distance function\n    max_workers=4,         # number of parallel workers\n    chunksize=100,         # items per worker batch\n)\nget_1d_js_parallel(df, **kwargs) — Parallelized JS divergence with same interface as above.\n\nLinkage Matrix\nget_Z(pssms, func_flat, parallel) — Computes the linkage matrix Z from a PSSM dataframe. This is the main entry point combining distance computation and hierarchical clustering.\nZ = get_Z(\n    pssms=pssms.head(100),         # dataframe of flattened PSSMs\n    func_flat=js_divergence_flat,  # distance function (default: JS divergence)\n    parallel=True,                 # use parallel computation for speed\n)\n\nVisualization\nplot_dendrogram(Z, color_thr, dense, line_width, title, scale, **kwargs) — Plots a horizontal dendrogram from linkage matrix Z. Passes additional kwargs to scipy’s dendrogram().\nplot_dendrogram(\n    Z=Z,                  # linkage matrix from get_Z()\n    color_thr=0.07,       # distance threshold for coloring branches\n    dense=7,              # density control (higher = more compact rows)\n    line_width=1,         # width of dendrogram lines\n    title=\"My Cluster\",   # optional plot title\n    scale=1,              # figure size multiplier\n    labels=labels,        # custom leaf labels (from get_pssm_seq_labels)\n    truncate_mode='lastp',  # scipy kwarg: show only last p merged clusters\n    p=40,                 # scipy kwarg: number of leaves to show\n)\n\nPSSM Labeling\npssm_to_seq(pssm_df, thr, clean_center) — Converts a 2D PSSM back to a consensus sequence string. Uses brackets for multiple high-probability amino acids and * to mark the phosphorylation center.\nseq = pssm_to_seq(\n    pssm_df=recover_pssm(pssms.iloc[0]),  # 2D PSSM (rows=AAs, cols=positions)\n    thr=0.2,           # probability threshold to include amino acid\n    clean_center=True, # keep only s/t/y at center position\n)\n# Returns e.g.: '..RR.[s/t]*....'\nget_pssm_seq_labels(pssms, count_map, thr) — Generates dendrogram labels combining the PSSM index name with its consensus sequence. Optionally includes sample counts.\nlabels = get_pssm_seq_labels(\n    pssms=pssms.head(10),  # dataframe of flattened PSSMs\n    count_map=count_dict,  # optional dict {index: count} for sample sizes\n    thr=0.3,               # probability threshold for consensus sequence\n)\n# Returns e.g.: ['AKT1 (n=60): ..RR.[s/t]*....', ...]\n\nFull Pipeline Example\n# 1. Load and subset data\npssms = Data.get_pspa_scale().head(100)\n\n# 2. Compute linkage matrix\nZ = get_Z(\n    pssms=pssms,\n    parallel=True,\n)\n\n# 3. Generate labels with consensus sequences\nlabels = get_pssm_seq_labels(\n    pssms=pssms,\n    thr=0.3,\n)\n\n# 4. Plot dendrogram\nplot_dendrogram(\n    Z=Z,\n    dense=8,\n    labels=labels,\n    truncate_mode='lastp',\n    p=40,\n)",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "clustering.html#overview",
    "href": "clustering.html#overview",
    "title": "Hierarchical clustering",
    "section": "",
    "text": "This module provides tools for computing pairwise distances between PSSMs (Position-Specific Scoring Matrices), performing hierarchical clustering, and visualizing results as dendrograms.\n\nDistance Computation\nget_1d_distance(df, func_flat) — Computes pairwise distances between all rows in a dataframe using a specified distance function. Returns a 1D condensed distance array suitable for scipy’s linkage functions.\ndist = get_1d_distance(\n    df=pssms.head(10),      # dataframe where each row is a flattened PSSM\n    func_flat=js_divergence_flat,  # distance function taking two rows, returns scalar\n)\nget_1d_js(df) — Convenience wrapper that computes pairwise JS (Jensen-Shannon) divergence distances.\ndist = get_1d_js(\n    df=pssms.head(20),  # dataframe of flattened PSSMs\n)\nget_1d_distance_parallel(df, func_flat, max_workers, chunksize) — Parallelized version for large dataframes.\ndist = get_1d_distance_parallel(\n    df=pssms,              # dataframe of flattened PSSMs\n    func_flat=js_divergence_flat,  # distance function\n    max_workers=4,         # number of parallel workers\n    chunksize=100,         # items per worker batch\n)\nget_1d_js_parallel(df, **kwargs) — Parallelized JS divergence with same interface as above.\n\nLinkage Matrix\nget_Z(pssms, func_flat, parallel) — Computes the linkage matrix Z from a PSSM dataframe. This is the main entry point combining distance computation and hierarchical clustering.\nZ = get_Z(\n    pssms=pssms.head(100),         # dataframe of flattened PSSMs\n    func_flat=js_divergence_flat,  # distance function (default: JS divergence)\n    parallel=True,                 # use parallel computation for speed\n)\n\nVisualization\nplot_dendrogram(Z, color_thr, dense, line_width, title, scale, **kwargs) — Plots a horizontal dendrogram from linkage matrix Z. Passes additional kwargs to scipy’s dendrogram().\nplot_dendrogram(\n    Z=Z,                  # linkage matrix from get_Z()\n    color_thr=0.07,       # distance threshold for coloring branches\n    dense=7,              # density control (higher = more compact rows)\n    line_width=1,         # width of dendrogram lines\n    title=\"My Cluster\",   # optional plot title\n    scale=1,              # figure size multiplier\n    labels=labels,        # custom leaf labels (from get_pssm_seq_labels)\n    truncate_mode='lastp',  # scipy kwarg: show only last p merged clusters\n    p=40,                 # scipy kwarg: number of leaves to show\n)\n\nPSSM Labeling\npssm_to_seq(pssm_df, thr, clean_center) — Converts a 2D PSSM back to a consensus sequence string. Uses brackets for multiple high-probability amino acids and * to mark the phosphorylation center.\nseq = pssm_to_seq(\n    pssm_df=recover_pssm(pssms.iloc[0]),  # 2D PSSM (rows=AAs, cols=positions)\n    thr=0.2,           # probability threshold to include amino acid\n    clean_center=True, # keep only s/t/y at center position\n)\n# Returns e.g.: '..RR.[s/t]*....'\nget_pssm_seq_labels(pssms, count_map, thr) — Generates dendrogram labels combining the PSSM index name with its consensus sequence. Optionally includes sample counts.\nlabels = get_pssm_seq_labels(\n    pssms=pssms.head(10),  # dataframe of flattened PSSMs\n    count_map=count_dict,  # optional dict {index: count} for sample sizes\n    thr=0.3,               # probability threshold for consensus sequence\n)\n# Returns e.g.: ['AKT1 (n=60): ..RR.[s/t]*....', ...]\n\nFull Pipeline Example\n# 1. Load and subset data\npssms = Data.get_pspa_scale().head(100)\n\n# 2. Compute linkage matrix\nZ = get_Z(\n    pssms=pssms,\n    parallel=True,\n)\n\n# 3. Generate labels with consensus sequences\nlabels = get_pssm_seq_labels(\n    pssms=pssms,\n    thr=0.3,\n)\n\n# 4. Plot dendrogram\nplot_dendrogram(\n    Z=Z,\n    dense=8,\n    labels=labels,\n    truncate_mode='lastp',\n    p=40,\n)",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "clustering.html#setup",
    "href": "clustering.html#setup",
    "title": "Hierarchical clustering",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "clustering.html#distance",
    "href": "clustering.html#distance",
    "title": "Hierarchical clustering",
    "section": "Distance",
    "text": "Distance\n\npssms=Data.get_pspa_scale()\n\n\n\nget_1d_distance\n\ndef get_1d_distance(\n    df, func_flat\n):\n\nCompute 1D distance for each row in a dataframe given a distance function\n\n# return 1d distance\nget_1d_distance(pssms.head(),js_divergence_flat)\n\n\n  0%|          | 0/5 [00:00&lt;?, ?it/s]\n100%|██████████| 5/5 [00:00&lt;00:00, 296.35it/s]\n\n\narray([0.08286125, 0.08577978, 0.08798376, 0.08501009, 0.00215832,\n       0.07937984, 0.07066437, 0.08348296, 0.07361695, 0.0042525 ])\n\n\n\n\n\nget_1d_js\n\ndef get_1d_js(\n    df\n):\n\nCompute 1D distance using JS divergence.\n\ndistance = get_1d_js(pssms.head(20))\n\n\n  0%|          | 0/20 [00:00&lt;?, ?it/s]\n 25%|██▌       | 5/20 [00:00&lt;00:00, 45.19it/s]\n 65%|██████▌   | 13/20 [00:00&lt;00:00, 62.03it/s]\n100%|██████████| 20/20 [00:00&lt;00:00, 78.69it/s]\n\n\nParallel computing to accelerate when flattened pssms are too many in a df:\n\n\n\nget_1d_distance_parallel\n\ndef get_1d_distance_parallel(\n    df, func_flat, max_workers:int=4, chunksize:int=100\n):\n\nParallel compute 1D distance for each row in a dataframe given a distance function\nget_1d_distance_parallel(pssms.head(),js_divergence_flat)\n\n\n\nget_1d_js_parallel\n\ndef get_1d_js_parallel(\n    df, func_flat:function=js_divergence_flat, max_workers:int=4, chunksize:int=100\n):\n\nCompute 1D distance matrix using JS divergence.\nget_1d_js_parallel(pssms.head())\n\n\n\nget_Z\n\ndef get_Z(\n    pssms, func_flat:function=js_divergence_flat, parallel:bool=True\n):\n\nGet linkage matrix Z from pssms dataframe\n\nZ = get_Z(pssms.head(10),parallel=False)\n\n\n  0%|          | 0/10 [00:00&lt;?, ?it/s]\n100%|██████████| 10/10 [00:00&lt;00:00, 165.83it/s]\n\n\n\nZ[:5]\n\narray([[1.00000000e+00, 2.00000000e+00, 2.15831816e-03, 2.00000000e+00],\n       [3.00000000e+00, 4.00000000e+00, 4.25249792e-03, 2.00000000e+00],\n       [5.00000000e+00, 1.10000000e+01, 4.65130779e-03, 3.00000000e+00],\n       [6.00000000e+00, 7.00000000e+00, 5.89059764e-03, 2.00000000e+00],\n       [1.00000000e+01, 1.30000000e+01, 9.31412253e-03, 4.00000000e+00]])\n\n\n\n\n\nplot_dendrogram\n\ndef plot_dendrogram(\n    Z, color_thr:float=0.07, dense:int=7, # the higher the more dense for each row\n    line_width:int=1, title:NoneType=None, scale:int=1, kwargs:VAR_KEYWORD\n):\n\n\nset_sns(100)\n\n\nplot_dendrogram(Z,dense=7,line_width=1)\n\n\n\n\n\n\n\n\n\nplot_dendrogram(Z,dense=4)\n\n\n\n\n\n\n\n\n\n\n\npssm_to_seq\n\ndef pssm_to_seq(\n    pssm_df, thr:float=0.2, # threshold of probability to show in sequence\n    clean_center:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nRepresent PSSM in string sequence of amino acids\n\npssm_df = recover_pssm(pssms.iloc[0])\n\n\npssm_to_seq(pssm_df,thr=0.1)\n\n'I..QKt*G...'\n\n\n\n\n\nget_pssm_seq_labels\n\ndef get_pssm_seq_labels(\n    pssms, count_map:NoneType=None, # df index as key, counts as value\n    thr:float=0.3, # threshold of probability to show in sequence\n):\n\nUse index of pssms and the pssm to seq to represent pssm.\n\nget_pssm_seq_labels(pssms.head(10))\n\n['AAK1: .....t*G...',\n 'ACVR2A: .....[t/s]*....',\n 'ACVR2B: .....[t/s]*....',\n 'AKT1: ..RR.[s/t]*....',\n 'AKT2: ..R..[s/t]*....',\n 'AKT3: ..RR.[s/t]*....',\n 'ALK2: .....[t/s]*....',\n 'ALK4: .....[t/s]*....',\n 'ALPHAK3: .....t*....',\n 'AMPKA1: .....[s/t]*....']\n\n\n\nimport random\n\n\n# get a dict of index and counts\n\ncount_dict = {idx:random.randint(1,100) for idx in pssms.head(10).index}\n\n\nlabels= get_pssm_seq_labels(pssms.head(10),count_dict)\nlabels\n\n['AAK1 (n=47): .....t*G...',\n 'ACVR2A (n=95): .....[t/s]*....',\n 'ACVR2B (n=90): .....[t/s]*....',\n 'AKT1 (n=36): ..RR.[s/t]*....',\n 'AKT2 (n=88): ..R..[s/t]*....',\n 'AKT3 (n=61): ..RR.[s/t]*....',\n 'ALK2 (n=60): .....[t/s]*....',\n 'ALK4 (n=88): .....[t/s]*....',\n 'ALPHAK3 (n=28): .....t*....',\n 'AMPKA1 (n=92): .....[s/t]*....']\n\n\n\nplot_dendrogram(Z,dense=4,labels=labels)",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "clustering.html#full-pipeline",
    "href": "clustering.html#full-pipeline",
    "title": "Hierarchical clustering",
    "section": "Full pipeline",
    "text": "Full pipeline\n\n# get distance matrix\npssms=pssms.head(100)\n\nZ = get_Z(pssms)\n\n# optional, get counts for each index\n# count_dict = pssms.index.value_counts()\n\n# get pssm to seq labels with counts\n# labels= get_pssm_seq_labels(pssms,count_dict)\n\n# or get pssm to seq labels only\nlabels= get_pssm_seq_labels(pssms)\n\n\n\n\n\n# plot dendrogram\nplot_dendrogram(Z,dense=8,labels=labels,truncate_mode='lastp', p=40) # only show 40\n\n# save\n# save_pdf('dendrogram.pdf')",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "pssm_lo.html",
    "href": "pssm_lo.html",
    "title": "pssm.lo",
    "section": "",
    "text": "Log-Odds PSSM Calculation\nTo compute a log-odds Position-Specific Scoring Matrix (PSSM) by comparing observed amino acid frequencies against a background model:\npssm_LO = get_pssm_LO(\n    pssm_df=pssm_df,    # DataFrame of amino acid frequencies (rows=aa, cols=positions)\n    site_type='STY',    # background model: 'S', 'T', 'Y', 'ST', or 'STY'\n)\n\nTo compute a log-odds PSSM from a flattened (1D) frequency representation:\npssm_LO = get_pssm_LO_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    site_type='STY',      # background model: 'S', 'T', 'Y', 'ST', or 'STY'\n)\n\nLog-Odds Visualization\nTo visualize a log-odds PSSM as a sequence logo where letter heights reflect enrichment/depletion:\nplot_logo_LO(\n    pssm_LO=pssm_LO,        # log-odds PSSM DataFrame\n    title='Motif',          # plot title\n    acceptor=None,          # force display of central residue: 'S', 'T', or 'Y'\n    scale_zero=True,        # rescale position 0 to match max stack height\n    scale_pos_neg=True,     # normalize positive/negative stacks for visibility\n    ax=None,                # matplotlib Axes (creates new if None)\n    figsize=(10, 1),        # figure dimensions (width, height)\n)\n\nTo display both a sequence logo and a heatmap of log-odds values in a combined figure:\nplot_logo_heatmap_LO(\n    pssm_LO=pssm_LO,        # log-odds PSSM DataFrame\n    title='Motif',          # plot title\n    acceptor=None,          # force display of central residue: 'S', 'T', or 'Y'\n    figsize=(17, 10),       # figure dimensions (width, height)\n    include_zero=False,     # include position 0 in heatmap\n    scale_pos_neg=True,     # normalize color scale for positive/negative values\n)",
    "crumbs": [
      "Modules",
      "pssm.lo"
    ]
  },
  {
    "objectID": "pssm_lo.html#overview",
    "href": "pssm_lo.html#overview",
    "title": "pssm.lo",
    "section": "",
    "text": "Log-Odds PSSM Calculation\nTo compute a log-odds Position-Specific Scoring Matrix (PSSM) by comparing observed amino acid frequencies against a background model:\npssm_LO = get_pssm_LO(\n    pssm_df=pssm_df,    # DataFrame of amino acid frequencies (rows=aa, cols=positions)\n    site_type='STY',    # background model: 'S', 'T', 'Y', 'ST', or 'STY'\n)\n\nTo compute a log-odds PSSM from a flattened (1D) frequency representation:\npssm_LO = get_pssm_LO_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    site_type='STY',      # background model: 'S', 'T', 'Y', 'ST', or 'STY'\n)\n\nLog-Odds Visualization\nTo visualize a log-odds PSSM as a sequence logo where letter heights reflect enrichment/depletion:\nplot_logo_LO(\n    pssm_LO=pssm_LO,        # log-odds PSSM DataFrame\n    title='Motif',          # plot title\n    acceptor=None,          # force display of central residue: 'S', 'T', or 'Y'\n    scale_zero=True,        # rescale position 0 to match max stack height\n    scale_pos_neg=True,     # normalize positive/negative stacks for visibility\n    ax=None,                # matplotlib Axes (creates new if None)\n    figsize=(10, 1),        # figure dimensions (width, height)\n)\n\nTo display both a sequence logo and a heatmap of log-odds values in a combined figure:\nplot_logo_heatmap_LO(\n    pssm_LO=pssm_LO,        # log-odds PSSM DataFrame\n    title='Motif',          # plot title\n    acceptor=None,          # force display of central residue: 'S', 'T', or 'Y'\n    figsize=(17, 10),       # figure dimensions (width, height)\n    include_zero=False,     # include position 0 in heatmap\n    scale_pos_neg=True,     # normalize color scale for positive/negative values\n)",
    "crumbs": [
      "Modules",
      "pssm.lo"
    ]
  },
  {
    "objectID": "pssm_lo.html#setup",
    "href": "pssm_lo.html#setup",
    "title": "pssm.lo",
    "section": "Setup",
    "text": "Setup\n\nfrom katlas.data import *\n\n\ndata = Data.get_ks_dataset()\ndata_k = data[data.kinase_uniprot=='P49841'] # CDK1\npssm_df=get_prob(data_k, col='site_seq')",
    "crumbs": [
      "Modules",
      "pssm.lo"
    ]
  },
  {
    "objectID": "pssm_lo.html#calculate",
    "href": "pssm_lo.html#calculate",
    "title": "pssm.lo",
    "section": "Calculate",
    "text": "Calculate\n\n\nget_pssm_LO\n\ndef get_pssm_LO(\n    pssm_df, site_type, # S, T, Y, ST, or STY\n):\n\nGet log odds PSSM: log2 (freq pssm/background pssm).\nLet \\(P_i(x)\\) be the frequency of amino acid \\(x\\) at position \\(i\\) in the input PSSM, and let \\(B_i(x)\\) be the background frequency of amino acid \\(x\\) at the same position, derived from a background model corresponding to the specified site type (S, T, Y, or STY).\nThe log-odds score at each position \\(i\\) for amino acid \\(x\\) is computed as:\n\\[\n\\mathrm{LO}_i(x) = \\log_2 \\left( \\frac{P_i(x) + \\varepsilon}{B_i(x) + \\varepsilon} \\right)\n\\]\nwhere \\(\\varepsilon = 10^{-8}\\) is a small constant added for numerical stability and to avoid division by zero.\nThis results in a matrix where:\n\nPositive values indicate enrichment over background,\nNegative values indicate depletion relative to background,\nZero indicates no difference from the expected background.\n\n\npssm_LO = get_pssm_LO(pssm_df,'STY')\npssm_LO.head()\n\n\n\n\n\n\n\nPosition\n-20\n-19\n-18\n-17\n-16\n-15\n-14\n-13\n-12\n-11\n-10\n-9\n-8\n-7\n-6\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.059908\n0.281140\n-0.026749\n0.355318\n0.346468\n0.178779\n0.463147\n0.308758\n0.239997\n0.179283\n0.608034\n0.192985\n0.329370\n0.721201\n0.715760\n0.588674\n0.320993\n1.112040\n0.973481\n1.055403\n0.0\n1.539081\n1.109428\n0.434700\n-0.301588\n1.379883\n0.314032\n0.243357\n-0.060158\n0.644231\n0.061865\n0.161917\n0.308782\n0.140834\n0.521194\n0.373708\n0.158627\n0.462854\n0.138734\n0.658643\n0.216764\n\n\nG\n0.355425\n0.331928\n0.015762\n-0.090070\n0.155057\n-0.318908\n0.274539\n0.486357\n-0.081333\n-0.044640\n-0.023817\n0.297183\n-0.167014\n-0.096944\n-0.092276\n-0.064319\n-0.075365\n0.473975\n0.243292\n0.358158\n0.0\n0.235499\n-0.025131\n0.284594\n-0.457652\n-0.327199\n-0.123033\n0.303309\n0.315783\n-0.190655\n-0.067465\n0.298568\n0.361469\n0.170286\n0.215167\n0.258789\n-0.054255\n-0.185829\n0.200256\n0.388134\n-0.066157\n\n\nA\n0.445724\n0.399204\n0.032468\n0.105841\n0.037853\n0.527832\n0.039466\n-0.201953\n0.117073\n0.243623\n0.053728\n-0.015571\n0.335906\n0.169137\n-0.130969\n-0.098714\n-0.444541\n0.119458\n0.286568\n0.060413\n0.0\n-0.584316\n0.490663\n-0.075931\n-0.078570\n0.109301\n0.496097\n0.191241\n-0.008452\n-0.306504\n0.241955\n-0.675462\n-0.013856\n0.172464\n-0.080489\n-0.019176\n0.360468\n0.315254\n0.109869\n-0.375457\n0.164260\n\n\nC\n0.537945\n-0.956246\n-0.269417\n-0.055141\n-0.547438\n-0.718577\n-0.987818\n0.075745\n0.419542\n-0.634510\n-0.603081\n-0.233384\n0.494481\n0.142392\n0.851304\n0.003453\n-0.677106\n-0.935493\n0.789298\n0.156753\n0.0\n-0.937435\n0.945576\n0.925658\n-1.573420\n-1.149739\n0.860460\n-0.169595\n-0.143715\n0.200914\n-0.385030\n0.235879\n0.725572\n-0.115854\n0.491228\n-0.070391\n-0.647993\n-0.426118\n1.057556\n-1.543537\n-0.898042\n\n\nS\n0.482063\n0.128128\n0.452159\n-0.214803\n0.139830\n0.049341\n0.317830\n-0.214082\n0.175540\n-0.036560\n0.017835\n0.187378\n0.362312\n-0.239848\n0.014115\n0.612648\n-0.070659\n-0.737274\n0.126846\n0.744032\n0.0\n-0.314505\n0.076891\n0.803635\n0.224781\n-0.198496\n0.474760\n0.303879\n0.367185\n-0.142147\n0.492529\n0.309106\n-0.086104\n-0.016800\n-0.160346\n-0.145271\n-0.167390\n-0.262078\n0.101268\n0.189145\n0.426381\n\n\n\n\n\n\n\n\n\n\nget_pssm_LO_flat\n\ndef get_pssm_LO_flat(\n    flat_pssm, site_type, # S, T, Y, ST, or STY\n):\n\n\nflat_pssm=pd.Series(flatten_pssm(pssm_df))\n\n\npssm_LO = get_pssm_LO_flat(flat_pssm,'STY')\npssm_LO\n\n\n\n\n\n\n\nPosition\n-20\n-19\n-18\n-17\n-16\n-15\n-14\n-13\n-12\n-11\n-10\n-9\n-8\n-7\n-6\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.059908\n0.281140\n-0.026749\n0.355318\n0.346468\n0.178779\n0.463147\n0.308758\n0.239997\n0.179283\n0.608034\n0.192985\n0.329370\n0.721201\n0.715760\n0.588674\n0.320993\n1.112040\n0.973481\n1.055403\n0.000000\n1.539081\n1.109428\n0.434700\n-0.301588\n1.379883\n0.314032\n0.243357\n-0.060158\n0.644231\n0.061865\n0.161917\n0.308782\n0.140834\n0.521194\n0.373708\n0.158627\n0.462854\n0.138734\n0.658643\n0.216764\n\n\nG\n0.355425\n0.331928\n0.015762\n-0.090070\n0.155057\n-0.318908\n0.274539\n0.486357\n-0.081333\n-0.044640\n-0.023817\n0.297183\n-0.167014\n-0.096944\n-0.092276\n-0.064319\n-0.075365\n0.473975\n0.243292\n0.358158\n0.000000\n0.235499\n-0.025131\n0.284594\n-0.457652\n-0.327199\n-0.123033\n0.303309\n0.315783\n-0.190655\n-0.067465\n0.298568\n0.361469\n0.170286\n0.215167\n0.258789\n-0.054255\n-0.185829\n0.200256\n0.388134\n-0.066157\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nt\n0.338037\n-0.508472\n0.536544\n0.409825\n0.546294\n0.066828\n0.190809\n-0.298146\n0.023876\n0.295761\n0.995227\n1.015112\n0.246666\n-0.332277\n0.195250\n0.680780\n1.210743\n0.166721\n0.546415\n-0.157283\n0.329833\n-0.420698\n-0.286888\n0.507349\n1.536109\n0.349480\n0.508819\n1.032751\n0.944610\n0.697806\n1.386345\n0.723589\n0.986439\n-0.036165\n0.368048\n-0.516571\n-0.021008\n0.119857\n0.161114\n-0.047991\n-0.097686\n\n\ny\n-1.109821\n0.265760\n-0.184739\n0.075387\n0.307806\n0.041911\n-0.180464\n-1.440588\n-0.516052\n0.508038\n-0.011805\n0.496492\n-0.749242\n0.261563\n0.139186\n0.233321\n-1.138437\n-1.195610\n-1.747661\n-1.166771\n-2.655631\n-0.065791\n-1.535247\n-0.045814\n0.191191\n-1.732180\n-1.613038\n-0.465142\n-0.886647\n-0.336320\n-0.712011\n0.069406\n-0.161659\n-0.829713\n0.474154\n-0.851437\n-0.438485\n-0.267581\n0.642920\n-0.356680\n0.230591\n\n\n\n\n23 rows × 41 columns",
    "crumbs": [
      "Modules",
      "pssm.lo"
    ]
  },
  {
    "objectID": "pssm_lo.html#plot",
    "href": "pssm_lo.html#plot",
    "title": "pssm.lo",
    "section": "Plot",
    "text": "Plot\n\n\nplot_logo_LO\n\ndef plot_logo_LO(\n    pssm_LO, title:str='Motif', acceptor:NoneType=None, scale_zero:bool=True, scale_pos_neg:bool=True,\n    ax:NoneType=None, figsize:tuple=(10, 1)\n):\n\nPlot logo of log-odds given a frequency PSSM.\nTo ensure the phosphorylated residue is visible at the center of a log-odds motif (position 0), two mechanisms are used:\n\nAcceptor override: If the center column is entirely zero (e.g., masked), the user can specify an acceptor ('S', 'T', 'Y', or 'STY'). The function then assigns a small nonzero value (e.g., 0.1) to the corresponding phospho-residue row (pS, pT, pY) at position 0. This ensures the central letter appears in the logo plot, even when real log-odds values are absent.\nStack height rescaling: To maintain visual consistency with surrounding columns, position 0 is rescaled so that its total positive and negative stack heights match the most extreme values observed elsewhere.\n\nTogether, these adjustments ensure that: - The phospho-acceptor appears explicitly at the center, - The visual scale remains consistent with neighboring positions, - The resulting logo can faithfully reflect both biological relevance and statistical signal.\n\npssm_LO = get_pssm_LO(pssm_df,'STY')\nplot_logo_LO(pssm_LO,scale_zero=False,scale_pos_neg=False)\n\n\n\n\n\n\n\n\n\n# with zero position scaled to the max\nplot_logo_LO(pssm_LO,scale_zero=True,scale_pos_neg=False)\n\n\n\n\n\n\n\n\n\n# scaled positive and negative values for better visualization\nplot_logo_LO(pssm_LO,scale_zero=True,scale_pos_neg=True)\n\n\n\n\n\n\n\n\n\n# # for those specific site type (S,T or Y), show acceptor in the middle instead of empty\n# pssm_LO = get_pssm_LO(pssm_y,'Y')\n# plot_logo_LO(pssm_LO,acceptor='Y')\n\n\nplt.close('all')\n\n\n\n\nplot_logo_heatmap_LO\n\ndef plot_logo_heatmap_LO(\n    pssm_LO, # pssm of log-odds\n    title:str='Motif', acceptor:NoneType=None, figsize:tuple=(17, 10), include_zero:bool=False,\n    scale_pos_neg:bool=True\n):\n\nPlot logo and heatmap of enrichment bits vertically\n\n# plot_logo_heatmap_LO(pssm_LO,acceptor='Y')\n\n\npssm_LO = get_pssm_LO(pssm_df,'STY')\nplot_logo_heatmap_LO(pssm_LO,scale_pos_neg=False) # normal color scale\n\n\n\n\n\n\n\n\n\nplt.close('all')",
    "crumbs": [
      "Modules",
      "pssm.lo"
    ]
  },
  {
    "objectID": "ml.html",
    "href": "ml.html",
    "title": "Train ML",
    "section": "",
    "text": "A collection of utilities for training, evaluating, and deploying scikit-learn models for kinase substrate specificity prediction.\n\nData Splitting\nget_splits - Creates cross-validation splits using stratified, grouped, or stratified-grouped KFold methods. This ensures proper data separation to avoid data leakage (e.g., keeping kinases from the same subfamily in the same fold).\nsplits = get_splits(\n    df=pspa_info,        # DataFrame containing metadata for splitting\n    stratified=None,     # column name for stratified sampling (samples from different strata in each fold)\n    group='subfamily',   # column name for group splitting (train/test never share groups)\n    nfold=5,             # number of cross-validation folds\n    seed=123,            # random seed for reproducibility\n)\nsplit_data - Splits a dataframe into train/test features and targets based on a single split tuple from get_splits.\nX_train, y_train, X_test, y_test = split_data(\n    df=df,               # full DataFrame with features and targets\n    feat_col=feat_col,   # list of feature column names (e.g., T5 embeddings)\n    target_col=target_col,  # list of target column names (e.g., PSSM values)\n    split=splits[0],     # tuple of (train_indices, test_indices)\n)\n\nModel Training\ntrain_ml - Fits a single sklearn model on one train/test split and returns predictions on the test set. Optionally saves the trained model.\ny_test, y_pred = train_ml(\n    df=df,                    # DataFrame with features and targets\n    feat_col=feat_col,        # feature column names\n    target_col=target_col,    # target column names\n    split=splits[0],          # single split tuple (train_idx, test_idx)\n    model=LinearRegression(), # any sklearn-compatible model\n    save='models/lr_fold0.joblib',  # path to save model (None to skip)\n    params={},                # extra kwargs passed to model.fit()\n)\ntrain_ml_cv - Performs full cross-validation across all splits, returning out-of-fold (OOF) predictions for the entire dataset.\noof = train_ml_cv(\n    df=df,                    # DataFrame with features and targets\n    feat_col=feat_col,        # feature column names\n    target_col=target_col,    # target column names\n    splits=splits,            # list of split tuples from get_splits\n    model=Ridge(alpha=1.0),   # sklearn model (re-instantiated each fold)\n    save='ridge',             # base name for saved models (becomes ridge_0.joblib, etc.)\n    params={},                # extra kwargs for model.fit()\n)\n\nPost-Processing\npost_process - Cleans raw PSSM predictions by clipping negatives to zero, cleaning position zero, and normalizing each position to sum to 1.\npssm_clean = post_process(\n    pssm_df=raw_pssm,    # raw PSSM DataFrame (positions × amino acids)\n)\npost_process_oof - Applies post_process to all rows in an OOF prediction DataFrame.\noof_clean = post_process_oof(\n    oof_ml=oof,          # OOF DataFrame from train_ml_cv\n    target_col=target_col,  # target column names to process\n)\n\nScoring\nget_score - Computes a per-sample score between target and prediction using a custom function.\nscores = get_score(\n    target=df[target_col],  # ground truth DataFrame\n    pred=oof[target_col],   # predictions DataFrame\n    func=js_divergence_flat,  # scoring function (target_row, pred_row) -&gt; float\n)\nConvenience partials - Pre-configured scorers:\njsd_scores = get_score_jsd(target=df[target_col], pred=oof)  # Jensen-Shannon divergence\nkld_scores = get_score_kld(target=df[target_col], pred=oof)  # KL divergence\nce_scores  = get_score_ce(target=df[target_col], pred=oof)   # Cross-entropy\n\nInference\npredict_ml - Loads a saved model and generates predictions on new data.\npredictions = predict_ml(\n    df=new_data,              # DataFrame containing features\n    feat_col=feat_col,        # feature column names (must match training)\n    target_col=target_col,    # column names for output DataFrame\n    model_pth='models/ridge_0.joblib',  # path to saved model\n)\n\nTypical Workflow\n# 1. Prepare splits (group by subfamily to prevent leakage)\nsplits = get_splits(df=info, group='subfamily', nfold=5)\n\n# 2. Train with cross-validation\noof = train_ml_cv(df=df, feat_col=feat_col, target_col=target_col, \n                  splits=splits, model=Ridge(), save='ridge')\n\n# 3. Post-process predictions\noof = post_process_oof(oof_ml=oof, target_col=target_col)\n\n# 4. Evaluate\ninfo['jsd'] = get_score_jsd(target=df[target_col], pred=oof)\nprint(f\"Mean JSD: {info.groupby('nfold').jsd.mean()}\")\n\n# 5. Deploy\npred = predict_ml(df=test_df, feat_col=feat_col, target_col=target_col,\n                  model_pth='models/ridge_0.joblib')",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#overview",
    "href": "ml.html#overview",
    "title": "Train ML",
    "section": "",
    "text": "A collection of utilities for training, evaluating, and deploying scikit-learn models for kinase substrate specificity prediction.\n\nData Splitting\nget_splits - Creates cross-validation splits using stratified, grouped, or stratified-grouped KFold methods. This ensures proper data separation to avoid data leakage (e.g., keeping kinases from the same subfamily in the same fold).\nsplits = get_splits(\n    df=pspa_info,        # DataFrame containing metadata for splitting\n    stratified=None,     # column name for stratified sampling (samples from different strata in each fold)\n    group='subfamily',   # column name for group splitting (train/test never share groups)\n    nfold=5,             # number of cross-validation folds\n    seed=123,            # random seed for reproducibility\n)\nsplit_data - Splits a dataframe into train/test features and targets based on a single split tuple from get_splits.\nX_train, y_train, X_test, y_test = split_data(\n    df=df,               # full DataFrame with features and targets\n    feat_col=feat_col,   # list of feature column names (e.g., T5 embeddings)\n    target_col=target_col,  # list of target column names (e.g., PSSM values)\n    split=splits[0],     # tuple of (train_indices, test_indices)\n)\n\nModel Training\ntrain_ml - Fits a single sklearn model on one train/test split and returns predictions on the test set. Optionally saves the trained model.\ny_test, y_pred = train_ml(\n    df=df,                    # DataFrame with features and targets\n    feat_col=feat_col,        # feature column names\n    target_col=target_col,    # target column names\n    split=splits[0],          # single split tuple (train_idx, test_idx)\n    model=LinearRegression(), # any sklearn-compatible model\n    save='models/lr_fold0.joblib',  # path to save model (None to skip)\n    params={},                # extra kwargs passed to model.fit()\n)\ntrain_ml_cv - Performs full cross-validation across all splits, returning out-of-fold (OOF) predictions for the entire dataset.\noof = train_ml_cv(\n    df=df,                    # DataFrame with features and targets\n    feat_col=feat_col,        # feature column names\n    target_col=target_col,    # target column names\n    splits=splits,            # list of split tuples from get_splits\n    model=Ridge(alpha=1.0),   # sklearn model (re-instantiated each fold)\n    save='ridge',             # base name for saved models (becomes ridge_0.joblib, etc.)\n    params={},                # extra kwargs for model.fit()\n)\n\nPost-Processing\npost_process - Cleans raw PSSM predictions by clipping negatives to zero, cleaning position zero, and normalizing each position to sum to 1.\npssm_clean = post_process(\n    pssm_df=raw_pssm,    # raw PSSM DataFrame (positions × amino acids)\n)\npost_process_oof - Applies post_process to all rows in an OOF prediction DataFrame.\noof_clean = post_process_oof(\n    oof_ml=oof,          # OOF DataFrame from train_ml_cv\n    target_col=target_col,  # target column names to process\n)\n\nScoring\nget_score - Computes a per-sample score between target and prediction using a custom function.\nscores = get_score(\n    target=df[target_col],  # ground truth DataFrame\n    pred=oof[target_col],   # predictions DataFrame\n    func=js_divergence_flat,  # scoring function (target_row, pred_row) -&gt; float\n)\nConvenience partials - Pre-configured scorers:\njsd_scores = get_score_jsd(target=df[target_col], pred=oof)  # Jensen-Shannon divergence\nkld_scores = get_score_kld(target=df[target_col], pred=oof)  # KL divergence\nce_scores  = get_score_ce(target=df[target_col], pred=oof)   # Cross-entropy\n\nInference\npredict_ml - Loads a saved model and generates predictions on new data.\npredictions = predict_ml(\n    df=new_data,              # DataFrame containing features\n    feat_col=feat_col,        # feature column names (must match training)\n    target_col=target_col,    # column names for output DataFrame\n    model_pth='models/ridge_0.joblib',  # path to saved model\n)\n\nTypical Workflow\n# 1. Prepare splits (group by subfamily to prevent leakage)\nsplits = get_splits(df=info, group='subfamily', nfold=5)\n\n# 2. Train with cross-validation\noof = train_ml_cv(df=df, feat_col=feat_col, target_col=target_col, \n                  splits=splits, model=Ridge(), save='ridge')\n\n# 3. Post-process predictions\noof = post_process_oof(oof_ml=oof, target_col=target_col)\n\n# 4. Evaluate\ninfo['jsd'] = get_score_jsd(target=df[target_col], pred=oof)\nprint(f\"Mean JSD: {info.groupby('nfold').jsd.mean()}\")\n\n# 5. Deploy\npred = predict_ml(df=test_df, feat_col=feat_col, target_col=target_col,\n                  model_pth='models/ridge_0.joblib')",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#setup",
    "href": "ml.html#setup",
    "title": "Train ML",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#splitter",
    "href": "ml.html#splitter",
    "title": "Train ML",
    "section": "Splitter",
    "text": "Splitter\n\n\nget_splits\n\ndef get_splits(\n    df:DataFrame, # df contains info for split\n    stratified:str=None, # colname to make stratified kfold; sampling from different groups\n    group:str=None, # colname to make group kfold; test and train are from different groups\n    nfold:int=5, seed:int=123\n):\n\nSplit samples in a dataframe based on Stratified, Group, or StratifiedGroup Kfold method\n\n!ls\n\n00_data.ipynb        02e_pssm_compare.ipynb  07_pathway.ipynb      custom.scss\n01_utils.ipynb       03_scoring.ipynb        10_ML.ipynb       index.ipynb\n02a_pssm_core.ipynb  04_clustering.ipynb     11_DNN.ipynb      models\n02b_pssm_plot.ipynb  04b_hierarchical.ipynb  _08_statistics.ipynb  nbdev.yml\n02c_pssm_lo.ipynb    05_feature.ipynb        _quarto.yml       styles.css\n02d_pssm_pspa.ipynb  06_plot.ipynb       _test.ipynb\n\n\n\n# df=pd.read_parquet('paper/kinase_domain/train/pspa_t5.parquet')\n\n\n# info=Data.get_kinase_info()\n\n# info = info[info.pseudo=='0']\n\n# info = info[info.kd_ID.notna()]\n\n# subfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\n\n# pspa_info = pd.DataFrame(df.index.tolist(),columns=['kinase'])\n\n# pspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\n\n# splits = get_splits(pspa_info, group='subfamily',nfold=5)\n\n# split0 = splits[0]\n\n\n# df=df.reset_index()\n\n\n# df.columns\n\n\n# # column name of feature and target\n# feat_col = df.columns[df.columns.str.startswith('T5_')]\n# target_col = df.columns[~df.columns.isin(feat_col)][1:]\n\n\n# feat_col\n\n\n# target_col\n\n\n\n\nsplit_data\n\ndef split_data(\n    df:DataFrame, # dataframe of values\n    feat_col:list, # feature columns\n    target_col:list, # target columns\n    split:tuple, # one of the split in splits\n):\n\nGiven split tuple, split dataframe into X_train, y_train, X_test, y_test\n\n# X_train, y_train, X_test, y_test = split_data(df,feat_col, target_col, split0)\n\n\n# X_train.shape,y_train.shape,X_test.shape,y_test.shape",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#trainer",
    "href": "ml.html#trainer",
    "title": "Train ML",
    "section": "Trainer",
    "text": "Trainer\n\n\ntrain_ml\n\ndef train_ml(\n    df, # dataframe of values\n    feat_col, # feature columns\n    target_col, # target columns\n    split, # one split in splits\n    model, # a sklearn models\n    save:NoneType=None, # file (.joblib) to save, e.g. 'model.joblib'\n    params:NoneType=None, # dict parameters for model.fit from sklearn\n):\n\nFit and predict using sklearn model format, return target and pred of valid dataset.\n\n# model = LinearRegression()\n\n# ## Uncheck to run with saving model\n# # target,pred = train_ml(df, feat_col, target_col, split0, model,'model.joblib')\n\n# # Run without saving model\n# target,pred = train_ml(df, feat_col, target_col, split0, model)\n\n# pred.head()",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#cross-validation",
    "href": "ml.html#cross-validation",
    "title": "Train ML",
    "section": "Cross-Validation",
    "text": "Cross-Validation\n\n\ntrain_ml_cv\n\ndef train_ml_cv(\n    df, # dataframe of values\n    feat_col, # feature columns\n    target_col, # target columns\n    splits, # splits\n    model, # sklearn model\n    save:NoneType=None, # model name to be saved, e.g., 'LR'\n    params:NoneType=None, # act as kwargs, for model.fit\n):\n\nCross-validation through the given splits\n\n# oof = train_ml_cv(df,feat_col,target_col,splits=splits,model=model)",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#score",
    "href": "ml.html#score",
    "title": "Train ML",
    "section": "Score",
    "text": "Score\n\n\npost_process\n\ndef post_process(\n    pssm_df\n):\n\nConvert neg value to 0, clean non-last three values in position zero, and normalize each position\n\n# pssm = post_process(recover_pssm(oof.iloc[0,:-1].sort_values()))\n\n\n# pssm.sum()\n\n\n\n\npost_process_oof\n\ndef post_process_oof(\n    oof_ml, target_col\n):\n\n\n# oof = post_process_oof(oof,target_col)\n\n\n\n\nget_score\n\ndef get_score(\n    target, pred, func\n):\n\n\n# target = df[target_col].copy()\n\n\n# pspa_info['jsd'] =get_score_jsd(target,oof)\n# pspa_info['kld'] =get_score_kld(target,oof)\n\n\n# pspa_info['jsd']\n\n\n# pspa_info['kld']\n\n\n\n\ncalculate_ce\n\ndef calculate_ce(\n    target_series, pred_series\n):\n\n\n# pspa_info['ce'] =get_score_ce(target,oof)\n\n\n# pspa_info['ce']\n\n\n# pspa_info['nfold'] = oof['nfold']\n\n\n# pspa_info.groupby('nfold').jsd.mean()",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "ml.html#predictor",
    "href": "ml.html#predictor",
    "title": "Train ML",
    "section": "Predictor",
    "text": "Predictor\n\n\npredict_ml\n\ndef predict_ml(\n    df, # Dataframe that contains features\n    feat_col, # feature columns\n    target_col:NoneType=None, model_pth:str='model.joblib'\n):\n\nMake predictions based on trained model.\nUncheck below to run if you have model_pth:\n\n# pred2 = predict_ml(X_test,feat_col, target_col, model_pth = 'model.joblib')\n# pred2.head()\n## or\n# predict_ml(df.iloc[split_0[1]],feat_col,'model.joblib')",
    "crumbs": [
      "Modules",
      "Train ML"
    ]
  },
  {
    "objectID": "pathway.html",
    "href": "pathway.html",
    "title": "Pathway analysis",
    "section": "",
    "text": "Reactome Pathway Enrichment\nget_reactome_raw(gene_list) — Performs Reactome pathway analysis on a gene set and returns the complete raw output as a DataFrame. Includes all pathway metadata (IDs, names, p-values, entity counts, reaction ratios).\nget_reactome(gene_list, p_type) — Wrapper around get_reactome_raw that returns a cleaned DataFrame with pathway names, Reactome IDs, p-values (or FDR), and -log10 transformed values.\npath = get_reactome(\n    gene_list=pi3ks,   # list of gene symbols to analyze\n    p_type='FDR',      # 'FDR' or 'p' for raw p-value\n)\n\nReference Database Queries\nquery_reactome(uniprot_id) — Queries a UniProt ID against the Reactome pathway database. Returns all pathways (at any hierarchy level) that the protein participates in, with a lowest flag indicating leaf-level pathways.\nadd_reactome_ref(df, uniprot) — Augments a pathway analysis DataFrame with reference columns indicating whether each pathway is annotated for a specific protein. Also appends any missing pathways from the reference (with p=1.0).\nout = add_reactome_ref(\n    df=path,           # output DataFrame from get_reactome()\n    uniprot='P31749',  # UniProt ID of kinase to check against\n)\n# Adds columns: ref_path (1/0), ref_path_lowest (1/0)\n\nVisualization\nplot_path(react_df, ...) — Creates a horizontal bar plot of top enriched pathways. Optionally highlights bars in dark red for pathways matching a reference set.\nplot_path(\n    react_df=out,                # pathway DataFrame with -log10 p-values\n    p_type='FDR',                # 'FDR' or 'p' - which p-value column to plot\n    ref_col='ref_path',          # column name (1/0) to highlight matching bars\n    ref_id_list=None,            # alternative: list of reactome_ids to highlight\n    top_n=15,                    # number of top pathways to display\n    max_label_length=80,         # truncate pathway names longer than this\n)\n\nOverlap Statistics\nget_overlap(react_df, ...) — Calculates what fraction of reference pathways pass a significance threshold. Optionally plots a histogram of -log10(p) values with a threshold line.\naccuracy = get_overlap(\n    react_df=out,                # pathway DataFrame from add_reactome_ref()\n    ref_col='ref_path_lowest',   # column name (1/0) indicating reference pathways\n    ref_id_list=None,            # alternative: list of reactome_ids\n    p_type='FDR',                # 'FDR' or 'p'\n    thr=0.05,                    # significance threshold (before log transform)\n    plot=True,                   # whether to show histogram\n    figsize=(5, 3),              # figure size tuple\n)\n# Returns: float (fraction passing threshold, e.g., 0.97)\n\nComplete Pipeline Example\n# 1. Run pathway enrichment on gene set\nout = get_reactome(\n    gene_list=pi3ks,   # list of gene symbols\n    p_type='FDR',      # use FDR-corrected p-values\n)\n\n# 2. Add reference annotations for a specific kinase\nout = add_reactome_ref(\n    df=out,            # enrichment results\n    uniprot='P31749',  # AKT1 UniProt ID\n)\n\n# 3. Visualize top pathways with reference highlighting\nplot_path(\n    react_df=out,              # augmented DataFrame\n    p_type='FDR',              # plot -log10(FDR)\n    ref_col='ref_path_lowest', # highlight lowest-level reference pathways\n    top_n=15,                  # show top 15\n)\n\n# 4. Calculate overlap accuracy\naccuracy = get_overlap(\n    react_df=out,              # augmented DataFrame\n    ref_col='ref_path_lowest', # evaluate against lowest-level pathways\n    thr=0.05,                  # FDR &lt; 0.05 significance cutoff\n    plot=True,                 # show histogram\n)",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#overview",
    "href": "pathway.html#overview",
    "title": "Pathway analysis",
    "section": "",
    "text": "Reactome Pathway Enrichment\nget_reactome_raw(gene_list) — Performs Reactome pathway analysis on a gene set and returns the complete raw output as a DataFrame. Includes all pathway metadata (IDs, names, p-values, entity counts, reaction ratios).\nget_reactome(gene_list, p_type) — Wrapper around get_reactome_raw that returns a cleaned DataFrame with pathway names, Reactome IDs, p-values (or FDR), and -log10 transformed values.\npath = get_reactome(\n    gene_list=pi3ks,   # list of gene symbols to analyze\n    p_type='FDR',      # 'FDR' or 'p' for raw p-value\n)\n\nReference Database Queries\nquery_reactome(uniprot_id) — Queries a UniProt ID against the Reactome pathway database. Returns all pathways (at any hierarchy level) that the protein participates in, with a lowest flag indicating leaf-level pathways.\nadd_reactome_ref(df, uniprot) — Augments a pathway analysis DataFrame with reference columns indicating whether each pathway is annotated for a specific protein. Also appends any missing pathways from the reference (with p=1.0).\nout = add_reactome_ref(\n    df=path,           # output DataFrame from get_reactome()\n    uniprot='P31749',  # UniProt ID of kinase to check against\n)\n# Adds columns: ref_path (1/0), ref_path_lowest (1/0)\n\nVisualization\nplot_path(react_df, ...) — Creates a horizontal bar plot of top enriched pathways. Optionally highlights bars in dark red for pathways matching a reference set.\nplot_path(\n    react_df=out,                # pathway DataFrame with -log10 p-values\n    p_type='FDR',                # 'FDR' or 'p' - which p-value column to plot\n    ref_col='ref_path',          # column name (1/0) to highlight matching bars\n    ref_id_list=None,            # alternative: list of reactome_ids to highlight\n    top_n=15,                    # number of top pathways to display\n    max_label_length=80,         # truncate pathway names longer than this\n)\n\nOverlap Statistics\nget_overlap(react_df, ...) — Calculates what fraction of reference pathways pass a significance threshold. Optionally plots a histogram of -log10(p) values with a threshold line.\naccuracy = get_overlap(\n    react_df=out,                # pathway DataFrame from add_reactome_ref()\n    ref_col='ref_path_lowest',   # column name (1/0) indicating reference pathways\n    ref_id_list=None,            # alternative: list of reactome_ids\n    p_type='FDR',                # 'FDR' or 'p'\n    thr=0.05,                    # significance threshold (before log transform)\n    plot=True,                   # whether to show histogram\n    figsize=(5, 3),              # figure size tuple\n)\n# Returns: float (fraction passing threshold, e.g., 0.97)\n\nComplete Pipeline Example\n# 1. Run pathway enrichment on gene set\nout = get_reactome(\n    gene_list=pi3ks,   # list of gene symbols\n    p_type='FDR',      # use FDR-corrected p-values\n)\n\n# 2. Add reference annotations for a specific kinase\nout = add_reactome_ref(\n    df=out,            # enrichment results\n    uniprot='P31749',  # AKT1 UniProt ID\n)\n\n# 3. Visualize top pathways with reference highlighting\nplot_path(\n    react_df=out,              # augmented DataFrame\n    p_type='FDR',              # plot -log10(FDR)\n    ref_col='ref_path_lowest', # highlight lowest-level reference pathways\n    top_n=15,                  # show top 15\n)\n\n# 4. Calculate overlap accuracy\naccuracy = get_overlap(\n    react_df=out,              # augmented DataFrame\n    ref_col='ref_path_lowest', # evaluate against lowest-level pathways\n    thr=0.05,                  # FDR &lt; 0.05 significance cutoff\n    plot=True,                 # show histogram\n)",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#setup",
    "href": "pathway.html#setup",
    "title": "Pathway analysis",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#reactome-pathway",
    "href": "pathway.html#reactome-pathway",
    "title": "Pathway analysis",
    "section": "Reactome pathway",
    "text": "Reactome pathway\n\n\nget_reactome_raw\n\ndef get_reactome_raw(\n    gene_list\n):\n\nReactome pathway analysis for a given gene set; returns raw output in dataframe.\n\npi3ks=['PIK3CA','PIK3CB','PIK3CD','PIK3CG','PIK3R1','PIK3R2','PIK3R3','PTEN','AKT1','AKT2','AKT3','MTOR','RICTOR','RPTOR','TSC1','TSC2','PDK1','IRS1','IRS2','INSR','IGF1R','GAB1','HRAS','NRAS','KRAS','EGFR','ERBB2','ERBB3','ERBB4']\n\n\nraw_out = get_reactome_raw(pi3ks)\nraw_out.head()\n\n\n\n\n\n\n\n\nstId\ndbId\nname\nllp\ninDisease\nspecies.dbId\nspecies.taxId\nspecies.name\nentities.resource\nentities.total\nentities.found\nentities.ratio\nentities.pValue\nentities.fdr\nentities.exp\nreactions.resource\nreactions.total\nreactions.found\nreactions.ratio\n\n\n\n\n0\nR-HSA-1963640\n1963640\nGRB2 events in ERBB2 signaling\nTrue\nFalse\n48887\n9606\nHomo sapiens\nTOTAL\n21\n9\n0.001301\n1.110223e-16\n1.221245e-15\n[]\nTOTAL\n4\n4\n0.000252\n\n\n1\nR-HSA-9665348\n9665348\nSignaling by ERBB2 ECD mutants\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n23\n9\n0.001425\n1.110223e-16\n1.221245e-15\n[]\nTOTAL\n15\n15\n0.000945\n\n\n2\nR-HSA-9664565\n9664565\nSignaling by ERBB2 KD Mutants\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n35\n13\n0.002168\n1.110223e-16\n1.221245e-15\n[]\nTOTAL\n17\n17\n0.001071\n\n\n3\nR-HSA-1227990\n1227990\nSignaling by ERBB2 in Cancer\nFalse\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n36\n13\n0.002230\n1.110223e-16\n1.221245e-15\n[]\nTOTAL\n62\n62\n0.003907\n\n\n4\nR-HSA-9665686\n9665686\nSignaling by ERBB2 TMD/JMD mutants\nTrue\nTrue\n48887\n9606\nHomo sapiens\nTOTAL\n30\n10\n0.001858\n1.110223e-16\n1.221245e-15\n[]\nTOTAL\n13\n13\n0.000819\n\n\n\n\n\n\n\n\n\n\nget_reactome\n\ndef get_reactome(\n    gene_list, p_type:str='FDR', # or p\n):\n\nReactome pathway analysis for a given gene set; returns formated output in dataframe with additional -log10(p)\n\npath = get_reactome(pi3ks,p_type='p')\npath.head()\n\nRunning pathway analysis\nDone\n\n\n\n\n\n\n\n\n\nname\nreactome_id\np\n-log10_p\n\n\n\n\n0\nGRB2 events in ERBB2 signaling\nR-HSA-1963640\n1.110223e-16\n15.955\n\n\n1\nSignaling by ERBB2 ECD mutants\nR-HSA-9665348\n1.110223e-16\n15.955\n\n\n2\nSignaling by ERBB2 KD Mutants\nR-HSA-9664565\n1.110223e-16\n15.955\n\n\n3\nSignaling by ERBB2 in Cancer\nR-HSA-1227990\n1.110223e-16\n15.955\n\n\n4\nSignaling by ERBB2 TMD/JMD mutants\nR-HSA-9665686\n1.110223e-16\n15.955\n\n\n\n\n\n\n\n\npath = get_reactome(pi3ks,p_type='FDR')\npath.head()\n\nRunning pathway analysis\nDone\n\n\n\n\n\n\n\n\n\nname\nreactome_id\nFDR\n-log10_FDR\n\n\n\n\n0\nGRB2 events in ERBB2 signaling\nR-HSA-1963640\n1.221245e-15\n14.913\n\n\n1\nSignaling by ERBB2 ECD mutants\nR-HSA-9665348\n1.221245e-15\n14.913\n\n\n2\nSignaling by ERBB2 KD Mutants\nR-HSA-9664565\n1.221245e-15\n14.913\n\n\n3\nSignaling by ERBB2 in Cancer\nR-HSA-1227990\n1.221245e-15\n14.913\n\n\n4\nSignaling by ERBB2 TMD/JMD mutants\nR-HSA-9665686\n1.221245e-15\n14.913\n\n\n\n\n\n\n\n\npath[path.FDR&lt;0.05]\n\n\n\n\n\n\n\n\nname\nreactome_id\nFDR\n-log10_FDR\n\n\n\n\n0\nGRB2 events in ERBB2 signaling\nR-HSA-1963640\n1.221245e-15\n14.913\n\n\n1\nSignaling by ERBB2 ECD mutants\nR-HSA-9665348\n1.221245e-15\n14.913\n\n\n2\nSignaling by ERBB2 KD Mutants\nR-HSA-9664565\n1.221245e-15\n14.913\n\n\n3\nSignaling by ERBB2 in Cancer\nR-HSA-1227990\n1.221245e-15\n14.913\n\n\n4\nSignaling by ERBB2 TMD/JMD mutants\nR-HSA-9665686\n1.221245e-15\n14.913\n\n\n...\n...\n...\n...\n...\n\n\n324\nSignaling by Rho GTPases\nR-HSA-194315\n4.264432e-02\n1.370\n\n\n325\nRUNX3 regulates p14-ARF\nR-HSA-8951936\n4.269110e-02\n1.370\n\n\n326\nCellular response to chemical stress\nR-HSA-9711123\n4.373732e-02\n1.359\n\n\n327\nSignaling by Rho GTPases, Miro GTPases and RHO...\nR-HSA-9716542\n4.619382e-02\n1.335\n\n\n328\nMetabolism of lipids\nR-HSA-556833\n4.924793e-02\n1.308\n\n\n\n\n329 rows × 4 columns",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#reference",
    "href": "pathway.html#reference",
    "title": "Pathway analysis",
    "section": "Reference",
    "text": "Reference\nDownload from Reactome/Download_data: https://reactome.org/download-data\nDownload UniProt to All pathways under Identifier mapping files\nfor type, there are IEA (Inferred from Electronic Annotation) and TAS (Traceable Author Statement, higher confidence)\n\nref = Data.get_reactome_pathway()\n\n\nref.head()\n\n\n\n\n\n\n\n\nuniprot\nreactome_id\npathway\ntype\nspecies\n\n\n\n\n0\nA0A023GPK8\nR-DME-1500931\nCell-Cell communication\nIEA\nDrosophila melanogaster\n\n\n1\nA0A023GPK8\nR-DME-373753\nNephrin family interactions\nIEA\nDrosophila melanogaster\n\n\n2\nA0A023GRW3\nR-DME-72163\nmRNA Splicing - Major Pathway\nIEA\nDrosophila melanogaster\n\n\n3\nA0A023GRW3\nR-DME-72172\nmRNA Splicing\nIEA\nDrosophila melanogaster\n\n\n4\nA0A023GRW3\nR-DME-72203\nProcessing of Capped Intron-Containing Pre-mRNA\nIEA\nDrosophila melanogaster\n\n\n\n\n\n\n\n\n\nquery_reactome\n\ndef query_reactome(\n    uniprot_id\n):\n\nQuery uniprot ID in Reactome all level pathway database.\n\nuniprot='P31751' # AKT2\nakt_path = query_reactome(uniprot) # AKT2\n\n\nakt_path\n\n\n\n\n\n\n\n\nreactome_id\nuniprot\npathway\ntype\nspecies\nlowest\n\n\n\n\n0\nR-HSA-109581\nP31751\nApoptosis\nIEA\nHomo sapiens\n0\n\n\n1\nR-HSA-109606\nP31751\nIntrinsic Pathway for Apoptosis\nIEA\nHomo sapiens\n0\n\n\n2\nR-HSA-109703\nP31751\nPKB-mediated events\nIEA\nHomo sapiens\n0\n\n\n3\nR-HSA-109704\nP31751\nPI3K Cascade\nIEA, TAS\nHomo sapiens\n0\n\n\n4\nR-HSA-111447\nP31751\nActivation of BAD and translocation to mitocho...\nIEA\nHomo sapiens\n1\n\n\n...\n...\n...\n...\n...\n...\n...\n\n\n93\nR-HSA-9755511\nP31751\nKEAP1-NFE2L2 pathway\nTAS\nHomo sapiens\n1\n\n\n94\nR-HSA-9755779\nP31751\nSARS-CoV-2 targets host intracellular signalli...\nTAS\nHomo sapiens\n1\n\n\n95\nR-HSA-9824446\nP31751\nViral Infection Pathways\nTAS\nHomo sapiens\n0\n\n\n96\nR-HSA-9824585\nP31751\nRegulation of MITF-M-dependent genes involved ...\nIEA\nHomo sapiens\n1\n\n\n97\nR-HSA-9856651\nP31751\nMITF-M-dependent gene expression\nIEA\nHomo sapiens\n0\n\n\n\n\n98 rows × 6 columns\n\n\n\n\n# lowest\nakt_path[akt_path.lowest==1].shape\n\n(32, 6)\n\n\n\n\n\nadd_reactome_ref\n\ndef add_reactome_ref(\n    df, uniprot\n):\n\n\nout = add_reactome_ref(path,uniprot)\nout.shape\n\n(406, 6)",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#bar-plot-of-pathways",
    "href": "pathway.html#bar-plot-of-pathways",
    "title": "Pathway analysis",
    "section": "Bar plot of pathways",
    "text": "Bar plot of pathways\n\n\nplot_path\n\ndef plot_path(\n    react_df, # the output df of get_reactome\n    p_type:str='FDR', ref_id_list:NoneType=None, # list of reactome_id\n    ref_col:NoneType=None, # column in reac_df, 1 or 0 to indicate whether it's in ref\n    top_n:int=10, max_label_length:int=80\n):\n\nPlot the output of get_reactome. If ref_df is provided, bars corresponding to pathways in ref_df are shown in dark red.\n\nplot_path(out)\nplt.title('PI3K Pathways');\n\n\n\n\n\n\n\n\n\n# All level\nplot_path(out,p_type='FDR',ref_id_list=akt_path.reactome_id,top_n=15)\nplt.title('PI3K Pathways (with highlight as overlap with all level Reactome database)');\n\n\n\n\n\n\n\n\n\nout.head()\n\n\n\n\n\n\n\n\nname\nreactome_id\nFDR\n-log10_FDR\nref_path\nref_path_lowest\n\n\n\n\n0\nGRB2 events in ERBB2 signaling\nR-HSA-1963640\n1.221245e-15\n14.913\n0\n0\n\n\n1\nSignaling by ERBB2 ECD mutants\nR-HSA-9665348\n1.221245e-15\n14.913\n0\n0\n\n\n2\nSignaling by ERBB2 KD Mutants\nR-HSA-9664565\n1.221245e-15\n14.913\n0\n0\n\n\n3\nSignaling by ERBB2 in Cancer\nR-HSA-1227990\n1.221245e-15\n14.913\n0\n0\n\n\n4\nSignaling by ERBB2 TMD/JMD mutants\nR-HSA-9665686\n1.221245e-15\n14.913\n0\n0\n\n\n\n\n\n\n\n\n# All level, use ref_col\nplot_path(out,p_type='FDR',ref_col='ref_path',top_n=15)\nplt.title('PI3K Pathways (with highlight as overlap with all level Reactome database)');\n\n\n\n\n\n\n\n\n\n# All level\nplot_path(out,p_type='FDR',ref_col='ref_path_lowest',top_n=15)\nplt.title('PI3K Pathways (with highlight as overlap with lowest level Reactome database)');",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#overlap",
    "href": "pathway.html#overlap",
    "title": "Pathway analysis",
    "section": "Overlap",
    "text": "Overlap\n\n\nget_overlap\n\ndef get_overlap(\n    react_df, ref_id_list:NoneType=None,\n    ref_col:NoneType=None, # column in react_df, 1 or 0 to indicate whether it's in ref\n    p_type:str='FDR', thr:float=0.05, # original threshold of p value, will be log10 transformed\n    plot:bool=True, figsize:tuple=(5, 3), kwargs:VAR_KEYWORD\n):\n\n\nget_overlap(out, ref_id_list=akt_path.reactome_id,plot=True)\n\n0.9081632653061225\n\n\n\n\n\n\n\n\n\n\nget_overlap(out, ref_col='ref_path')\n\n0.9081632653061225\n\n\n\n\n\n\n\n\n\n\nget_overlap(out, ref_col='ref_path_lowest')\n\n0.96875",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pathway.html#pipeline",
    "href": "pathway.html#pipeline",
    "title": "Pathway analysis",
    "section": "Pipeline",
    "text": "Pipeline\nout = get_reactome(pi3ks,p_type='FDR')\nout = add_reactome_ref(out,'P31749') # kinase uniprot\naccuracy = get_overlap(out, ref_col='ref_path',plot=True) # if lowest, change all to lo",
    "crumbs": [
      "Modules",
      "Pathway analysis"
    ]
  },
  {
    "objectID": "pssm_plot.html",
    "href": "pssm_plot.html",
    "title": "pssm.plot",
    "section": "",
    "text": "String Conversion Utilities\nTo convert between lowercase phosphorylation notation (s/t/y) and formal notation (pS/pT/pY):\npSTY2sty(string='pS-peptide-pT')  # converts pS/pT/pY → s/t/y\nsty2pSTY(string='s-peptide-t')    # converts s/t/y → pS/pT/pY\nsty2pSTY_df(df=pssm_df)           # applies sty→pSTY to dataframe index\n\nSimple Heatmaps\nTo plot a basic black-and-white heatmap of PSSM values:\nplot_heatmap_simple(\n    matrix=pssm_df,      # a matrix of values (positions × amino acids)\n    title='kinase',      # title displayed above heatmap\n    figsize=(10, 7),     # (width, height) of figure\n    cmap='binary',       # colormap, default is black & white\n)\n\nFormal Heatmaps\nTo plot a publication-ready heatmap with diverging colors centered at zero:\nplot_heatmap(\n    heatmap_df=pssm_df,       # PSSM dataframe (positions × amino acids)\n    ax=None,                  # optional matplotlib axes\n    position_label=True,      # show position numbers on x-axis\n    figsize=(20, 6),          # (width, height) of figure\n    include_zero=True,        # whether to show position 0\n    scale_pos_neg=False,      # use TwoSlopeNorm for balanced pos/neg scaling\n    colorbar_title='Prob.',   # title for the colorbar\n)\n\nComparative Heatmaps\nTo plot two heatmaps side-by-side for comparing kinase motifs:\nplot_two_heatmaps(\n    pssm1=pssm_df1,           # first PSSM dataframe\n    pssm2=pssm_df2,           # second PSSM dataframe\n    kinase_name='AKT',        # shared title above both plots\n    title1='CDDM',            # title for left heatmap\n    title2='PSPA',            # title for right heatmap\n    figsize=(4, 4.5),         # (width, height) of figure\n    cbar=True,                # show colorbars below each heatmap\n    scale_01=False,           # force color scale to [0, 1] range\n)\n\nLogo Motifs\nTo plot a raw sequence logo from a PSSM:\nplot_logo_raw(\n    pssm_df=pssm_df,      # PSSM dataframe (positions × amino acids)\n    ax=None,              # optional matplotlib axes\n    title='Motif',        # title above the logo\n    ytitle='Bits',        # y-axis label\n    figsize=(10, 2),      # (width, height) of figure\n)\nTo plot an information-content-scaled logo (recommended):\nplot_logo(\n    pssm_df=pssm_df,      # frequency PSSM dataframe\n    title='Motif',        # title above the logo\n    scale_zero=True,      # scale position 0 to match neighbor heights\n    ax=None,              # optional matplotlib axes\n    figsize=(10, 1),      # (width, height) of figure\n)\n\nMultiple Logos\nTo plot logos for specific kinases by index:\nplot_logos_idx(\n    pssms_df=pssms,       # dataframe with flattened PSSMs (kinases as rows)\n    'AKT1', 'AKT2',       # kinase IDs to plot (as positional args)\n    figsize=(14, 1),      # (width, height) per logo\n)\nTo plot multiple logos as subplots in one figure:\nplot_logos(\n    pssms_df=pssms.head(2),   # dataframe with flattened PSSMs\n    count_dict=None,          # optional dict mapping idx → count for titles\n    path=None,                # optional save path\n    prefix='Motif',           # prefix for subplot titles\n    figsize=(14, 1),          # (width, height) per logo\n)\n\nCombined Logo + Heatmap\nTo plot a logo motif above its corresponding heatmap:\nplot_logo_heatmap(\n    pssm_df=pssm_df,      # PSSM dataframe (positions × amino acids)\n    title='Kinase',       # title above the logo\n    figsize=(17, 10),     # (width, height) of combined figure\n    include_zero=False,   # whether to include position 0 in heatmap\n)",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#overview",
    "href": "pssm_plot.html#overview",
    "title": "pssm.plot",
    "section": "",
    "text": "String Conversion Utilities\nTo convert between lowercase phosphorylation notation (s/t/y) and formal notation (pS/pT/pY):\npSTY2sty(string='pS-peptide-pT')  # converts pS/pT/pY → s/t/y\nsty2pSTY(string='s-peptide-t')    # converts s/t/y → pS/pT/pY\nsty2pSTY_df(df=pssm_df)           # applies sty→pSTY to dataframe index\n\nSimple Heatmaps\nTo plot a basic black-and-white heatmap of PSSM values:\nplot_heatmap_simple(\n    matrix=pssm_df,      # a matrix of values (positions × amino acids)\n    title='kinase',      # title displayed above heatmap\n    figsize=(10, 7),     # (width, height) of figure\n    cmap='binary',       # colormap, default is black & white\n)\n\nFormal Heatmaps\nTo plot a publication-ready heatmap with diverging colors centered at zero:\nplot_heatmap(\n    heatmap_df=pssm_df,       # PSSM dataframe (positions × amino acids)\n    ax=None,                  # optional matplotlib axes\n    position_label=True,      # show position numbers on x-axis\n    figsize=(20, 6),          # (width, height) of figure\n    include_zero=True,        # whether to show position 0\n    scale_pos_neg=False,      # use TwoSlopeNorm for balanced pos/neg scaling\n    colorbar_title='Prob.',   # title for the colorbar\n)\n\nComparative Heatmaps\nTo plot two heatmaps side-by-side for comparing kinase motifs:\nplot_two_heatmaps(\n    pssm1=pssm_df1,           # first PSSM dataframe\n    pssm2=pssm_df2,           # second PSSM dataframe\n    kinase_name='AKT',        # shared title above both plots\n    title1='CDDM',            # title for left heatmap\n    title2='PSPA',            # title for right heatmap\n    figsize=(4, 4.5),         # (width, height) of figure\n    cbar=True,                # show colorbars below each heatmap\n    scale_01=False,           # force color scale to [0, 1] range\n)\n\nLogo Motifs\nTo plot a raw sequence logo from a PSSM:\nplot_logo_raw(\n    pssm_df=pssm_df,      # PSSM dataframe (positions × amino acids)\n    ax=None,              # optional matplotlib axes\n    title='Motif',        # title above the logo\n    ytitle='Bits',        # y-axis label\n    figsize=(10, 2),      # (width, height) of figure\n)\nTo plot an information-content-scaled logo (recommended):\nplot_logo(\n    pssm_df=pssm_df,      # frequency PSSM dataframe\n    title='Motif',        # title above the logo\n    scale_zero=True,      # scale position 0 to match neighbor heights\n    ax=None,              # optional matplotlib axes\n    figsize=(10, 1),      # (width, height) of figure\n)\n\nMultiple Logos\nTo plot logos for specific kinases by index:\nplot_logos_idx(\n    pssms_df=pssms,       # dataframe with flattened PSSMs (kinases as rows)\n    'AKT1', 'AKT2',       # kinase IDs to plot (as positional args)\n    figsize=(14, 1),      # (width, height) per logo\n)\nTo plot multiple logos as subplots in one figure:\nplot_logos(\n    pssms_df=pssms.head(2),   # dataframe with flattened PSSMs\n    count_dict=None,          # optional dict mapping idx → count for titles\n    path=None,                # optional save path\n    prefix='Motif',           # prefix for subplot titles\n    figsize=(14, 1),          # (width, height) per logo\n)\n\nCombined Logo + Heatmap\nTo plot a logo motif above its corresponding heatmap:\nplot_logo_heatmap(\n    pssm_df=pssm_df,      # PSSM dataframe (positions × amino acids)\n    title='Kinase',       # title above the logo\n    figsize=(17, 10),     # (width, height) of combined figure\n    include_zero=False,   # whether to include position 0 in heatmap\n)",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#setup",
    "href": "pssm_plot.html#setup",
    "title": "pssm.plot",
    "section": "Setup",
    "text": "Setup\n\n# Load data for testing\nfrom katlas.data import *\nfrom katlas.utils import *\nfrom katlas.pssm.core import *\n\n\ndf=Data.get_cddm()\npssm_df = recover_pssm(df.loc['AKT1'])",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#heatmap",
    "href": "pssm_plot.html#heatmap",
    "title": "pssm.plot",
    "section": "Heatmap",
    "text": "Heatmap\n\nBlack-white simple\n\n\n\nplot_heatmap_simple\n\ndef plot_heatmap_simple(\n    matrix, # a matrix of values\n    title:str='heatmap', # title of the heatmap\n    figsize:tuple=(6, 7), # (width, height)\n    cmap:str='binary', # color map, default is dark&white\n    vmin:NoneType=None, vmax:NoneType=None, center:NoneType=None, robust:bool=False, annot:NoneType=None,\n    fmt:str='.2g', annot_kws:NoneType=None, linewidths:int=0, linecolor:str='white', cbar:bool=True,\n    cbar_kws:NoneType=None, cbar_ax:NoneType=None, square:bool=False, xticklabels:str='auto', yticklabels:str='auto',\n    mask:NoneType=None, ax:NoneType=None\n):\n\nPlot heatmap based on a matrix of values\n\nplot_heatmap_simple(pssm_df,'kinase',figsize=(10,7))\n\n\n\n\n\n\n\n\n\n\nFormal\nIt will convert s,t,y to pS,pT,pY in the heatmap.\n\n\n\npSTY2sty\n\ndef pSTY2sty(\n    string\n):\n\nConvert pS/pT/pY to s/t/y in a string.\n\n\n\nsty2pSTY\n\ndef sty2pSTY(\n    string\n):\n\nConvert s/t/y to pS/pT/pY in a string.\n\n\n\nsty2pSTY_df\n\ndef sty2pSTY_df(\n    df\n):\n\nApplies sty→pSTY to dataframe index\n\n\n\nplot_heatmap\n\ndef plot_heatmap(\n    heatmap_df, ax:NoneType=None, position_label:bool=True, figsize:tuple=(5, 6), include_zero:bool=True,\n    scale_pos_neg:bool=False, colorbar_title:str='Prob.', vmin:NoneType=None, vmax:NoneType=None, cmap:NoneType=None,\n    center:NoneType=None, robust:bool=False, annot:NoneType=None, fmt:str='.2g', annot_kws:NoneType=None,\n    linewidths:int=0, linecolor:str='white', cbar:bool=True, cbar_kws:NoneType=None, cbar_ax:NoneType=None,\n    square:bool=False, xticklabels:str='auto', yticklabels:str='auto', mask:NoneType=None\n):\n\nPlot a heatmap of pssm.\nThis function visualizes a PSSM or log-odds matrix as a heatmap with diverging color scales centered at 0.\nColor scale behavior:\n\nBy default (scale_pos_neg=False), the colormap is centered at 0, but the full data range determines the color intensity:\n\\[\n\\text{color range} = [\\min(\\text{data}), \\max(\\text{data})], \\quad \\text{with center at } 0\n\\]\nThis is useful when you want to emphasize whether values are above or below zero, but without enforcing symmetry.\nIf scale_pos_neg=True, the function uses a balanced diverging scale via TwoSlopeNorm, such that:\n\\[\n\\text{min color} = \\min(\\text{data}), \\quad\n\\text{center} = 0, \\quad\n\\text{max color} = \\max(\\text{data})\n\\]\nThe positive and negative ranges are scaled separately, ensuring that both ends of the heatmap have equal visual weight — especially helpful for symmetric data like log-odds matrices.\n\nAdditional visual features: - The center position (\\(i = 0\\)) can be masked out using include_zero=False.\n\nplot_heatmap(pssm_df-0.3,scale_pos_neg=False,figsize=(20, 6));\n\n\n\n\n\n\n\n\n\nplot_heatmap(pssm_df-0.3,scale_pos_neg=True,figsize=(20, 6));\n\n\n\n\n\n\n\n\n\nplt.close('all')\n\n\n\nTwo heatmaps comparison\n\n\n\nplot_two_heatmaps\n\ndef plot_two_heatmaps(\n    pssm1, pssm2, kinase_name:str='Kinase', title1:str='CDDM', title2:str='PSPA', figsize:tuple=(4, 4.5),\n    cbar:bool=True, scale_01:bool=False, cbar_fontsize:int=10, kwargs:VAR_KEYWORD\n):\n\nPlot two side-by-side heatmaps with black rectangle borders, titles on top, shared kinase label below, and only left plot showing y-axis labels.\n\npssm_df2 = pssm_df.loc[:,-5:5]\n\n\nplot_two_heatmaps(pssm_df2,pssm_df2,'AKT','AKT1','AKT2')",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#logo-motif",
    "href": "pssm_plot.html#logo-motif",
    "title": "pssm.plot",
    "section": "Logo motif",
    "text": "Logo motif\nTo distinguish sty from STY, sty (lowercase) in the input df are automatically converted to pS,pT,pY in logo motif.\n\n\nplot_logo_raw\n\ndef plot_logo_raw(\n    pssm_df, ax:NoneType=None, title:str='Motif', ytitle:str='Bits', figsize:tuple=(10, 2)\n):\n\nPlot logo motif using Logomaker.\n\nplot_logo_raw(pssm_df)\n\n\n\n\n\n\n\n\nWe can find the center name is in lower case, so need to change them\n\n\n\nchange_center_name\n\ndef change_center_name(\n    df\n):\n\nTransfer the middle s,t,y to S,T,Y for plot if s,t,y have values; otherwise keep the original.\nNow instead of s,t,y, the center name becomes S, T and Y:\n\nchange_center_name(pssm_df)[0]\n\naa\nP    0.000000\nG    0.000000\nA    0.000000\nC    0.000000\nS    0.744152\nT    0.248538\nV    0.000000\nI    0.000000\nL    0.000000\nM    0.000000\nF    0.000000\nY    0.007310\nW    0.000000\nH    0.000000\nK    0.000000\nR    0.000000\nQ    0.000000\nN    0.000000\nD    0.000000\nE    0.000000\ns    0.000000\nt    0.000000\ny    0.000000\nName: 0, dtype: float64\n\n\n\n\n\nget_pos_min_max\n\ndef get_pos_min_max(\n    pssm_df\n):\n\nGet min and max value of sum of positive and negative values across each position.\n\n\n\nscale_zero_position\n\ndef scale_zero_position(\n    pssm_df\n):\n\nScale position 0 so that: - Positive values match the max positive column sum of other positions - Negative values match the min (most negative) column sum of other positions\nThis function rescales position 0 in a log-odds PSSM so that its total positive and negative stack heights match those of the most extreme positions on either side.\nThis ensures the central position visually matches the dynamic range of surrounding positions in log-odds logo plots.\n\n\n\nscale_pos_neg_values\n\ndef scale_pos_neg_values(\n    pssm_df\n):\n\nGlobally scale all positive values by max positive column sum, and negative values by min negative column sum (preserving sign).\n\n\n\nconvert_logo_df\n\ndef convert_logo_df(\n    pssm_df, scale_zero:bool=True, scale_pos_neg:bool=False\n):\n\nChange center name from s,t,y to S, T, Y in a pssm and scaled zero position to the max of neigbors.\n\n\n\nget_logo_IC\n\ndef get_logo_IC(\n    pssm_df\n):\n\nFor plotting purpose, calculate the scaled information content (bits) from a frequency matrix, using log2(3) for the middle position and log2(len(pssm_df)) for others.\nTo visualize the motif using Logomaker, the scaled PSSM is computed by weighting each amino acid’s frequency at position \\(i\\) by the position’s information content:\n\\[\n\\text{PSSM\\_scaled}_i(x) = P_i(x) \\cdot \\mathrm{IC}_i\n\\]\nThis results in a matrix where the total stack height at each position equals the information content, and each letter’s height is proportional to its contribution. This is the standard format used by Logomaker to generate sequence logos.\n\nget_logo_IC(pssm_df)\n\n\n\n\n\n\n\nPosition\n-20\n-19\n-18\n-17\n-16\n-15\n-14\n-13\n-12\n-11\n...\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.019253\n0.011378\n0.016632\n0.014723\n0.027341\n0.017469\n0.018061\n0.020054\n0.018999\n0.021432\n...\n0.022264\n0.016570\n0.017585\n0.025658\n0.024024\n0.024794\n0.016453\n0.018620\n0.011564\n0.017775\n\n\nG\n0.020457\n0.011642\n0.018254\n0.019222\n0.033016\n0.012927\n0.018462\n0.023318\n0.019358\n0.020458\n...\n0.023748\n0.019803\n0.018025\n0.017396\n0.018739\n0.023716\n0.020762\n0.014741\n0.014455\n0.016590\n\n\nA\n0.023666\n0.015347\n0.015820\n0.018404\n0.025278\n0.020613\n0.022074\n0.022852\n0.021867\n0.025329\n...\n0.023748\n0.018186\n0.018904\n0.027833\n0.024505\n0.019943\n0.017237\n0.011637\n0.016383\n0.018170\n\n\nC\n0.003209\n0.003704\n0.004462\n0.003272\n0.006191\n0.004891\n0.008428\n0.000933\n0.002151\n0.003897\n...\n0.003463\n0.005658\n0.002198\n0.004349\n0.003844\n0.003234\n0.001959\n0.003879\n0.003212\n0.003160\n\n\nS\n0.016044\n0.007144\n0.014198\n0.012678\n0.019087\n0.009782\n0.008830\n0.018188\n0.012188\n0.020945\n...\n0.013853\n0.016570\n0.011431\n0.013916\n0.015376\n0.017248\n0.012928\n0.014741\n0.014134\n0.013430\n\n\nT\n0.009627\n0.005292\n0.007707\n0.016359\n0.008254\n0.010830\n0.008428\n0.010726\n0.007170\n0.008281\n...\n0.009400\n0.008083\n0.007474\n0.010437\n0.012012\n0.015092\n0.014495\n0.009698\n0.005782\n0.013035\n\n\nV\n0.015242\n0.008467\n0.015415\n0.021267\n0.020635\n0.013276\n0.014850\n0.012592\n0.011471\n0.007793\n...\n0.014843\n0.020611\n0.013189\n0.021744\n0.018258\n0.022099\n0.012536\n0.014353\n0.013170\n0.008690\n\n\nI\n0.015643\n0.007144\n0.013792\n0.013496\n0.011865\n0.008734\n0.010034\n0.010260\n0.011113\n0.009742\n...\n0.009400\n0.011720\n0.011431\n0.006958\n0.011532\n0.011858\n0.011752\n0.013189\n0.009637\n0.010665\n\n\nL\n0.016044\n0.012171\n0.021905\n0.022494\n0.022183\n0.018517\n0.020067\n0.026116\n0.016848\n0.023867\n...\n0.022759\n0.016166\n0.025059\n0.020875\n0.030751\n0.026950\n0.021546\n0.021335\n0.015098\n0.022910\n\n\nM\n0.003209\n0.006086\n0.007707\n0.002863\n0.005159\n0.005590\n0.002809\n0.005130\n0.003226\n0.007306\n...\n0.003463\n0.002425\n0.006155\n0.005654\n0.004324\n0.003773\n0.005876\n0.003491\n0.004818\n0.004345\n\n\nF\n0.004412\n0.008202\n0.005679\n0.008589\n0.008254\n0.007686\n0.007224\n0.007462\n0.008962\n0.005845\n...\n0.010885\n0.009295\n0.008793\n0.007393\n0.009610\n0.007546\n0.003526\n0.006594\n0.005140\n0.007505\n\n\nY\n0.003209\n0.001852\n0.002840\n0.003272\n0.007222\n0.002795\n0.004013\n0.003265\n0.003943\n0.004871\n...\n0.004453\n0.003637\n0.003517\n0.003479\n0.003844\n0.003773\n0.005484\n0.004267\n0.002570\n0.005135\n\n\nW\n0.004813\n0.002646\n0.001217\n0.002863\n0.002064\n0.002446\n0.002408\n0.004664\n0.002151\n0.002435\n...\n0.001484\n0.002021\n0.002198\n0.005219\n0.003363\n0.000539\n0.002742\n0.002327\n0.006425\n0.002765\n\n\nH\n0.003610\n0.003175\n0.005679\n0.006544\n0.007738\n0.004542\n0.004816\n0.006529\n0.008245\n0.005358\n...\n0.003958\n0.005254\n0.009672\n0.006958\n0.005285\n0.007007\n0.004701\n0.003491\n0.004176\n0.006320\n\n\nK\n0.015643\n0.009261\n0.018660\n0.010633\n0.027857\n0.016420\n0.014449\n0.017255\n0.014339\n0.025816\n...\n0.021769\n0.015762\n0.027257\n0.024354\n0.017778\n0.033418\n0.021546\n0.020947\n0.012849\n0.013825\n\n\nR\n0.016446\n0.011642\n0.022311\n0.024539\n0.030953\n0.014324\n0.016857\n0.021453\n0.016490\n0.018996\n...\n0.035127\n0.018186\n0.027257\n0.016961\n0.025946\n0.030184\n0.016453\n0.013577\n0.012207\n0.013035\n\n\nQ\n0.012033\n0.008996\n0.015415\n0.009815\n0.008770\n0.010132\n0.017258\n0.012592\n0.010754\n0.018022\n...\n0.029685\n0.011720\n0.010551\n0.007828\n0.012493\n0.016709\n0.010969\n0.013965\n0.007709\n0.008295\n\n\nN\n0.008423\n0.005557\n0.012575\n0.012269\n0.013929\n0.009782\n0.008027\n0.013991\n0.010396\n0.013151\n...\n0.009895\n0.016974\n0.007474\n0.009133\n0.006727\n0.009702\n0.008227\n0.007370\n0.008673\n0.011060\n\n\nD\n0.017649\n0.008996\n0.010547\n0.013496\n0.019087\n0.013276\n0.016054\n0.020986\n0.013622\n0.025329\n...\n0.016327\n0.010508\n0.018465\n0.013916\n0.021622\n0.026950\n0.011361\n0.012025\n0.009958\n0.015405\n\n\nE\n0.020858\n0.010848\n0.021905\n0.020858\n0.025794\n0.016770\n0.028897\n0.033578\n0.013622\n0.039941\n...\n0.024738\n0.023036\n0.021103\n0.020440\n0.026907\n0.026411\n0.018020\n0.019395\n0.014776\n0.020145\n\n\ns\n0.008022\n0.009790\n0.011764\n0.009407\n0.010318\n0.008036\n0.009231\n0.014924\n0.008245\n0.012177\n...\n0.012864\n0.009295\n0.012310\n0.008698\n0.008168\n0.011858\n0.009010\n0.015904\n0.010922\n0.017380\n\n\nt\n0.004412\n0.004234\n0.004057\n0.003681\n0.003095\n0.004192\n0.005218\n0.003731\n0.004302\n0.003897\n...\n0.004948\n0.002425\n0.007034\n0.002609\n0.005766\n0.005390\n0.003526\n0.003491\n0.001927\n0.001975\n\n\ny\n0.003209\n0.001852\n0.000811\n0.001636\n0.000000\n0.000699\n0.002007\n0.001865\n0.001792\n0.003897\n...\n0.004453\n0.002021\n0.001319\n0.003044\n0.001441\n0.001617\n0.003134\n0.002327\n0.001927\n0.001185\n\n\n\n\n23 rows × 41 columns\n\n\n\n\n\n\nplot_logo\n\ndef plot_logo(\n    pssm_df, title:str='Motif', scale_zero:bool=True, ax:NoneType=None, figsize:tuple=(10, 1)\n):\n\nPlot logo of information content given a frequency PSSM.\n\n# plot_logo(pssm_df,scale_zero=False,figsize=(10,1))\n\nSet scale_zero to default True can have better vision of the side amino acids\n\nplot_logo(pssm_df,title='Motif',figsize=(10,1))\n\n\n\n\n\n\n\n\n\nplt.close('all')",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#multiple-logos",
    "href": "pssm_plot.html#multiple-logos",
    "title": "pssm.plot",
    "section": "Multiple logos",
    "text": "Multiple logos\nAs multiple figures:\n\n\nplot_logos_idx\n\ndef plot_logos_idx(\n    pssms_df, idxs:VAR_POSITIONAL, figsize:tuple=(14, 1)\n):\n\nPlot logos of a dataframe with flattened PSSMs with index ad IDs.\n\npssms=Data.get_cddm()\n\n\nplot_logos_idx(pssms,'AKT1','AKT2')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIn one figure:\n\n\n\nplot_logos\n\ndef plot_logos(\n    pssms_df, count_dict:NoneType=None, # used to display n in motif title\n    prefix:str='Motif', figsize:tuple=(14, 1)\n):\n\nPlot all logos from a dataframe of flattened PSSMs as subplots in a single figure.\n\nplot_logos(pssms.head(2),prefix=None)\n\n\n\n\n\n\n\n\n\nplt.close('all')",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "pssm_plot.html#logo-motif-heatmap",
    "href": "pssm_plot.html#logo-motif-heatmap",
    "title": "pssm.plot",
    "section": "Logo motif + Heatmap",
    "text": "Logo motif + Heatmap\n\n\nplot_logo_heatmap\n\ndef plot_logo_heatmap(\n    pssm_df, # column is position, index is aa\n    title:str='Motif', figsize:tuple=(17, 10), include_zero:bool=False\n):\n\nPlot logo and heatmap vertically\n\nplot_logo_heatmap(pssm_df,title='Kinase',figsize=(17,10))",
    "crumbs": [
      "Modules",
      "pssm.plot"
    ]
  },
  {
    "objectID": "dnn.html",
    "href": "dnn.html",
    "title": "Train DL",
    "section": "",
    "text": "Utilities\nseed_everything(seed=123) — Sets random seeds across Python, NumPy, and PyTorch for reproducibility. Ensures deterministic behavior on CUDA.\nseed_everything(\n    seed=42,  # random seed for reproducibility\n)\ninit_weights(m, leaky=0.) — Applies Kaiming initialization to Conv layers. Pass to model.apply() for weight initialization.\nmodel = CNN1D(ni=1024, nf=230).apply(\n    init_weights,  # initializes Conv layers with Kaiming normal\n)\n\nLayer Builders\nlin_wn(ni, nf, dp=0.1, act=nn.SiLU) — Creates a weight-normalized linear layer with BatchNorm, Dropout, and activation.\nlayer = lin_wn(\n    ni=1024,       # input features\n    nf=512,        # output features  \n    dp=0.1,        # dropout probability\n    act=nn.SiLU,   # activation function (None to disable)\n)\nconv_wn(ni, nf, ks=3, stride=1, padding=1, dp=0.1, act=nn.ReLU) — Creates a weight-normalized 1D convolution with BatchNorm, Dropout, and activation.\nlayer = conv_wn(\n    ni=256,        # input channels\n    nf=512,        # output channels\n    ks=5,          # kernel size\n    stride=1,      # stride\n    padding=2,     # padding\n    dp=0.1,        # dropout probability\n    act=nn.ReLU,   # activation function\n)\n\nModels\nMLP(num_features, num_targets, hidden_units=[512, 218], dp=0.2) — Builds a multi-layer perceptron with BatchNorm and PReLU activations.\nmodel = MLP(\n    num_features=1024,          # input dimension (e.g., T5 embeddings)\n    num_targets=230,            # output dimension (23 AA × 10 positions)\n    hidden_units=[512, 256],    # list of hidden layer sizes\n    dp=0.2,                     # dropout rate (currently commented out)\n)\nCNN1D(ni, nf, amp_scale=16) — 1D CNN that amplifies input features, applies convolutions with skip connections, then projects to output.\nmodel = CNN1D(\n    ni=1024,        # input features\n    nf=230,         # output features (flattened PSSM)\n    amp_scale=16,   # amplification factor for feature expansion\n).apply(init_weights)\nPSSM_model(n_features, n_targets, model='MLP') — Wrapper that reshapes flat output to (batch, 23, positions) PSSM format with softmax-ready logits.\nmodel = PSSM_model(\n    n_features=1024,   # input feature dimension\n    n_targets=230,     # total targets (must be divisible by 23)\n    model='CNN',       # 'MLP' or 'CNN' architecture\n)\n# Output shape: (batch, 23, 10) for 10 positions\n\nDataset\nGeneralDataset(df, feat_col, target_col=None, A=23, dtype=np.float32) — PyTorch Dataset that extracts features and reshapes targets to (23, L) PSSM matrices.\nds = GeneralDataset(\n    df=train_df,           # DataFrame with features and targets\n    feat_col=feat_col,     # Index/list of feature column names\n    target_col=target_col, # Index/list of target columns (None for test mode)\n    A=23,                  # number of amino acids (including pS, pT, pY)\n    dtype=np.float32,      # data type for tensors\n)\n# Returns (X, y) where y.shape = (23, L)\n\nLoss Function\nCE(logits, target_probs) — Cross-entropy loss with soft labels. Applies log_softmax to logits and computes against target probability distributions.\nloss = CE(\n    logits=model_output,      # (B, 23, 10) raw logits\n    target_probs=target_pssm, # (B, 23, 10) target probabilities (sum to 1 per position)\n)\n\nMetrics\nKLD(logits, target_probs) — Kullback-Leibler divergence between target distribution (p) and predicted softmax distribution (q).\nkl_div = KLD(\n    logits=model_output,      # (B, 23, 10) raw logits\n    target_probs=target_pssm, # (B, 23, 10) target probabilities\n)\nJSD(logits, target_probs) — Jensen-Shannon divergence (symmetric metric) between target and predicted distributions.\njs_div = JSD(\n    logits=model_output,      # (B, 23, 10) raw logits  \n    target_probs=target_pssm, # (B, 23, 10) target probabilities\n)\n\nTraining\ntrain_dl(df, feat_col, target_col, split, model_func, ...) — Trains a model on a single train/valid split using fastai’s Learner with one-cycle policy.\ntarget, pred = train_dl(\n    df=df,                     # full DataFrame\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # target column names\n    split=split0,              # (train_idx, valid_idx) tuple\n    model_func=get_cnn,        # callable returning fresh model\n    n_epoch=10,                # number of training epochs\n    bs=32,                     # batch size\n    lr=3e-3,                   # learning rate\n    loss=CE,                   # loss function\n    save='my_model',           # save to models/my_model.pth\n    sampler=None,              # optional custom sampler\n    lr_find=True,              # run lr_find before training\n)\n# Returns (target_df, pred_df) for validation set\ntrain_dl_cv(df, feat_col, target_col, splits, model_func, save=None, **kwargs) — Cross-validation wrapper that trains across multiple folds and concatenates OOF predictions.\noof = train_dl_cv(\n    df=df,                     # full DataFrame\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # target column names\n    splits=splits,             # list of (train_idx, valid_idx) tuples\n    model_func=get_cnn,        # callable returning fresh model\n    save='cnn',                # saves as cnn_fold0.pth, cnn_fold1.pth, ...\n    n_epoch=10,                # passed to train_dl\n    lr=3e-3,                   # passed to train_dl\n)\n# Returns DataFrame with all OOF predictions + 'nfold' column\n\nPrediction\npredict_dl(df, feat_col, target_col, model_func, model_pth) — Loads a saved model and generates predictions for a DataFrame.\npreds = predict_dl(\n    df=test_df,                # DataFrame to predict\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # used for output column names\n    model_func=get_cnn,        # must match saved architecture\n    model_pth='cnn_fold0',     # model name (without .pth)\n)\n# Returns DataFrame with softmax probabilities, same shape as target_col",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#overview",
    "href": "dnn.html#overview",
    "title": "Train DL",
    "section": "",
    "text": "Utilities\nseed_everything(seed=123) — Sets random seeds across Python, NumPy, and PyTorch for reproducibility. Ensures deterministic behavior on CUDA.\nseed_everything(\n    seed=42,  # random seed for reproducibility\n)\ninit_weights(m, leaky=0.) — Applies Kaiming initialization to Conv layers. Pass to model.apply() for weight initialization.\nmodel = CNN1D(ni=1024, nf=230).apply(\n    init_weights,  # initializes Conv layers with Kaiming normal\n)\n\nLayer Builders\nlin_wn(ni, nf, dp=0.1, act=nn.SiLU) — Creates a weight-normalized linear layer with BatchNorm, Dropout, and activation.\nlayer = lin_wn(\n    ni=1024,       # input features\n    nf=512,        # output features  \n    dp=0.1,        # dropout probability\n    act=nn.SiLU,   # activation function (None to disable)\n)\nconv_wn(ni, nf, ks=3, stride=1, padding=1, dp=0.1, act=nn.ReLU) — Creates a weight-normalized 1D convolution with BatchNorm, Dropout, and activation.\nlayer = conv_wn(\n    ni=256,        # input channels\n    nf=512,        # output channels\n    ks=5,          # kernel size\n    stride=1,      # stride\n    padding=2,     # padding\n    dp=0.1,        # dropout probability\n    act=nn.ReLU,   # activation function\n)\n\nModels\nMLP(num_features, num_targets, hidden_units=[512, 218], dp=0.2) — Builds a multi-layer perceptron with BatchNorm and PReLU activations.\nmodel = MLP(\n    num_features=1024,          # input dimension (e.g., T5 embeddings)\n    num_targets=230,            # output dimension (23 AA × 10 positions)\n    hidden_units=[512, 256],    # list of hidden layer sizes\n    dp=0.2,                     # dropout rate (currently commented out)\n)\nCNN1D(ni, nf, amp_scale=16) — 1D CNN that amplifies input features, applies convolutions with skip connections, then projects to output.\nmodel = CNN1D(\n    ni=1024,        # input features\n    nf=230,         # output features (flattened PSSM)\n    amp_scale=16,   # amplification factor for feature expansion\n).apply(init_weights)\nPSSM_model(n_features, n_targets, model='MLP') — Wrapper that reshapes flat output to (batch, 23, positions) PSSM format with softmax-ready logits.\nmodel = PSSM_model(\n    n_features=1024,   # input feature dimension\n    n_targets=230,     # total targets (must be divisible by 23)\n    model='CNN',       # 'MLP' or 'CNN' architecture\n)\n# Output shape: (batch, 23, 10) for 10 positions\n\nDataset\nGeneralDataset(df, feat_col, target_col=None, A=23, dtype=np.float32) — PyTorch Dataset that extracts features and reshapes targets to (23, L) PSSM matrices.\nds = GeneralDataset(\n    df=train_df,           # DataFrame with features and targets\n    feat_col=feat_col,     # Index/list of feature column names\n    target_col=target_col, # Index/list of target columns (None for test mode)\n    A=23,                  # number of amino acids (including pS, pT, pY)\n    dtype=np.float32,      # data type for tensors\n)\n# Returns (X, y) where y.shape = (23, L)\n\nLoss Function\nCE(logits, target_probs) — Cross-entropy loss with soft labels. Applies log_softmax to logits and computes against target probability distributions.\nloss = CE(\n    logits=model_output,      # (B, 23, 10) raw logits\n    target_probs=target_pssm, # (B, 23, 10) target probabilities (sum to 1 per position)\n)\n\nMetrics\nKLD(logits, target_probs) — Kullback-Leibler divergence between target distribution (p) and predicted softmax distribution (q).\nkl_div = KLD(\n    logits=model_output,      # (B, 23, 10) raw logits\n    target_probs=target_pssm, # (B, 23, 10) target probabilities\n)\nJSD(logits, target_probs) — Jensen-Shannon divergence (symmetric metric) between target and predicted distributions.\njs_div = JSD(\n    logits=model_output,      # (B, 23, 10) raw logits  \n    target_probs=target_pssm, # (B, 23, 10) target probabilities\n)\n\nTraining\ntrain_dl(df, feat_col, target_col, split, model_func, ...) — Trains a model on a single train/valid split using fastai’s Learner with one-cycle policy.\ntarget, pred = train_dl(\n    df=df,                     # full DataFrame\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # target column names\n    split=split0,              # (train_idx, valid_idx) tuple\n    model_func=get_cnn,        # callable returning fresh model\n    n_epoch=10,                # number of training epochs\n    bs=32,                     # batch size\n    lr=3e-3,                   # learning rate\n    loss=CE,                   # loss function\n    save='my_model',           # save to models/my_model.pth\n    sampler=None,              # optional custom sampler\n    lr_find=True,              # run lr_find before training\n)\n# Returns (target_df, pred_df) for validation set\ntrain_dl_cv(df, feat_col, target_col, splits, model_func, save=None, **kwargs) — Cross-validation wrapper that trains across multiple folds and concatenates OOF predictions.\noof = train_dl_cv(\n    df=df,                     # full DataFrame\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # target column names\n    splits=splits,             # list of (train_idx, valid_idx) tuples\n    model_func=get_cnn,        # callable returning fresh model\n    save='cnn',                # saves as cnn_fold0.pth, cnn_fold1.pth, ...\n    n_epoch=10,                # passed to train_dl\n    lr=3e-3,                   # passed to train_dl\n)\n# Returns DataFrame with all OOF predictions + 'nfold' column\n\nPrediction\npredict_dl(df, feat_col, target_col, model_func, model_pth) — Loads a saved model and generates predictions for a DataFrame.\npreds = predict_dl(\n    df=test_df,                # DataFrame to predict\n    feat_col=feat_col,         # feature column names\n    target_col=target_col,     # used for output column names\n    model_func=get_cnn,        # must match saved architecture\n    model_pth='cnn_fold0',     # model name (without .pth)\n)\n# Returns DataFrame with softmax probabilities, same shape as target_col",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#setup",
    "href": "dnn.html#setup",
    "title": "Train DL",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#utils",
    "href": "dnn.html#utils",
    "title": "Train DL",
    "section": "Utils",
    "text": "Utils\n\n\nseed_everything\n\ndef seed_everything(\n    seed:int=123\n):\n\n\nseed_everything()\n\n\ndef_device\n\n'cpu'",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#load-data",
    "href": "dnn.html#load-data",
    "title": "Train DL",
    "section": "Load Data",
    "text": "Load Data\n\n# df=pd.read_parquet('paper/kinase_domain/train/pspa_t5.parquet')\n\n\n# info=Data.get_kinase_info()\n\n# info = info[info.pseudo=='0']\n\n# info = info[info.kd_ID.notna()]\n\n# subfamily_map = info[['kd_ID','subfamily']].drop_duplicates().set_index('kd_ID')['subfamily']\n\n# pspa_info = pd.DataFrame(df.index.tolist(),columns=['kinase'])\n\n# pspa_info['subfamily'] = pspa_info.kinase.map(subfamily_map)\n\n# splits = get_splits(pspa_info, group='subfamily',nfold=5)\n\n# split0 = splits[0]\n\n\n# df=df.reset_index()\n\n\n# df.columns\n\n\n# # column name of feature and target\n# feat_col = df.columns[df.columns.str.startswith('T5_')]\n# target_col = df.columns[~df.columns.isin(feat_col)][1:]\n\n\n# feat_col\n\n\n# target_col",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#dataset",
    "href": "dnn.html#dataset",
    "title": "Train DL",
    "section": "Dataset",
    "text": "Dataset\n\n\nGeneralDataset\n\ndef GeneralDataset(\n    df, feat_col, # list/Index of feature columns (e.g., 100 cols)\n    target_col:NoneType=None, # list/Index of flattened PSSM cols; AA-first; A=23\n    A:int=23, dtype:type=float32\n):\n\nAn abstract class representing a :class:Dataset.\nAll datasets that represent a map from keys to data samples should subclass it. All subclasses should overwrite :meth:__getitem__, supporting fetching a data sample for a given key. Subclasses could also optionally overwrite :meth:__len__, which is expected to return the size of the dataset by many :class:~torch.utils.data.Sampler implementations and the default options of :class:~torch.utils.data.DataLoader. Subclasses could also optionally implement :meth:__getitems__, for speedup batched samples loading. This method accepts list of indices of samples of batch and returns list of samples.\n.. note:: :class:~torch.utils.data.DataLoader by default constructs an index sampler that yields integral indices. To make it work with a map-style dataset with non-integral indices/keys, a custom sampler must be provided.\n\n# # dataset\n# ds = GeneralDataset(df,feat_col,target_col)\n\n\n# len(ds)\n\n\n# dl = DataLoader(ds, batch_size=64, shuffle=True)\n\n\n# xb,yb = next(iter(dl))\n\n# xb.shape,yb.shape",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#models",
    "href": "dnn.html#models",
    "title": "Train DL",
    "section": "Models",
    "text": "Models\n\nMLP\n\n\n\nMLP\n\ndef MLP(\n    num_features, num_targets, hidden_units:list=[512, 218], dp:float=0.2\n):\n\n\n# n_feature = len(feat_col)\n# n_target = len(target_col)\n\n\n# model = MLP(n_feature, n_target)\n\n\n# model(xb)\n\n\n\nCNN1D\n\n\n\nlin_wn\n\ndef lin_wn(\n    ni, nf, dp:float=0.1, act:type=SiLU\n):\n\nWeight norm of linear.\n\nlin_wn(10,3)\n\nSequential(\n  (0): BatchNorm1d(10, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)\n  (1): Dropout(p=0.1, inplace=False)\n  (2): ParametrizedLinear(\n    in_features=10, out_features=3, bias=True\n    (parametrizations): ModuleDict(\n      (weight): ParametrizationList(\n        (0): _WeightNorm()\n      )\n    )\n  )\n  (3): SiLU()\n)\n\n\n\n\n\nconv_wn\n\ndef conv_wn(\n    ni, nf, ks:int=3, stride:int=1, padding:int=1, dp:float=0.1, act:type=ReLU\n):\n\nWeight norm of conv.\n\n\n\nCNN1D\n\ndef CNN1D(\n    ni, nf, amp_scale:int=16\n):\n\nBase class for all neural network modules.\nYour models should also subclass this class.\nModules can also contain other Modules, allowing them to be nested in a tree structure. You can assign the submodules as regular attributes::\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass Model(nn.Module):\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self.conv1 = nn.Conv2d(1, 20, 5)\n        self.conv2 = nn.Conv2d(20, 20, 5)\n\n    def forward(self, x):\n        x = F.relu(self.conv1(x))\n        return F.relu(self.conv2(x))\nSubmodules assigned in this way will be registered, and will also have their parameters converted when you call :meth:to, etc.\n.. note:: As per the example above, an __init__() call to the parent class must be made before assignment on the child.\n:ivar training: Boolean represents whether this module is in training or evaluation mode. :vartype training: bool\n\n\n\ninit_weights\n\ndef init_weights(\n    m, leaky:float=0.0\n):\n\nInitiate any Conv layer with Kaiming norm.\n\n# model = CNN1D(n_feature,n_target).apply(init_weights)\n\n\n# model(xb).shape",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#wrapper",
    "href": "dnn.html#wrapper",
    "title": "Train DL",
    "section": "Wrapper",
    "text": "Wrapper\n\n\nPSSM_model\n\ndef PSSM_model(\n    n_features, n_targets, model:str='MLP'\n):\n\nBase class for all neural network modules.\nYour models should also subclass this class.\nModules can also contain other Modules, allowing them to be nested in a tree structure. You can assign the submodules as regular attributes::\nimport torch.nn as nn\nimport torch.nn.functional as F\n\nclass Model(nn.Module):\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self.conv1 = nn.Conv2d(1, 20, 5)\n        self.conv2 = nn.Conv2d(20, 20, 5)\n\n    def forward(self, x):\n        x = F.relu(self.conv1(x))\n        return F.relu(self.conv2(x))\nSubmodules assigned in this way will be registered, and will also have their parameters converted when you call :meth:to, etc.\n.. note:: As per the example above, an __init__() call to the parent class must be made before assignment on the child.\n:ivar training: Boolean represents whether this module is in training or evaluation mode. :vartype training: bool\n\n# model = PSSM_model(n_feature,n_target)\n\n\n# logits= model(xb)\n\n\n# logits.shape\n\n\n# def get_mlp(): return PSSM_model(n_feature,n_target,model='MLP')\n\n# def get_cnn(): return PSSM_model(n_feature,n_target,model='CNN')",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#loss",
    "href": "dnn.html#loss",
    "title": "Train DL",
    "section": "Loss",
    "text": "Loss\n\n\nCE\n\ndef CE(\n    logits:Tensor, target_probs:Tensor\n):\n\nCross-entropy with soft labels. logits: (B, 20, 10) target_probs: (B, 20, 10), each column (over AA) sums to 1\n\n# CE(logits,yb)",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#metrics",
    "href": "dnn.html#metrics",
    "title": "Train DL",
    "section": "Metrics",
    "text": "Metrics\n\n\nKLD\n\ndef KLD(\n    logits:Tensor, target_probs:Tensor\n):\n\nAveraged KL divergence across positions between target_probs (p) and softmax(logits) (q).\nlogits: (B, 20, 10) target_probs: (B, 20, 10), each column (over AA) sums to 1\n\n# KLD(logits,yb)\n\n\n\n\nJSD\n\ndef JSD(\n    logits:Tensor, target_probs:Tensor\n):\n\nAveraged Jensen-Shannon Divergence across positions between target_probs (p) and softmax(logits) (q).\nlogits: (B, 20, 10) target_probs: (B, 20, 10), each column (over AA) sums to 1\n\n# JSD(logits,yb)",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#trainer",
    "href": "dnn.html#trainer",
    "title": "Train DL",
    "section": "Trainer",
    "text": "Trainer\n\n\ntrain_dl\n\ndef train_dl(\n    df, feat_col, target_col, split, # tuple of numpy array for split index\n    model_func, # function to get pytorch model\n    n_epoch:int=4, # number of epochs\n    bs:int=32, # batch size\n    lr:float=0.01, # will be useless if lr_find is True\n    loss:function=CE, # loss function\n    save:NoneType=None, # models/{save}.pth\n    sampler:NoneType=None, lr_find:bool=False, # if true, will use lr from lr_find\n):\n\nA DL trainer.\n\n# target, pred = train_dl(df, \n#                         feat_col, \n#                         target_col,\n#                         split0, \n#                         model_func=get_cnn,\n#                         n_epoch=1,\n#                         lr = 3e-3,\n#                         lr_find=True,\n#                         save = 'test')\n\n\n# pred\n\n\n# pred_pssm = recover_pssm(pred.iloc[0])\n# pred_pssm.sum()",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#predict",
    "href": "dnn.html#predict",
    "title": "Train DL",
    "section": "Predict",
    "text": "Predict\n\n\npredict_dl\n\ndef predict_dl(\n    df, feat_col, target_col, model_func, # model architecture\n    model_pth, # only name, not with .pth\n):\n\nPredict dataframe given a deep learning model\n\n# test = df.loc[split0[1]].copy()\n\n\n# test_pred = predict_dl(test, \n#                feat_col, \n#                target_col,\n#                model_func=get_cnn, # model architecture\n#                model_pth='test', # only name, not with .pth\n#               )\n\n\n# test_pred.columns\n\n\n# pssm_pred = recover_pssm(test_pred.iloc[0])\n# pssm_pred.sum()\n\n\n# plot_heatmap(pssm_pred)",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "dnn.html#cv-train",
    "href": "dnn.html#cv-train",
    "title": "Train DL",
    "section": "CV train",
    "text": "CV train\n\ncross-validation\n\n\n\ntrain_dl_cv\n\ndef train_dl_cv(\n    df, feat_col, target_col, splits, # list of tuples\n    model_func, # functions like lambda x: return MLP_1(num_feat, num_target)\n    save:str=None, kwargs:VAR_KEYWORD\n):\n\n\n# oof = train_dl_cv(df,feat_col,target_col,\n#                   splits = splits,\n#                   model_func = get_cnn,\n#                   n_epoch=1,lr=3e-3,save='cnn')\n\n\n# oof.nfold.value_counts()",
    "crumbs": [
      "Modules",
      "Train DL"
    ]
  },
  {
    "objectID": "pssm_compare.html",
    "href": "pssm_compare.html",
    "title": "pssm.compare",
    "section": "",
    "text": "Functions for comparing Position-Specific Scoring Matrices (PSSMs) using various divergence and similarity metrics.\n\nKL Divergence\nkl_divergence computes the Kullback-Leibler divergence \\(D_{KL}(P \\| Q)\\) between two PSSMs, measuring information lost when one distribution approximates another. Returns per-position divergence values (non-negative, 0 means identical). Note: KL divergence is asymmetric.\nkl_divergence(\n    p1=pssm_df,   # target PSSM P (DataFrame, shape: AA × positions)\n    p2=pssm_df2,  # predicted PSSM Q (DataFrame, same shape as p1)\n)\nkl_divergence_flat computes mean KL divergence from flattened PSSM Series (e.g., rows from a PSSM DataFrame).\nkl_divergence_flat(\n    p1_flat=pssms.iloc[1],  # target flattened PSSM (pd.Series with 'pos_AA' index)\n    p2_flat=pssms.iloc[0],  # predicted flattened PSSM (pd.Series, same structure)\n)\n\nJS Divergence\njs_divergence computes the Jensen-Shannon divergence, a symmetric version of KL divergence using the mixture \\(M = \\frac{1}{2}(P + Q)\\). Returns per-position divergence as a Series.\njs_divergence(\n    p1=pssm_df,    # first PSSM (DataFrame, shape: AA × positions)\n    p2=pssm_df2,   # second PSSM (DataFrame, same shape)\n    index=True,    # whether to return Series with position index\n)\njs_divergence_flat computes mean JS divergence from flattened PSSM Series.\njs_divergence_flat(\n    p1_flat=pssms.iloc[1],  # first flattened PSSM (pd.Series)\n    p2_flat=pssms.iloc[0],  # second flattened PSSM (pd.Series)\n)\n\nJS Similarity\njs_similarity converts JS divergence to a similarity score in \\([0, 1]\\) by normalizing to bits (dividing by \\(\\log 2\\)) then computing \\(1 - JS_{bits}\\). Returns per-position similarity.\njs_similarity(\n    pssm1=pssm_df,   # first PSSM (DataFrame)\n    pssm2=pssm_df2,  # second PSSM (DataFrame)\n).mean()  # average across positions\njs_similarity_flat computes mean JS similarity from flattened PSSM Series.\njs_similarity_flat(\n    p1_flat=pssms.iloc[1],  # first flattened PSSM (pd.Series)\n    p2_flat=pssms.iloc[0],  # second flattened PSSM (pd.Series)\n)\n\nCosine Similarity\ncosine_similarity computes cosine similarity \\(\\frac{P \\cdot Q}{\\|P\\| \\|Q\\|}\\) per position between two PSSMs. Since PSSM values are probabilities in \\([0,1]\\), similarity is bounded in \\([0, 1]\\).\ncosine_similarity(\n    pssm1=pssm_df,   # first PSSM (DataFrame, shape: AA × positions)\n    pssm2=pssm_df2,  # second PSSM (DataFrame, same shape)\n)\ncosine_overall_flat computes a single overall cosine similarity across all positions from flattened PSSMs.\ncosine_overall_flat(\n    pssm1_flat=pssms.iloc[0],  # first flattened PSSM (pd.Series)\n    pssm2_flat=pssms.iloc[1],  # second flattened PSSM (pd.Series)\n)",
    "crumbs": [
      "Modules",
      "pssm.compare"
    ]
  },
  {
    "objectID": "pssm_compare.html#overview",
    "href": "pssm_compare.html#overview",
    "title": "pssm.compare",
    "section": "",
    "text": "Functions for comparing Position-Specific Scoring Matrices (PSSMs) using various divergence and similarity metrics.\n\nKL Divergence\nkl_divergence computes the Kullback-Leibler divergence \\(D_{KL}(P \\| Q)\\) between two PSSMs, measuring information lost when one distribution approximates another. Returns per-position divergence values (non-negative, 0 means identical). Note: KL divergence is asymmetric.\nkl_divergence(\n    p1=pssm_df,   # target PSSM P (DataFrame, shape: AA × positions)\n    p2=pssm_df2,  # predicted PSSM Q (DataFrame, same shape as p1)\n)\nkl_divergence_flat computes mean KL divergence from flattened PSSM Series (e.g., rows from a PSSM DataFrame).\nkl_divergence_flat(\n    p1_flat=pssms.iloc[1],  # target flattened PSSM (pd.Series with 'pos_AA' index)\n    p2_flat=pssms.iloc[0],  # predicted flattened PSSM (pd.Series, same structure)\n)\n\nJS Divergence\njs_divergence computes the Jensen-Shannon divergence, a symmetric version of KL divergence using the mixture \\(M = \\frac{1}{2}(P + Q)\\). Returns per-position divergence as a Series.\njs_divergence(\n    p1=pssm_df,    # first PSSM (DataFrame, shape: AA × positions)\n    p2=pssm_df2,   # second PSSM (DataFrame, same shape)\n    index=True,    # whether to return Series with position index\n)\njs_divergence_flat computes mean JS divergence from flattened PSSM Series.\njs_divergence_flat(\n    p1_flat=pssms.iloc[1],  # first flattened PSSM (pd.Series)\n    p2_flat=pssms.iloc[0],  # second flattened PSSM (pd.Series)\n)\n\nJS Similarity\njs_similarity converts JS divergence to a similarity score in \\([0, 1]\\) by normalizing to bits (dividing by \\(\\log 2\\)) then computing \\(1 - JS_{bits}\\). Returns per-position similarity.\njs_similarity(\n    pssm1=pssm_df,   # first PSSM (DataFrame)\n    pssm2=pssm_df2,  # second PSSM (DataFrame)\n).mean()  # average across positions\njs_similarity_flat computes mean JS similarity from flattened PSSM Series.\njs_similarity_flat(\n    p1_flat=pssms.iloc[1],  # first flattened PSSM (pd.Series)\n    p2_flat=pssms.iloc[0],  # second flattened PSSM (pd.Series)\n)\n\nCosine Similarity\ncosine_similarity computes cosine similarity \\(\\frac{P \\cdot Q}{\\|P\\| \\|Q\\|}\\) per position between two PSSMs. Since PSSM values are probabilities in \\([0,1]\\), similarity is bounded in \\([0, 1]\\).\ncosine_similarity(\n    pssm1=pssm_df,   # first PSSM (DataFrame, shape: AA × positions)\n    pssm2=pssm_df2,  # second PSSM (DataFrame, same shape)\n)\ncosine_overall_flat computes a single overall cosine similarity across all positions from flattened PSSMs.\ncosine_overall_flat(\n    pssm1_flat=pssms.iloc[0],  # first flattened PSSM (pd.Series)\n    pssm2_flat=pssms.iloc[1],  # second flattened PSSM (pd.Series)\n)",
    "crumbs": [
      "Modules",
      "pssm.compare"
    ]
  },
  {
    "objectID": "pssm_compare.html#setup",
    "href": "pssm_compare.html#setup",
    "title": "pssm.compare",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "pssm.compare"
    ]
  },
  {
    "objectID": "pssm_compare.html#compare-pssm",
    "href": "pssm_compare.html#compare-pssm",
    "title": "pssm.compare",
    "section": "Compare PSSM",
    "text": "Compare PSSM\n\nfrom katlas.data import *\nfrom katlas.pssm.core import *\n\n\npssms = Data.get_pspa_scale()\n\n\n# one example\npssm_df = recover_pssm(pssms.iloc[1])\npssm_df2 = recover_pssm(pssms.iloc[0])\n\n\nKL divergence\n\n\n\nkl_divergence\n\ndef kl_divergence(\n    p1, # target pssm p (array-like, shape: (AA, positions))\n    p2, # pred pssm q (array-like, same shape as p1)\n):\n\nKL divergence D_KL(p1 || p2) over positions.\np1 and p2 are arrays (df or np) with index as aa and column as position. Returns average divergence across positions if mean=True, else per-position.\nThe Kullback–Leibler (KL) divergence between two probability distributions ( P ) and ( Q ) is defined as:\n\\[\n\\mathrm{KL}(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\log \\left( \\frac{P(x)}{Q(x)} \\right)\n\\]\nThis measures the information lost when ( Q ) is used to approximate ( P ). It is not symmetric, i.e.,\n\\[\n\\mathrm{KL}(P \\| Q) \\ne \\mathrm{KL}(Q \\| P)\n\\]\nand it is non-negative, meaning:\n\\[\n\\mathrm{KL}(P \\| Q) \\ge 0\n\\]\nwith equality if and only if ( P = Q ) almost everywhere.\nIn practical computation, to avoid numerical instability when ( P(x) = 0 ) or ( Q(x) = 0 ), we often add a small constant ( ):\n\\[\n\\mathrm{KL}_\\varepsilon(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\log \\left( \\frac{P(x) + \\varepsilon}{Q(x) + \\varepsilon} \\right)\n\\]\n\nkl_divergence(pssm_df,pssm_df2)\n\narray([0.29182172, 0.11138481, 0.24590698, 0.46021635, 0.36874823,\n       0.53858511, 1.51571614, 0.02905442, 0.08530757, 0.07753394])\n\n\n\nkl_divergence(pssm_df,pssm_df2).mean(),kl_divergence(pssm_df,pssm_df2).max()\n\n(np.float64(0.37242752573216287), np.float64(1.5157161422110503))\n\n\n\n\n\nkl_divergence_flat\n\ndef kl_divergence_flat(\n    p1_flat, # pd.Series of target flattened pssm p\n    p2_flat, # pd.Series of pred flattened pssm q\n):\n\np1 and p2 are two flattened pd.Series with index as aa and column as position\n\nkl_divergence_flat(pssms.iloc[1],pssms.iloc[0])\n\nCPU times: user 2.01 ms, sys: 0 ns, total: 2.01 ms\nWall time: 2 ms\n\n\n0.37242752573216287\n\n\n\n\nJS divergence\n\n\n\njs_divergence\n\ndef js_divergence(\n    p1, # pssm\n    p2, # pssm\n    index:bool=True\n):\n\np1 and p2 are two arrays (df or np) with index as aa and column as position\nThe Jensen-Shannon divergence between two probability distributions \\(P\\) and \\(Q\\) is defined as:\n\\[\n\\mathrm{JS}(P \\| Q) = \\frac{1}{2} \\, \\mathrm{KL}(P \\| M) + \\frac{1}{2} \\, \\mathrm{KL}(Q \\| M)\n\\]\nwhere $ M = (P + Q) $ is the average (mixture) distribution, and $ $ denotes the Kullback–Leibler divergence:\n\\[\n\\mathrm{KL}(P \\| Q) = \\sum_{x \\in \\mathcal{X}} P(x) \\log \\left( \\frac{P(x)}{Q(x)} \\right)\n\\]\nTherefore,\n\\[\n\\mathrm{JS}_\\varepsilon(P \\| Q) = \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} P(x) \\log \\left( \\frac{P(x) + \\varepsilon}{M(x) + \\varepsilon} \\right)\n+ \\frac{1}{2} \\sum_{x \\in \\mathcal{X}} Q(x) \\log \\left( \\frac{Q(x) + \\varepsilon}{M(x) + \\varepsilon} \\right)\n\\]\n\njs_divergence(pssm_df,pssm_df2)\n\nPosition\n-5    0.065539\n-4    0.025712\n-3    0.054799\n-2    0.103192\n-1    0.083377\n 0    0.105490\n 1    0.344049\n 2    0.007299\n 3    0.020949\n 4    0.018206\ndtype: float64\n\n\n\njs_divergence(pssm_df,pssm_df2).max(),js_divergence(pssm_df,pssm_df2).mean()\n\n(np.float64(0.34404931056288773), np.float64(0.08286124552178498))\n\n\n\n\n\njs_divergence_flat\n\ndef js_divergence_flat(\n    p1_flat, # pd.Series of flattened pssm\n    p2_flat, # pd.Series of flattened pssm\n):\n\np1 and p2 are two flattened pd.Series with index as aa and column as position\n\njs_divergence_flat(pssms.iloc[1],pssms.iloc[0])\n\nCPU times: user 2.02 ms, sys: 0 ns, total: 2.02 ms\nWall time: 2.01 ms\n\n\n0.08286124552178498\n\n\n\n\nJS similarity\nTo convert the Jensen–Shannon divergence into a similarity measure, we first normalize it to bits by dividing by log(2), ensuring that the divergence lies within the range [0, 1]. \\[\n\\mathrm{JS}_{\\text{bits}}(P \\| Q) = \\frac{\\mathrm{JS}(P \\| Q)}{\\log 2}\n\\]\nThe similarity is then defined as one minus this normalized divergence: \\[\n\\mathrm{Sim}_{\\mathrm{JS}}(P, Q) = 1 - \\mathrm{JS}_{\\text{bits}}(P \\| Q)\n\\]\nThus, \\(\\mathrm{Sim}_{\\mathrm{JS}}\\) ranges from 0 (completely dissimilar) to 1 (identical distributions).\n\n\n\njs_similarity\n\ndef js_similarity(\n    pssm1, pssm2\n):\n\nConvert JSD to bits to be in range (0,1) then 1-JSD.\n\njs_similarity(pssm_df,pssm_df2).mean()\n\nnp.float64(0.880456492003838)\n\n\n\n\n\njs_similarity_flat\n\ndef js_similarity_flat(\n    p1_flat, p2_flat\n):\n\nConvert JSD to bits to be in range (0,1) then 1-JSD.\n\njs_similarity_flat(pssms.iloc[1],pssms.iloc[0])\n\nnp.float64(0.880456492003838)\n\n\n\n\nCosine similarity\n\n\n\ncosine_similarity\n\ndef cosine_similarity(\n    pssm1:DataFrame, pssm2:DataFrame\n)-&gt;Series:\n\nCompute cosine similarity per position (column) between two PSSMs.\nThe cosine similarity between two vectors ( P ) and ( Q ) (e.g., two PSSM columns representing amino acid probability distributions) is defined as:\n\\[\n\\mathrm{cos}(P, Q) = \\frac{P \\cdot Q}{\\|P\\| \\, \\|Q\\|}\n\\]\nwhere $ P Q = _{i=1}^{n} P_i Q_i $ is the dot product between $ P $ and $ Q $, and $ |P| = $ is the Euclidean norm of $ P $.\nSince all entries of $ P $ and $ Q $ are nonnegative probabilities (i.e., $ P_i, Q_i $), the cosine similarity lies within the range:\n\\[\n0 \\leq \\mathrm{cos}(P, Q) \\leq 1\n\\]\nGiven that pssm are probabilities between 0 and 1, cosine similarity is within (0,1)\n\ncosine_similarity(pssm_df,pssm_df2).sort_values()\n\n 1    0.130818\n-2    0.606234\n-1    0.731466\n 0    0.780066\n-5    0.780504\n-3    0.786276\n-4    0.901395\n 3    0.918692\n 4    0.934967\n 2    0.971066\ndtype: float64\n\n\n\ncosine_similarity(pssm_df,pssm_df2).mean()\n\nnp.float64(0.754148470457778)\n\n\n\n\n\ncosine_overall_flat\n\ndef cosine_overall_flat(\n    pssm1_flat, pssm2_flat\n):\n\nCompute overall cosine similarity between two PSSMs (flattened).\n\ncosine_overall_flat(pssms.iloc[0],pssms.iloc[0])\n\nnp.float64(0.9999999999999999)\n\n\n\ncosine_overall_flat(pssms.iloc[0],pssms.iloc[1])\n\nnp.float64(0.6614783212500968)",
    "crumbs": [
      "Modules",
      "pssm.compare"
    ]
  },
  {
    "objectID": "hierarchical.html#labels",
    "href": "hierarchical.html#labels",
    "title": "Hierarchical clustering",
    "section": "Labels",
    "text": "Labels\n\n\npssm_to_seq\n\ndef pssm_to_seq(\n    pssm_df, thr:float=0.2, # threshold of probability to show in sequence\n    clean_center:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nRepresent PSSM in string sequence of amino acids\n\npssm_to_seq(recover_pssm(df.iloc[0]))\n\n'.....t*G...'\n\n\n\n\n\nget_pssm_seq_labels\n\ndef get_pssm_seq_labels(\n    pssms, count_map:NoneType=None, thr:float=0.3\n):\n\n\nget_pssm_seq_labels(df.head(2),count_map={'AAK1':100,'ACVR2A':50})\n\n['AAK1 (n=100): .....t*G...', 'ACVR2A (n=50): .....[t/s]*....']",
    "crumbs": [
      "Modules",
      "Hierarchical clustering"
    ]
  },
  {
    "objectID": "pssm_pspa.html",
    "href": "pssm_pspa.html",
    "title": "pssm.pspa",
    "section": "",
    "text": "This module provides tools for visualizing Position-Specific Scoring Matrices (PSSMs) from Positional Scanning Peptide Array (PSPA) kinase substrate specificity data.\n\nData Preprocessing\npreprocess_pspa(pssm) — Prepares raw PSSM data for logo visualization. It removes the duplicate ‘s’ row (since it duplicates ‘t’), renames phospho-residues to ‘pS/pT’ and ‘pY’, and applies log₂ transformation relative to the median (excluding position 0, which is handled separately via scaling).\npssm = preprocess_pspa(\n    pssm=raw_pssm,  # DataFrame with amino acids as index, positions as columns\n)\n\nVisualization Functions\nplot_logo_pspa(row, title, figsize) — Generates a sequence logo from a single row of PSPA data. The letter heights represent log₂(value/median), showing amino acid preferences at each position.\nplot_logo_pspa(\n    row=pspa.loc['GSK3B'],  # single kinase row from Data.get_pspa()\n    title='GSK3B',          # plot title\n    figsize=(5, 2),         # figure dimensions (width, height)\n)\nplot_logo_heatmap_pspa(row, title, figsize, include_zero) — Creates a combined visualization with the sequence logo on top and a heatmap below, allowing detailed inspection of specificity values at each position.\nplot_logo_heatmap_pspa(\n    row=pspa.loc['GSK3B'],  # single kinase row from Data.get_pspa()\n    title='GSK3B',          # plot title\n    figsize=(6, 10),        # figure dimensions (width, height)\n    include_zero=False,     # whether to include position 0 in heatmap\n)\n\nNormalization Functions (old version)\nraw2norm(df, PDHK) — Normalizes raw PSPA data following the method from Johnson et al. (Nature 2022). Column-normalizes by sum of 17 randomized amino acids (excluding S, T, C), scales cysteine by its median, and sets S/T values to position medians.\nnorm_df = raw2norm(\n    df=kinase_df,  # DataFrame with position as index, amino acids as columns\n    PDHK=False,    # True for PDHK1/PDHK4 (uses 16 amino acids, also excludes Y)\n)\nget_one_kinase(df, kinase, normalize, drop_s) — Extracts and reshapes data for a single kinase from the stacked PSPA DataFrame, optionally applying normalization.\nkinase_data = get_one_kinase(\n    df=data,           # stacked DataFrame (kinase as index, position+aa as columns)\n    kinase='PDHK1',    # kinase name to extract\n    normalize=False,   # apply Johnson et al. normalization\n    drop_s=True,       # drop 's' row (duplicate of 't' in PSPA)\n)\nget_logo(df, kinase) — End-to-end function that takes raw stacked PSPA data and generates a sequence logo for a specific kinase, including proper S/T ratio calculation at position 0.\nget_logo(\n    df=raw_pspa_df,  # stacked DataFrame with kinase as index, substrates as columns\n    kinase='AAK1',   # kinase name to visualize\n)",
    "crumbs": [
      "Modules",
      "pssm.pspa"
    ]
  },
  {
    "objectID": "pssm_pspa.html#overview",
    "href": "pssm_pspa.html#overview",
    "title": "pssm.pspa",
    "section": "",
    "text": "This module provides tools for visualizing Position-Specific Scoring Matrices (PSSMs) from Positional Scanning Peptide Array (PSPA) kinase substrate specificity data.\n\nData Preprocessing\npreprocess_pspa(pssm) — Prepares raw PSSM data for logo visualization. It removes the duplicate ‘s’ row (since it duplicates ‘t’), renames phospho-residues to ‘pS/pT’ and ‘pY’, and applies log₂ transformation relative to the median (excluding position 0, which is handled separately via scaling).\npssm = preprocess_pspa(\n    pssm=raw_pssm,  # DataFrame with amino acids as index, positions as columns\n)\n\nVisualization Functions\nplot_logo_pspa(row, title, figsize) — Generates a sequence logo from a single row of PSPA data. The letter heights represent log₂(value/median), showing amino acid preferences at each position.\nplot_logo_pspa(\n    row=pspa.loc['GSK3B'],  # single kinase row from Data.get_pspa()\n    title='GSK3B',          # plot title\n    figsize=(5, 2),         # figure dimensions (width, height)\n)\nplot_logo_heatmap_pspa(row, title, figsize, include_zero) — Creates a combined visualization with the sequence logo on top and a heatmap below, allowing detailed inspection of specificity values at each position.\nplot_logo_heatmap_pspa(\n    row=pspa.loc['GSK3B'],  # single kinase row from Data.get_pspa()\n    title='GSK3B',          # plot title\n    figsize=(6, 10),        # figure dimensions (width, height)\n    include_zero=False,     # whether to include position 0 in heatmap\n)\n\nNormalization Functions (old version)\nraw2norm(df, PDHK) — Normalizes raw PSPA data following the method from Johnson et al. (Nature 2022). Column-normalizes by sum of 17 randomized amino acids (excluding S, T, C), scales cysteine by its median, and sets S/T values to position medians.\nnorm_df = raw2norm(\n    df=kinase_df,  # DataFrame with position as index, amino acids as columns\n    PDHK=False,    # True for PDHK1/PDHK4 (uses 16 amino acids, also excludes Y)\n)\nget_one_kinase(df, kinase, normalize, drop_s) — Extracts and reshapes data for a single kinase from the stacked PSPA DataFrame, optionally applying normalization.\nkinase_data = get_one_kinase(\n    df=data,           # stacked DataFrame (kinase as index, position+aa as columns)\n    kinase='PDHK1',    # kinase name to extract\n    normalize=False,   # apply Johnson et al. normalization\n    drop_s=True,       # drop 's' row (duplicate of 't' in PSPA)\n)\nget_logo(df, kinase) — End-to-end function that takes raw stacked PSPA data and generates a sequence logo for a specific kinase, including proper S/T ratio calculation at position 0.\nget_logo(\n    df=raw_pspa_df,  # stacked DataFrame with kinase as index, substrates as columns\n    kinase='AAK1',   # kinase name to visualize\n)",
    "crumbs": [
      "Modules",
      "pssm.pspa"
    ]
  },
  {
    "objectID": "pssm_pspa.html#setup",
    "href": "pssm_pspa.html#setup",
    "title": "pssm.pspa",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "pssm.pspa"
    ]
  },
  {
    "objectID": "pssm_pspa.html#plot",
    "href": "pssm_pspa.html#plot",
    "title": "pssm.pspa",
    "section": "Plot",
    "text": "Plot\n\n\npreprocess_pspa\n\ndef preprocess_pspa(\n    pssm\n):\n\nDrop row s as it’s a duplicate of t; rename t to pS/pT; calculate np.log2(pssm/pssm.median())\n\npspa=Data.get_pspa()\n\nrow = pspa.loc['GSK3B']\npssm = recover_pssm(row.dropna())\npssm = preprocess_pspa(pssm)\npssm\n\n\n\n\n\n\n\nPosition\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.128793\n0.103768\n0.327105\n0.377614\n0.200697\n0.000000\n0.857330\n-0.156606\n-0.022523\n0.020985\n\n\nG\n0.267518\n0.232140\n0.709128\n0.215152\n0.186051\n0.000000\n-0.070893\n-0.132404\n-0.032647\n-0.138561\n\n\nA\n0.198756\n0.026650\n0.861131\n0.210679\n0.040110\n0.000000\n-0.073537\n0.007280\n-0.146221\n-0.092757\n\n\nC\n0.281692\n0.223789\n0.041703\n0.297615\n-0.036342\n0.000000\n0.018745\n0.043140\n0.002481\n0.013151\n\n\nS\n0.000000\n-0.019696\n-0.001366\n-0.016950\n0.000000\n5.167707\n-0.001258\n0.000000\n-0.002485\n-0.013272\n\n\nT\n0.000000\n-0.019696\n-0.001366\n-0.016950\n0.000000\n4.454046\n-0.001258\n0.000000\n-0.002485\n-0.013272\n\n\nV\n0.052905\n-0.029645\n0.009523\n0.047180\n-0.161873\n0.000000\n0.067572\n-0.151192\n-0.154488\n-0.213174\n\n\nI\n0.000000\n-0.135793\n-0.045760\n0.094081\n-0.205347\n0.000000\n0.065169\n-0.034469\n-0.089637\n-0.222392\n\n\nL\n0.041050\n-0.054824\n-0.194011\n-0.100647\n-0.161873\n0.000000\n-0.013903\n-0.019595\n-0.097586\n-0.129861\n\n\nM\n-0.049839\n-0.090829\n-0.012337\n-0.100647\n0.076869\n0.000000\n-0.001258\n-0.027013\n0.100694\n-0.026668\n\n\nF\n0.071672\n-0.127756\n-0.144893\n-0.145823\n-0.247330\n0.000000\n-0.049908\n0.064236\n0.098376\n-0.092757\n\n\nY\n-0.007367\n0.021841\n-0.051406\n-0.160236\n-0.140617\n0.000000\n-0.192106\n0.000000\n0.079700\n0.114257\n\n\nW\n0.108489\n0.059871\n0.023019\n0.016753\n-0.091356\n0.000000\n0.001257\n0.007280\n0.012363\n0.148034\n\n\nH\n0.024288\n-0.019696\n-0.026169\n-0.095098\n0.000000\n0.000000\n0.016259\n0.199623\n0.161902\n0.089637\n\n\nK\n-0.032199\n0.144157\n0.057528\n0.237314\n0.094903\n0.000000\n0.067572\n0.016930\n0.036774\n0.082169\n\n\nR\n-0.042252\n0.080831\n0.598097\n0.647946\n0.049388\n0.000000\n0.050669\n0.054898\n0.084392\n-0.129861\n\n\nQ\n-0.163205\n-0.090829\n-0.015093\n-0.022206\n0.083658\n0.000000\n0.040921\n0.112292\n-0.002485\n-0.013272\n\n\nN\n-0.227709\n0.019431\n0.001364\n-0.016950\n0.014284\n0.000000\n-0.018991\n0.156618\n-0.007469\n0.097067\n\n\nD\n-0.271386\n-0.049753\n-0.001366\n-0.040753\n-0.210875\n0.000000\n-0.238837\n-0.234608\n-0.116305\n0.015767\n\n\nE\n-0.271386\n-0.238787\n-0.054238\n-0.075844\n-0.261600\n0.000000\n-0.253757\n-0.137747\n0.315457\n1.379934\n\n\npS/pT\n-0.112011\n0.206940\n0.355120\n0.106174\n-0.114481\n0.000000\n0.055519\n-0.004874\n1.836501\n6.163857\n\n\npY\n-0.106727\n0.196308\n0.158811\n0.259140\n0.699151\n0.000000\n0.222213\n0.047855\n1.191558\n1.496894\n\n\n\n\n\n\n\n\n\n\nplot_logo_pspa\n\ndef plot_logo_pspa(\n    row, title:str='Motif', figsize:tuple=(5, 2)\n):\n\n\nplot_logo_pspa(pspa.loc['GSK3B'],title='GSK3B')\n\n\n\n\n\n\n\n\n\n\n\nplot_logo_heatmap_pspa\n\ndef plot_logo_heatmap_pspa(\n    row, # row of Data.get_pspa()\n    title:str='Motif', figsize:tuple=(6, 10), include_zero:bool=False\n):\n\nPlot logo and heatmap vertically\n\nplot_logo_heatmap_pspa(pspa.loc['GSK3B'],title='GSK3B')",
    "crumbs": [
      "Modules",
      "pssm.pspa"
    ]
  },
  {
    "objectID": "pssm_pspa.html#others-old-version",
    "href": "pssm_pspa.html#others-old-version",
    "title": "pssm.pspa",
    "section": "Others (old version)",
    "text": "Others (old version)\n\n\nraw2norm\n\ndef raw2norm(\n    df:DataFrame, # single kinase's df has position as index, and single amino acid as columns\n    PDHK:bool=False, # whether this kinase belongs to PDHK family\n):\n\nNormalize single ST kinase data\nThis function implement the normalization method from Johnson et al. Nature: An atlas of substrate specificities for the human serine/threonine kinome\nSpecifically, &gt; - matrices were column-normalized at all positions by the sum of the 17 randomized amino acids (excluding serine, threonine and cysteine), to yield PSSMs. &gt;- PDHK1 and PDHK4 were normalized to the 16 randomized amino acids (excluding serine, threonine, cysteine and additionally tyrosine) &gt;- The cysteine row was scaled by its median to be 1/17 (1/16 for PDHK1 and PDHK4). &gt;- The serine and threonine values in each position were set to be the median of that position. &gt;- The S0/T0 ratio was determined by summing the values of S and T rows in the matrix (SS and ST, respectively), accounting for the different S vs. T composition of the central (1:1) and peripheral (only S or only T) positions (Sctrl and Tctrl, respectively), and then normalizing to the higher value among the two (S0 and T0, respectively, Supplementary Note 1)\nThis function is usually implemented with the below function, with normalize being a bool argument.\n\n\n\nget_one_kinase\n\ndef get_one_kinase(\n    df:DataFrame, # stacked dataframe (paper's raw data)\n    kinase:str, # a specific kinase\n    normalize:bool=False, # normalize according to the paper; special for PDHK1/4\n    drop_s:bool=True, # drop s as s is a duplicates of t in PSPA\n):\n\nObtain a specific kinase data from stacked dataframe\nRetreive a single kinase data from PSPA data that has an format of kinase as index and position+amino acid as column.\n\ndata = Data.get_pspa_st()\n\n\nget_one_kinase(data,'PDHK1')\n\n\n\n\n\n\n\naa\nA\nC\nD\nE\nF\nG\nH\nI\nK\nL\n...\nP\nQ\nR\nS\nT\nV\nW\nY\nt\ny\n\n\nposition\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n-5\n0.0594\n0.0625\n0.0589\n0.0550\n0.0775\n0.0697\n0.0687\n0.0590\n0.0515\n0.0657\n...\n0.0451\n0.0424\n0.0594\n0.0594\n0.0594\n0.0573\n0.1001\n0.0775\n0.0583\n0.0658\n\n\n-4\n0.0618\n0.0621\n0.0550\n0.0511\n0.0739\n0.0715\n0.0598\n0.0601\n0.0520\n0.0614\n...\n0.0637\n0.0552\n0.0617\n0.0608\n0.0608\n0.0519\n0.0916\n0.0739\n0.0528\n0.0752\n\n\n-3\n0.0608\n0.0576\n0.0499\n0.0423\n0.0803\n0.0580\n0.0674\n0.0687\n0.0481\n0.0667\n...\n0.0570\n0.0532\n0.0532\n0.0584\n0.0584\n0.0588\n0.1113\n0.0803\n0.0416\n0.0553\n\n\n-2\n0.0587\n0.0655\n0.0470\n0.0437\n0.0790\n0.0890\n0.0787\n0.0533\n0.0440\n0.0637\n...\n0.0500\n0.0543\n0.0616\n0.0565\n0.0565\n0.0519\n0.1082\n0.0790\n0.0327\n0.0557\n\n\n-1\n0.0782\n0.1009\n0.0989\n0.0426\n0.0650\n0.0695\n0.0782\n0.0496\n0.0409\n0.0578\n...\n0.0540\n0.0500\n0.0469\n0.0594\n0.0594\n0.0514\n0.0756\n0.0650\n0.0358\n0.0433\n\n\n0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n...\nNaN\nNaN\nNaN\n1.0000\n0.4886\nNaN\nNaN\n0.0000\n0.4886\n0.0000\n\n\n1\n0.0400\n0.0562\n0.0394\n0.0355\n0.0735\n0.0400\n0.0502\n0.1288\n0.0390\n0.1439\n...\n0.0379\n0.0455\n0.0455\n0.0455\n0.0455\n0.0797\n0.0784\n0.0735\n0.0336\n0.0452\n\n\n2\n0.0496\n0.0783\n0.0643\n0.0555\n0.0720\n0.1067\n0.0684\n0.0480\n0.0505\n0.0555\n...\n0.0564\n0.0653\n0.0695\n0.0601\n0.0601\n0.0508\n0.0672\n0.0720\n0.0414\n0.0594\n\n\n3\n0.0486\n0.0609\n0.0938\n0.0684\n0.1024\n0.0676\n0.0544\n0.0583\n0.0388\n0.0552\n...\n0.0686\n0.0502\n0.0561\n0.0588\n0.0588\n0.0593\n0.0641\n0.1024\n0.0539\n0.0431\n\n\n4\n0.0565\n0.0749\n0.0631\n0.0535\n0.0732\n0.0655\n0.0664\n0.0625\n0.0496\n0.0552\n...\n0.0677\n0.0553\n0.0604\n0.0626\n0.0626\n0.0579\n0.0864\n0.0732\n0.0548\n0.0575\n\n\n\n\n10 rows × 22 columns\n\n\n\n\n\n\nget_logo\n\ndef get_logo(\n    df:DataFrame, # stacked Dataframe with kinase as index, substrates as columns\n    kinase:str, # a specific kinase name in index\n):\n\nGiven stacked df (index as kinase, columns as substrates), get a specific kinase’s logo\nThis function is to replicate the motif logo from Johnson et al. Nature: An atlas of substrate specificities for the human serine/threonine kinome. Given raw PSPA data, it can output a motif logo.\n\n# load raw PSPA data\n# df = pd.read_csv('https://github.com/sky1ove/katlas_raw/raw/refs/heads/main/nbs/raw/pspa_st_raw.csv').set_index('kinase')\n# df.head()\n# get_logo(df, 'AAK1')",
    "crumbs": [
      "Modules",
      "pssm.pspa"
    ]
  },
  {
    "objectID": "pssm_core.html",
    "href": "pssm_core.html",
    "title": "pssm.core",
    "section": "",
    "text": "PSSM Calculation\nTo calculate a position-specific probability matrix (PSSM) from phosphorylation site sequences:\npssm_df = get_prob(\n    data=df,       # input DataFrame, Series, or list of sequences\n    col='site_seq',    # column name containing sequences (if DataFrame)\n)\nAlternatively, use a list of sequences as input\npssm_df = get_prob(\n    data=df['site_seq'],       # input DataFrame, Series, or list of sequences\n)\nTo extract flattened PSSMs for each cluster in a dataset:\ncluster_pssms = get_cluster_pssms(\n    df=data,                    # DataFrame containing sequences and cluster labels\n    cluster_col='kinase_group', # column name for cluster identifiers\n    seq_col='site_seq',         # column name for site sequences\n    id_col='sub_site',          # column for deduplication within clusters (None to skip)\n    count_thr=10,               # minimum sequences required per cluster\n    valid_thr=None,             # minimum fraction of non-zero PSSM values (None to skip)\n    plot=False,                 # whether to plot sequence logos for each cluster\n)\n\nPSSM Transformation\nTo flatten a 2D PSSM into a dictionary (for storage or model input):\nflat_dict = flatten_pssm(\n    pssm_df=pssm_df,     # 2D PSSM with amino acids as rows, positions as columns\n    column_wise=True,    # True for column-major order; False for row-wise (PyTorch)\n)\nTo recover a 2D PSSM from a flattened Series:\npssm_df = recover_pssm(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series with position+aa index\n)\nTo clean the center position and normalize each column to sum to 1:\npssm_norm = clean_zero_normalize(\n    pssm_df=pssm,  # 2D PSSM (zeros out non-s/t/y at position 0, then normalizes)\n)\n\nEntropy Analysis\nTo calculate Shannon entropy per position (lower entropy = more conserved):\nentropy = get_entropy(\n    pssm_df=pssm_df,      # 2D PSSM matrix\n    return_min=False,     # True to return single minimum value\n    exclude_zero=True,    # True to exclude center position from calculation\n    clean_zero=True,      # True to zero out non-s/t/y at position 0\n)\nTo calculate entropy from a flattened PSSM:\nentropy = get_entropy_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    return_min=True,      # return minimum entropy across positions\n    exclude_zero=True,    # exclude center position\n)\n\nInformation Content\nTo calculate information content per position (higher IC = more conserved):\nic = get_IC(\n    pssm_df=pssm_df,    # 2D PSSM matrix\n    exclude_zero=True,  # exclude center position from calculation\n)\nTo calculate IC from a flattened PSSM:\nic = get_IC_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    exclude_zero=True,    # exclude center position\n)\n\nOverall Specificity\nTo compute an overall specificity score combining max IC and IC variance:\nspec = get_specificity(\n    pssm_df=pssm_df,  # 2D PSSM matrix (excludes position 0 automatically)\n)\nTo compute specificity from a flattened PSSM:\nspec = get_specificity_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n)",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#overview",
    "href": "pssm_core.html#overview",
    "title": "pssm.core",
    "section": "",
    "text": "PSSM Calculation\nTo calculate a position-specific probability matrix (PSSM) from phosphorylation site sequences:\npssm_df = get_prob(\n    data=df,       # input DataFrame, Series, or list of sequences\n    col='site_seq',    # column name containing sequences (if DataFrame)\n)\nAlternatively, use a list of sequences as input\npssm_df = get_prob(\n    data=df['site_seq'],       # input DataFrame, Series, or list of sequences\n)\nTo extract flattened PSSMs for each cluster in a dataset:\ncluster_pssms = get_cluster_pssms(\n    df=data,                    # DataFrame containing sequences and cluster labels\n    cluster_col='kinase_group', # column name for cluster identifiers\n    seq_col='site_seq',         # column name for site sequences\n    id_col='sub_site',          # column for deduplication within clusters (None to skip)\n    count_thr=10,               # minimum sequences required per cluster\n    valid_thr=None,             # minimum fraction of non-zero PSSM values (None to skip)\n    plot=False,                 # whether to plot sequence logos for each cluster\n)\n\nPSSM Transformation\nTo flatten a 2D PSSM into a dictionary (for storage or model input):\nflat_dict = flatten_pssm(\n    pssm_df=pssm_df,     # 2D PSSM with amino acids as rows, positions as columns\n    column_wise=True,    # True for column-major order; False for row-wise (PyTorch)\n)\nTo recover a 2D PSSM from a flattened Series:\npssm_df = recover_pssm(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series with position+aa index\n)\nTo clean the center position and normalize each column to sum to 1:\npssm_norm = clean_zero_normalize(\n    pssm_df=pssm,  # 2D PSSM (zeros out non-s/t/y at position 0, then normalizes)\n)\n\nEntropy Analysis\nTo calculate Shannon entropy per position (lower entropy = more conserved):\nentropy = get_entropy(\n    pssm_df=pssm_df,      # 2D PSSM matrix\n    return_min=False,     # True to return single minimum value\n    exclude_zero=True,    # True to exclude center position from calculation\n    clean_zero=True,      # True to zero out non-s/t/y at position 0\n)\nTo calculate entropy from a flattened PSSM:\nentropy = get_entropy_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    return_min=True,      # return minimum entropy across positions\n    exclude_zero=True,    # exclude center position\n)\n\nInformation Content\nTo calculate information content per position (higher IC = more conserved):\nic = get_IC(\n    pssm_df=pssm_df,    # 2D PSSM matrix\n    exclude_zero=True,  # exclude center position from calculation\n)\nTo calculate IC from a flattened PSSM:\nic = get_IC_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n    exclude_zero=True,    # exclude center position\n)\n\nOverall Specificity\nTo compute an overall specificity score combining max IC and IC variance:\nspec = get_specificity(\n    pssm_df=pssm_df,  # 2D PSSM matrix (excludes position 0 automatically)\n)\nTo compute specificity from a flattened PSSM:\nspec = get_specificity_flat(\n    flat_pssm=flat_pssm,  # flattened PSSM as pd.Series\n)",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#setup",
    "href": "pssm_core.html#setup",
    "title": "pssm.core",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#pssm",
    "href": "pssm_core.html#pssm",
    "title": "pssm.core",
    "section": "PSSM",
    "text": "PSSM\nWe need to compute position-specific probability matrix (PSSM) from a list of aligned site sequences.\nFor each position \\(i\\) (e.g., from \\(-7\\) to \\(+7\\)), the probability of observing amino acid \\(x\\) is:\n\\[\nP_i(x) = \\frac{\\text{count of amino acid } x \\text{ at position } i}{\\text{total counts at position } i}\n\\]\nThe following 23 amino acids are included:\n\nStandard amino acids:\nA, C, D, E, F, G, H, I, K, L, M, N, P, Q, R, S, T, V, W, Y\n\nModified amino acids:\ns, t, y (often used to denote phosphorylated S, T, Y)\n\nThe resulting matrix has: - Rows: Amino acids, - Columns: Sequence positions (centered on the phosphosite), - Values: Probabilities of each amino acid at each position.\n\n\nget_prob\n\ndef get_prob(\n    data:Union, # input data, list or df\n    col:str='site_seq', # column name if input is df\n):\n\nGet the probability matrix of PSSM from phosphorylation site sequences.\n\ndata = Data.get_ks_dataset()\ndata_k = data[data.kinase_uniprot=='P49841'] # CDK1\n\n\nget_prob(data_k, col='site_seq').shape\n\n(23, 41)\n\n\n\n# or\npssm_df = get_prob(data_k['site_seq'].tolist())\npssm_df.tail()\n\n\n\n\n\n\n\nPosition\n-20\n-19\n-18\n-17\n-16\n-15\n-14\n-13\n-12\n-11\n-10\n-9\n-8\n-7\n-6\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nD\n0.059524\n0.065476\n0.044577\n0.080238\n0.051775\n0.048744\n0.047267\n0.054572\n0.064611\n0.048387\n0.052709\n0.058565\n0.049635\n0.049563\n0.071325\n0.069666\n0.058055\n0.063768\n0.037627\n0.062229\n0.000000\n0.034783\n0.046579\n0.056934\n0.030702\n0.084919\n0.064516\n0.056464\n0.051128\n0.072289\n0.059091\n0.054962\n0.033846\n0.063174\n0.053042\n0.054859\n0.063091\n0.055380\n0.054054\n0.056090\n0.053140\n\n\nE\n0.061012\n0.066964\n0.077266\n0.056464\n0.075444\n0.075332\n0.090103\n0.094395\n0.066079\n0.095308\n0.086384\n0.070278\n0.068613\n0.083090\n0.093159\n0.076923\n0.076923\n0.053623\n0.060781\n0.069465\n0.000000\n0.023188\n0.081514\n0.075912\n0.071637\n0.080527\n0.055718\n0.063893\n0.081203\n0.078313\n0.068182\n0.087023\n0.072308\n0.064715\n0.098284\n0.073668\n0.056782\n0.072785\n0.057234\n0.057692\n0.074074\n\n\ns\n0.037202\n0.041667\n0.035661\n0.031204\n0.038462\n0.038405\n0.044313\n0.041298\n0.070485\n0.045455\n0.049780\n0.048316\n0.103650\n0.056851\n0.059680\n0.068215\n0.223512\n0.073913\n0.082489\n0.076700\n0.677279\n0.037681\n0.081514\n0.106569\n0.274854\n0.057101\n0.076246\n0.074294\n0.129323\n0.057229\n0.054545\n0.041221\n0.083077\n0.066256\n0.045242\n0.047022\n0.069401\n0.033228\n0.063593\n0.051282\n0.045089\n\n\nt\n0.019345\n0.010417\n0.022288\n0.019316\n0.019231\n0.016248\n0.016248\n0.011799\n0.014684\n0.020528\n0.033675\n0.036603\n0.024818\n0.017493\n0.024745\n0.039187\n0.065312\n0.030435\n0.050651\n0.026049\n0.285094\n0.021739\n0.029112\n0.037956\n0.089181\n0.033675\n0.033724\n0.040119\n0.039098\n0.031627\n0.050000\n0.025954\n0.030769\n0.015408\n0.020281\n0.010972\n0.014196\n0.015823\n0.015898\n0.014423\n0.014493\n\n\ny\n0.004464\n0.008929\n0.007429\n0.008915\n0.008876\n0.010340\n0.007386\n0.002950\n0.005874\n0.016129\n0.010249\n0.014641\n0.005839\n0.013120\n0.014556\n0.017417\n0.007257\n0.007246\n0.005789\n0.010130\n0.037627\n0.020290\n0.007278\n0.017518\n0.019006\n0.004392\n0.004399\n0.008915\n0.006015\n0.007530\n0.006061\n0.012214\n0.007692\n0.004622\n0.012480\n0.004702\n0.006309\n0.006329\n0.012719\n0.006410\n0.011272\n\n\n\n\n\n\n\n\n\nPSSM with weight score\n\n\n\nget_pssm_weight\n\ndef get_pssm_weight(\n    data:DataFrame, seq_col:str='seq', score_col:str='enrichment', # selected/input ratio OR already-log2\n    to_log2:bool=True, aa_order:str='PGACSTVILMFYWHKRQNDEsty',\n    center:str='pos', # per-position median centering or 'glob' global median centering\n    count_thr:int=5, # threshold to filter out if &lt;count_thr\n    alpha:str | float='auto', # shrinkage strength: value * count / (count + alpha)\n):\n\nPosition-specific amino acid enrichment matrix: PSSM(aa,pos) = mean( log2(score) ) over peptides with aa at pos.",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#transform-pssm",
    "href": "pssm_core.html#transform-pssm",
    "title": "pssm.core",
    "section": "Transform PSSM",
    "text": "Transform PSSM\n\n\nflatten_pssm\n\ndef flatten_pssm(\n    pssm_df, column_wise:bool=True, # if True, column major flatten; else row wise flatten (for pytorch training)\n):\n\nFlatten PSSM dataframe to dictionary\n\nflat_pssm = pd.Series(flatten_pssm(pssm_df))\nflat_pssm\n\n-20P    0.069940\n-20G    0.087798\n          ...   \n20t     0.014493\n20y     0.011272\nLength: 943, dtype: float64\n\n\n\nflat_pssm.reset_index()[0]\n\n0      0.069940\n1      0.087798\n         ...   \n941    0.014493\n942    0.011272\nName: 0, Length: 943, dtype: float64\n\n\n\n\n\nrecover_pssm\n\ndef recover_pssm(\n    flat_pssm:Series\n):\n\nRecover 2D PSSM from flattened PSSM Series.\n\nout = recover_pssm(flat_pssm)\nout\n\n\n\n\n\n\n\nPosition\n-20\n-19\n-18\n-17\n-16\n-15\n-14\n-13\n-12\n-11\n-10\n-9\n-8\n-7\n-6\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.069940\n0.077381\n0.062407\n0.084695\n0.082840\n0.072378\n0.087149\n0.081121\n0.077827\n0.071848\n0.101025\n0.074671\n0.084672\n0.106414\n0.112082\n0.094340\n0.079826\n0.133333\n0.150507\n0.131693\n0.000000\n0.420290\n0.141194\n0.094891\n0.049708\n0.187408\n0.082111\n0.077266\n0.064662\n0.106928\n0.074242\n0.077863\n0.078462\n0.070878\n0.095164\n0.092476\n0.074132\n0.090190\n0.071542\n0.099359\n0.078905\n\n\nG\n0.087798\n0.087798\n0.069837\n0.065379\n0.076923\n0.054653\n0.088626\n0.095870\n0.064611\n0.068915\n0.070278\n0.087848\n0.058394\n0.065598\n0.066958\n0.063861\n0.068215\n0.101449\n0.076700\n0.105644\n0.000000\n0.075362\n0.065502\n0.086131\n0.046784\n0.054173\n0.060117\n0.083210\n0.084211\n0.058735\n0.063636\n0.083969\n0.084615\n0.075501\n0.076443\n0.081505\n0.067823\n0.060127\n0.077901\n0.088141\n0.066023\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nt\n0.019345\n0.010417\n0.022288\n0.019316\n0.019231\n0.016248\n0.016248\n0.011799\n0.014684\n0.020528\n0.033675\n0.036603\n0.024818\n0.017493\n0.024745\n0.039187\n0.065312\n0.030435\n0.050651\n0.026049\n0.285094\n0.021739\n0.029112\n0.037956\n0.089181\n0.033675\n0.033724\n0.040119\n0.039098\n0.031627\n0.050000\n0.025954\n0.030769\n0.015408\n0.020281\n0.010972\n0.014196\n0.015823\n0.015898\n0.014423\n0.014493\n\n\ny\n0.004464\n0.008929\n0.007429\n0.008915\n0.008876\n0.010340\n0.007386\n0.002950\n0.005874\n0.016129\n0.010249\n0.014641\n0.005839\n0.013120\n0.014556\n0.017417\n0.007257\n0.007246\n0.005789\n0.010130\n0.037627\n0.020290\n0.007278\n0.017518\n0.019006\n0.004392\n0.004399\n0.008915\n0.006015\n0.007530\n0.006061\n0.012214\n0.007692\n0.004622\n0.012480\n0.004702\n0.006309\n0.006329\n0.012719\n0.006410\n0.011272\n\n\n\n\n23 rows × 41 columns\n\n\n\n\nout.equals(pssm_df)\n\nTrue\n\n\nOr recover from PSPA data\n\npspa = Data.get_pspa()\n\n\npssm=recover_pssm(pspa.loc['AAK1'].dropna())\npssm\n\n\n\n\n\n\n\nPosition\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.0720\n0.0534\n0.1084\n0.0226\n0.1136\n0.0\n0.0463\n0.0527\n0.0681\n0.0628\n\n\nG\n0.0245\n0.0642\n0.0512\n0.0283\n0.0706\n0.0\n0.7216\n0.0749\n0.0923\n0.0702\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nt\n0.0201\n0.0332\n0.0303\n0.0209\n0.0121\n1.0\n0.0123\n0.0409\n0.0335\n0.0251\n\n\ny\n0.0611\n0.0339\n0.0274\n0.0486\n0.0178\n0.0\n0.0100\n0.0410\n0.0359\n0.0270\n\n\n\n\n23 rows × 10 columns\n\n\n\nPSPA is not scaled per position.\nSo we need to remove the redundant copy in zero position (leave s/t/y only) and scaled to 1 per position.\n\npssm.index[pssm.index.isin(['s','t','y'])]\n\nIndex(['s', 't', 'y'], dtype='object', name='aa')\n\n\n\n_clean_zero(pssm)\n\n\n\n\n\n\n\nPosition\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.0720\n0.0534\n0.1084\n0.0226\n0.1136\n0.0\n0.0463\n0.0527\n0.0681\n0.0628\n\n\nG\n0.0245\n0.0642\n0.0512\n0.0283\n0.0706\n0.0\n0.7216\n0.0749\n0.0923\n0.0702\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nt\n0.0201\n0.0332\n0.0303\n0.0209\n0.0121\n1.0\n0.0123\n0.0409\n0.0335\n0.0251\n\n\ny\n0.0611\n0.0339\n0.0274\n0.0486\n0.0178\n0.0\n0.0100\n0.0410\n0.0359\n0.0270\n\n\n\n\n23 rows × 10 columns\n\n\n\n\n\n\nclean_zero_normalize\n\ndef clean_zero_normalize(\n    pssm_df\n):\n\nZero out non-last three values in position 0 (keep only s,t,y values at center), and normalize per position\nThis function applies phosphosite-specific cleaning and normalization to a PSSM.\nAt the center position (\\(i = 0\\)), only the last three rows of the matrix — corresponding to phosphorylatable residues s, t, and y — are retained. All other amino acid values at position 0 are set to 0.\nAfter masking, the matrix is column-normalized to ensure the probabilities at each position sum to 1:\n\\[\nP_i(x) = \\frac{P_i(x)}{\\sum_{x'} P_i(x')}\n\\]\n\nclean_zero_normalize(pssm)\n\n\n\n\n\n\n\nPosition\n-5\n-4\n-3\n-2\n-1\n0\n1\n2\n3\n4\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nP\n0.058446\n0.041715\n0.086100\n0.017935\n0.096068\n0.000000\n0.042649\n0.040482\n0.052640\n0.050260\n\n\nG\n0.019888\n0.050152\n0.040667\n0.022459\n0.059704\n0.000000\n0.664702\n0.057536\n0.071346\n0.056182\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nt\n0.016316\n0.025935\n0.024067\n0.016586\n0.010233\n0.908018\n0.011330\n0.031418\n0.025895\n0.020088\n\n\ny\n0.049598\n0.026482\n0.021763\n0.038568\n0.015053\n0.000000\n0.009211\n0.031495\n0.027750\n0.021609\n\n\n\n\n23 rows × 10 columns",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#pssms-of-clusters",
    "href": "pssm_core.html#pssms-of-clusters",
    "title": "pssm.core",
    "section": "PSSMs of clusters",
    "text": "PSSMs of clusters\n\n\nget_cluster_pssms\n\ndef get_cluster_pssms(\n    df, cluster_col, seq_col:str='site_seq', id_col:str='sub_site',\n    count_thr:int=10, # if less than the count threshold, not include in the return\n    valid_thr:NoneType=None, # percentage of not-nan values in pssm\n    plot:bool=False\n):\n\nExtract motifs from clusters in a dataframe\n\nget_cluster_pssms(data,'kinase_group')\n\n\n  0%|          | 0/10 [00:00&lt;?, ?it/s]\n 10%|█         | 1/10 [00:00&lt;00:01,  5.11it/s]\n 20%|██        | 2/10 [00:00&lt;00:01,  5.45it/s]\n 30%|███       | 3/10 [00:00&lt;00:01,  5.62it/s]\n 40%|████      | 4/10 [00:00&lt;00:00,  6.10it/s]\n 50%|█████     | 5/10 [00:00&lt;00:00,  7.04it/s]\n 70%|███████   | 7/10 [00:00&lt;00:00,  8.60it/s]\n 90%|█████████ | 9/10 [00:01&lt;00:00, 10.54it/s]\n100%|██████████| 10/10 [00:01&lt;00:00,  8.72it/s]\n\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nTK\n0.056754\n0.069067\n0.070474\n0.016886\n0.045028\n0.039400\n0.058630\n0.049836\n0.083255\n0.024038\n0.032716\n0.023335\n0.007974\n0.021107\n0.069184\n0.056168\n0.045966\n0.036585\n0.058865\n0.081027\n0.024508\n0.011843\n0.017355\n0.057915\n0.067158\n0.073125\n0.016731\n0.045396\n0.037440\n0.053001\n0.049959\n0.087633\n0.023751\n0.031356\n0.018018\n0.009594\n0.022230\n0.074529\n0.063999\n0.043173\n0.041652\n0.060840\n0.073359\n0.025389\n0.010881\n0.012870\n0.058123\n0.067810\n0.062792\n0.014006\n...\n0.080097\n0.027670\n0.012621\n0.012743\n0.058601\n0.065424\n0.065302\n0.014864\n0.045078\n0.038986\n0.056408\n0.048124\n0.087354\n0.018884\n0.042276\n0.017178\n0.008894\n0.018519\n0.073830\n0.061769\n0.047149\n0.040327\n0.059698\n0.078216\n0.028509\n0.010599\n0.014011\n0.066015\n0.072738\n0.065037\n0.013692\n0.048900\n0.037897\n0.054523\n0.050122\n0.077262\n0.023227\n0.039364\n0.018337\n0.008435\n0.019071\n0.070905\n0.059413\n0.040465\n0.038509\n0.056357\n0.083496\n0.025917\n0.012836\n0.017482\n\n\nCMGC\n0.080589\n0.070340\n0.083792\n0.013709\n0.050865\n0.035874\n0.053812\n0.035874\n0.074824\n0.022037\n0.029468\n0.015247\n0.007559\n0.020884\n0.069058\n0.057143\n0.044331\n0.032031\n0.053299\n0.078668\n0.042921\n0.020115\n0.007559\n0.079718\n0.075496\n0.072937\n0.012028\n0.058733\n0.035061\n0.053871\n0.032885\n0.074472\n0.021753\n0.026104\n0.013436\n0.007806\n0.021241\n0.064491\n0.063596\n0.046449\n0.037492\n0.055534\n0.080614\n0.042482\n0.018298\n0.005502\n0.074292\n0.068930\n0.074419\n0.013786\n...\n0.084768\n0.052185\n0.016556\n0.005960\n0.074212\n0.073813\n0.074212\n0.011970\n0.053731\n0.034047\n0.050805\n0.031520\n0.074345\n0.017423\n0.028195\n0.015029\n0.010374\n0.020215\n0.070887\n0.063173\n0.045884\n0.033914\n0.056124\n0.086980\n0.048278\n0.018619\n0.006251\n0.082465\n0.066961\n0.074980\n0.012563\n0.050789\n0.034215\n0.050521\n0.038626\n0.079925\n0.019246\n0.028869\n0.016840\n0.006816\n0.023924\n0.072307\n0.060011\n0.046111\n0.035285\n0.057070\n0.074044\n0.043972\n0.018043\n0.006415\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nCK1\n0.057860\n0.076419\n0.076965\n0.014192\n0.039847\n0.037118\n0.063865\n0.052402\n0.070961\n0.017467\n0.027293\n0.012555\n0.014192\n0.024017\n0.079694\n0.050764\n0.033297\n0.035480\n0.058406\n0.086790\n0.038210\n0.015830\n0.016376\n0.061069\n0.070883\n0.069793\n0.007634\n0.033806\n0.032715\n0.053435\n0.043075\n0.087786\n0.023991\n0.022901\n0.016903\n0.010905\n0.020720\n0.076881\n0.059978\n0.056161\n0.037077\n0.061069\n0.087786\n0.041439\n0.017448\n0.006543\n0.050000\n0.067935\n0.073913\n0.010870\n...\n0.084629\n0.041451\n0.015544\n0.012090\n0.053148\n0.068746\n0.069324\n0.012709\n0.036973\n0.021953\n0.047371\n0.042172\n0.082034\n0.017909\n0.030040\n0.017909\n0.020220\n0.019064\n0.095321\n0.047371\n0.041594\n0.034084\n0.065280\n0.098209\n0.041594\n0.021953\n0.015020\n0.051865\n0.074592\n0.088578\n0.015152\n0.039627\n0.034382\n0.055361\n0.039627\n0.074592\n0.020979\n0.034382\n0.020396\n0.008741\n0.026224\n0.079837\n0.046620\n0.038462\n0.043124\n0.067599\n0.087995\n0.027972\n0.012238\n0.011655\n\n\nAtypical\n0.071895\n0.065359\n0.063492\n0.014939\n0.053221\n0.045752\n0.058824\n0.050420\n0.085901\n0.020542\n0.017740\n0.020542\n0.005602\n0.034547\n0.049486\n0.057890\n0.040149\n0.034547\n0.059757\n0.078431\n0.041083\n0.025210\n0.004669\n0.042870\n0.052190\n0.074557\n0.013979\n0.063374\n0.036347\n0.054986\n0.031687\n0.089469\n0.027959\n0.036347\n0.015843\n0.010252\n0.026095\n0.074557\n0.056850\n0.054054\n0.034483\n0.063374\n0.068966\n0.046598\n0.018639\n0.006524\n0.051068\n0.063138\n0.072423\n0.012071\n...\n0.072175\n0.047483\n0.013295\n0.015195\n0.059829\n0.081671\n0.066477\n0.017094\n0.047483\n0.044634\n0.050332\n0.034188\n0.063628\n0.010446\n0.037037\n0.016144\n0.006648\n0.027540\n0.047483\n0.055081\n0.057930\n0.043685\n0.059829\n0.091168\n0.039886\n0.027540\n0.014245\n0.077290\n0.060115\n0.062977\n0.015267\n0.055344\n0.029580\n0.065840\n0.026718\n0.092557\n0.017176\n0.039122\n0.023855\n0.009542\n0.016221\n0.046756\n0.054389\n0.050573\n0.055344\n0.062977\n0.068702\n0.040076\n0.020992\n0.008588\n\n\n\n\n10 rows × 943 columns",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#entropy",
    "href": "pssm_core.html#entropy",
    "title": "pssm.core",
    "section": "Entropy",
    "text": "Entropy\n\n\nget_entropy\n\ndef get_entropy(\n    pssm_df, # a dataframe of pssm with index as aa and column as position\n    return_min:bool=False, # return min entropy as a single value or return all entropy as a pd.series\n    exclude_zero:bool=False, # exclude the column of 0 (center position) in the entropy calculation\n    clean_zero:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nCalculate entropy per position of a PSSM surrounding 0. The less entropy the more information it contains.\nLet \\(P_i(x)\\) be the probability of amino acid \\(x\\) at position \\(i\\) in the PSSM, with \\(i \\in \\{-k, \\dots, -1, 0, +1, \\dots, +k\\}\\). The entropy at each position \\(i\\) is defined as:\n\\[\nH_i = - \\sum_{x} P_i(x) \\log_2 \\left( P_i(x) + \\varepsilon \\right)\n\\]\nwhere \\(\\varepsilon = 10^{-8}\\) is a small constant added for numerical stability.\nIf exclude_zero=True, the central position \\(i = 0\\) is omitted from the entropy calculation.\nIf clean_zero=True, all values at position \\(i = 0\\) are zeroed out except for amino acids Serine (S), Threonine (T), and Tyrosine (Y), typically the only possible phospho-acceptors in kinase motif analysis.\nIf return_min=True, the function returns the minimum entropy across all positions:\n\\[\nH_{\\text{spec}} = \\min_i H_i\n\\]\nOtherwise, the function returns the full vector \\(\\{H_i\\}\\) for each position \\(i\\), reflecting how much information (or uncertainty) is contained at each position in the motif.\n\n# get entropy per position\nget_entropy(pssm_df).sort_values()\n\nPosition\n 0     1.074964\n 1     3.346861\n         ...   \n-9     4.297737\n-12    4.302189\nLength: 41, dtype: float64\n\n\n\n# calculate minimum entropy of surrouding positions\nget_entropy(pssm_df,return_min=True,exclude_zero=True)\n\n3.3468606104695913\n\n\n\n\n\nget_entropy_flat\n\ndef get_entropy_flat(\n    flat_pssm:Series,\n    return_min:bool=False, # return min entropy as a single value or return all entropy as a pd.series\n    exclude_zero:bool=False, # exclude the column of 0 (center position) in the entropy calculation\n    clean_zero:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nCalculate entropy per position of a flat PSSM surrounding 0\n\nget_entropy_flat(flat_pssm).sort_values()\n\nPosition\n 0     1.074964\n 1     3.346861\n         ...   \n-9     4.297737\n-12    4.302189\nLength: 41, dtype: float64\n\n\n\nget_entropy_flat(flat_pssm,return_min=True,exclude_zero=True)\n\n3.3468606104695913\n\n\n\n# test equal\n(get_entropy_flat(flat_pssm).round(5) == get_entropy(pssm_df).round(5)).value_counts()\n\nTrue    41\nName: count, dtype: int64",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#information-content",
    "href": "pssm_core.html#information-content",
    "title": "pssm.core",
    "section": "Information Content",
    "text": "Information Content\n\n\nget_IC\n\ndef get_IC(\n    pssm_df, return_min:bool=False, # return min entropy as a single value or return all entropy as a pd.series\n    exclude_zero:bool=False, # exclude the column of 0 (center position) in the entropy calculation\n    clean_zero:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nCalculate the information content (bits) from a frequency matrix, using log2(3) for the middle position and log2(len(pssm_df)) for others. The higher the more information it contains.\nLet \\(P_i(x)\\) be the frequency (probability) of amino acid \\(x\\) at position \\(i\\) in the PSSM. The standard information content (IC) at position \\(i\\) is defined as:\n\\[\n\\mathrm{IC}_i = \\max H_i - H_i\n\\]\nwhich is:\n\\[\n\\mathrm{IC}_i = \\log_2(N) - H_i\n\\]\nwhere \\(N\\) is the number of possible amino acids (i.e., \\(N = \\text{len}(P_i)\\)).\nAt the center position (\\(i = 0\\)), only three amino acids (S, T, Y) are relevant, so the maximum entropy at each position is defined as:\n\\[\n\\max H_i =\n\\begin{cases}\n\\log_2(3) & \\text{if } i = 0 \\\\\n\\log_2(N) & \\text{otherwise}\n\\end{cases}\n\\]\n\n# the higher the more conserved\nget_IC(pssm_df,exclude_zero=True).sort_values()\n\nPosition\n-12    0.221373\n-9     0.225825\n         ...   \n 4     0.717760\n 1     1.176701\nLength: 40, dtype: float64\n\n\nCheck all zero cases:\n\npssm_df2=pssm_df.copy()\n\n\npssm_df2[-20]=0\n\n\nget_entropy(pssm_df2,exclude_zero=True).sort_values()\n\nPosition\n-20    0.000000\n 1     3.346861\n         ...   \n-9     4.297737\n-12    4.302189\nLength: 40, dtype: float64\n\n\n\n\n\nget_IC_flat\n\ndef get_IC_flat(\n    flat_pssm:Series,\n    return_min:bool=False, # return min entropy as a single value or return all entropy as a pd.series\n    exclude_zero:bool=False, # exclude the column of 0 (center position) in the entropy calculation\n    clean_zero:bool=True, # if true, zero out non-last three values in position 0 (keep only s,t,y values at center)\n):\n\nCalculate the information content (bits) from a flattened pssm pd.Series, using log2(3) for the middle position and log2(len(pssm_df)) for others.\n\nget_IC_flat(flat_pssm,exclude_zero=True).sort_values()\n\nPosition\n-12    0.221373\n-9     0.225825\n         ...   \n 4     0.717760\n 1     1.176701\nLength: 40, dtype: float64\n\n\n\n(get_IC_flat(flat_pssm).round(5) == get_IC(pssm_df).round(5)).value_counts()\n\nTrue    41\nName: count, dtype: int64",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "pssm_core.html#overall-specificity",
    "href": "pssm_core.html#overall-specificity",
    "title": "pssm.core",
    "section": "Overall specificity",
    "text": "Overall specificity\n\n\nget_specificity\n\ndef get_specificity(\n    pssm_df\n):\n\nGet specificity score of a pssm, excluding zero position.\nWe evaluated the overall specificity of a PSSM by combining two metrics: the maximum IC across surrounding positions and the variance of IC values:\n\\[\n\\text{Specificity Score} = 2 \\times \\max(\\text{IC}) + \\mathrm{Var}(\\text{IC})\n\\]\n\nget_specificity(pssm_df)\n\n2.381609408364424\n\n\n\n\n\nget_specificity_flat\n\ndef get_specificity_flat(\n    flat_pssm\n):\n\nGet specificity score of a pssm, excluding zero position.\n\nget_specificity_flat(flat_pssm)\n\n2.381609408364424",
    "crumbs": [
      "Modules",
      "pssm.core"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "KATLAS",
    "section": "",
    "text": "KATLAS is a repository containing python tools to predict kinases given a substrate sequence. It also contains datasets of kinase substrate specificities and human phosphoproteomics.\nReferences: Please cite the appropriate papers if KATLAS is helpful to your research.",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#reproduce-datasets-figures",
    "href": "index.html#reproduce-datasets-figures",
    "title": "KATLAS",
    "section": "Reproduce datasets & figures",
    "text": "Reproduce datasets & figures\nFollow the instructions in katlas_raw: https://github.com/sky1ove/katlas_raw",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#web-applications",
    "href": "index.html#web-applications",
    "title": "KATLAS",
    "section": "Web applications",
    "text": "Web applications\nUsers can now run the analysis directly on the web without needing to code.\nCheck out our latest web platform: kinase-atlas.com",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#install",
    "href": "index.html#install",
    "title": "KATLAS",
    "section": "Install",
    "text": "Install\nUV:\nuv add -U python-katlas\npip:\npip install -U python-katlas\nIf using machine-learning related modules, need to install development verison: pip install -U \"python-katlas[dev]\"",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#import",
    "href": "index.html#import",
    "title": "KATLAS",
    "section": "Import",
    "text": "Import\n\nfrom katlas.common import *",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#quick-start-1",
    "href": "index.html#quick-start-1",
    "title": "KATLAS",
    "section": "Quick start",
    "text": "Quick start\n\nSite scoring\nCDDM, all capital\n\npredict_kinase('AAAAAAASGAGSDN',**Params(\"CDDM_upper\"))\n\nconsidering string: ['-7A', '-6A', '-5A', '-4A', '-3A', '-2A', '-1A', '0S', '1G', '2A', '3G', '4S', '5D', '6N']\n\n\nGCN2      4.556\nMPSK1     4.425\nMEKK2     4.253\nWNK3      4.213\nWNK1      4.064\n          ...  \nPDK1    -25.077\nPDHK3   -25.346\nCLK2    -27.251\nROR2    -27.582\nDDR1    -53.581\nLength: 328, dtype: float64\n\n\nCDDM, with lower case indicating phosphorylation status\n\npredict_kinase('AAAAAAAsGGAGsDN',**Params(\"CDDM\"))\n\nconsidering string: ['-7A', '-6A', '-5A', '-4A', '-3A', '-2A', '-1A', '0s', '1G', '2G', '3A', '4G', '5s', '6D', '7N']\n\n\nROR1       8.355\nWNK1       4.907\nWNK2       4.782\nERK5       4.466\nRIPK2      4.045\n           ...  \nDDR1     -29.393\nTNNI3K   -29.884\nCHAK1    -31.775\nVRK1     -45.287\nBRAF     -49.403\nLength: 328, dtype: float64\n\n\nPSPA, with lower case indicating phosphorylation status\n\npredict_kinase('AEEKEyHsEGG',**Params(\"PSPA\"))\n\nconsidering string: ['-5A', '-4E', '-3E', '-2K', '-1E', '0y', '1H', '2s', '3E', '4G', '5G']\n\n\nkinase\nEGFR          4.013\nFGFR4         3.568\nZAP70         3.412\nCSK           3.241\nSYK           3.209\n              ...  \nJAK1         -3.837\nDDR2         -4.421\nTNK2         -4.534\nTNNI3K_TYR   -4.651\nTNK1         -5.320\nLength: 93, dtype: float64\n\n\nTo replicate the results from The Kinase Library (PSPA)\nCheck this link: The Kinase Library, and use log2(score) to rank, it shows same results with the below (with slight differences due to rounding).\n\nout = predict_kinase('AEEKEyHSEGG',**Params(\"PSPA\"))\nout\n\nconsidering string: ['-5A', '-4E', '-3E', '-2K', '-1E', '0y', '1H', '2S', '3E', '4G', '5G']\n\n\nkinase\nEGFR     3.181\nFGFR4    2.390\nCSK      2.308\nZAP70    2.068\nSYK      1.998\n         ...  \nEPHA1   -3.501\nFES     -3.699\nTNK1    -4.269\nTNK2    -4.577\nDDR2    -4.920\nLength: 93, dtype: float64\n\n\n\nSo far The kinase Library considers all tyr sequences in capital regardless of whether or not they contain lower cases, which is a small bug and should be fixed soon.\nKinase with “_TYR” indicates it is a dual specificity kinase tested in PSPA tyrosine setting, which has not been included in kinase-library yet.\n\nWe can also calculate the percentile score using a referenced score sheet.\n\n# Percentile reference sheet\ny_pct = Data.get_pspa_tyr_pct()\n\n\nget_pct('AEEKEyHSEGG',pct_ref = y_pct,**Params(\"PSPA_y\"))\n\nconsidering string: ['-5A', '-4E', '-3E', '-2K', '-1E', '0Y', '1H', '2S', '3E', '4G', '5G']\n\n\n\n\n\n\n\n\n\nlog2(score)\npercentile\n\n\n\n\nEGFR\n3.181\n96.787423\n\n\nFGFR4\n2.390\n94.012303\n\n\nCSK\n2.308\n95.201640\n\n\nZAP70\n2.068\n88.380041\n\n\nSYK\n1.998\n85.522898\n\n\n...\n...\n...\n\n\nEPHA1\n-3.501\n12.139440\n\n\nFES\n-3.699\n21.216678\n\n\nTNK1\n-4.269\n5.481887\n\n\nTNK2\n-4.577\n2.050581\n\n\nDDR2\n-4.920\n10.403281\n\n\n\n\n93 rows × 2 columns\n\n\n\n\n\nSite scoring in a df\nLoad your csv:\n\n# df = pd.read_csv('your_file.csv')\n\nOr load a demo df\n\n# Load a demo df with phosphorylation sites\ndf = Data.get_ochoa_site().head()\ndf.iloc[:,-2:]\n\n\n\n\n\n\n\n\nsite_seq\ngene_site\n\n\n\n\n0\nVDDEKGDSNDDYDSA\nA0A075B6Q4_S24\n\n\n1\nYDSAGLLSDEDCMSV\nA0A075B6Q4_S35\n\n\n2\nIADHLFWSEETKSRF\nA0A075B6Q4_S57\n\n\n3\nKSRFTEYSMTSSVMR\nA0A075B6Q4_S68\n\n\n4\nFTEYSMTSSVMRRNE\nA0A075B6Q4_S71\n\n\n\n\n\n\n\nSet the column name and param to calculate\nHere we choose param_CDDM_upper, as the sequences in the demo df are all in capital. You can also choose other params.\n\nresults = predict_kinase_df(df,'site_seq',**Params(\"CDDM_upper\"))\nresults\n\ninput dataframe has a length 5\nPreprocessing\nFinish preprocessing\nMerging reference\nFinish merging\n\n\n\n\n\n\n\n\n\nSRC\nEPHA3\nFES\nNTRK3\nALK\nABL1\nFLT3\nEPHA8\nEPHB2\nEPHB1\n...\nVRK1\nPKMYT1\nGRK3\nCAMK1B\nCDC7\nSMMLCK\nROR1\nGAK\nMAST2\nBRAF\n\n\n\n\n0\n-2.440640\n-0.818753\n-1.663990\n-0.738991\n-2.047628\n-3.602344\n-3.200998\n-0.935176\n-1.388444\n-1.859450\n...\n-17.103237\n-113.698143\n-16.848783\n-41.520172\n-41.646187\n1.284159\n-26.566362\n-69.165062\n-17.706400\n-87.763214\n\n\n1\n-3.838486\n-2.735969\n-2.533986\n-2.150399\n-3.792498\n-4.725527\n-5.711791\n-4.534240\n-3.148449\n-2.511518\n...\n-67.889053\n-68.652641\n-45.833855\n-64.171600\n-39.465572\n-65.061722\n-109.561707\n-85.911224\n-60.105064\n-63.889122\n\n\n2\n-2.610423\n-2.370090\n-3.235637\n-1.508413\n-2.571347\n-3.740941\n-3.025596\n-3.373504\n-2.776297\n-3.060740\n...\n-15.798462\n-45.905319\n-61.440742\n-67.695694\n-55.047962\n-42.135216\n-38.501572\n-62.624382\n-56.119389\n-107.060989\n\n\n3\n-5.180541\n-4.201880\n-5.766463\n-3.038421\n-3.836897\n-4.249900\n-5.029885\n-5.411311\n-4.713308\n-4.827825\n...\n-96.978317\n-83.419777\n-22.559393\n-110.611588\n-63.283070\n-37.240440\n-24.497492\n-112.878151\n-43.538158\n-60.348518\n\n\n4\n-2.844254\n-3.322700\n-3.681745\n-1.766435\n-2.666579\n-3.748774\n-4.083619\n-3.912834\n-3.724181\n-3.948160\n...\n-35.824612\n-87.983566\n-83.312317\n-107.162407\n-61.478374\n-85.793571\n-43.738819\n-47.004211\n-42.281624\n-59.518513\n\n\n\n\n5 rows × 328 columns\n\n\n\n\nresults.iloc[0].sort_values(ascending=False)\n\nTLK2        8.264621\nGCN2        8.101542\nTLK1        7.693897\nHRI         6.691402\nPLK3        6.579368\n             ...    \nNIK       -64.605148\nSRPK2     -67.300667\nGAK       -69.165062\nBRAF      -87.763214\nPKMYT1   -113.698143\nName: 0, Length: 328, dtype: float32",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#dataset",
    "href": "index.html#dataset",
    "title": "KATLAS",
    "section": "Dataset",
    "text": "Dataset\nBesides calculating sequence scores, we also provides multiple datasets of phosphorylation sites.\n\nCPTAC pan-cancer phosphoproteomics\n\ndf = Data.get_cptac_ensembl_site()\ndf.head(3)\n\n\n\n\n\n\n\n\ngene\nsite\nsite_seq\nprotein\ngene_name\ngene_site\nprotein_site\n\n\n\n\n0\nENSG00000003056.8\nS267\nDDQLGEESEERDDHL\nENSP00000000412.3\nM6PR\nM6PR_S267\nENSP00000000412_S267\n\n\n1\nENSG00000003056.8\nS267\nDDQLGEESEERDDHL\nENSP00000440488.2\nM6PR\nM6PR_S267\nENSP00000440488_S267\n\n\n2\nENSG00000048028.11\nS1053\nPPTIRPNSPYDLCSR\nENSP00000003302.4\nUSP28\nUSP28_S1053\nENSP00000003302_S1053\n\n\n\n\n\n\n\n\n\nOchoa et al. human phosphoproteome\n\ndf = Data.get_ochoa_site()\ndf.head(3)\n\n\n\n\n\n\n\n\nuniprot\nposition\nresidue\nis_disopred\ndisopred_score\nlog10_hotspot_pval_min\nisHotspot\nuniprot_position\nfunctional_score\ncurrent_uniprot\nname\ngene\nSequence\nis_valid\nsite_seq\ngene_site\n\n\n\n\n0\nA0A075B6Q4\n24\nS\n1.0\n0.91\n6.839384\n1.0\nA0A075B6Q4_24\n0.149257\nA0A075B6Q4\nA0A075B6Q4_HUMAN\nNone\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nTrue\nVDDEKGDSNDDYDSA\nA0A075B6Q4_S24\n\n\n1\nA0A075B6Q4\n35\nS\n1.0\n0.87\n9.192622\n0.0\nA0A075B6Q4_35\n0.136966\nA0A075B6Q4\nA0A075B6Q4_HUMAN\nNone\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nTrue\nYDSAGLLSDEDCMSV\nA0A075B6Q4_S35\n\n\n2\nA0A075B6Q4\n57\nS\n0.0\n0.28\n0.818834\n0.0\nA0A075B6Q4_57\n0.125364\nA0A075B6Q4\nA0A075B6Q4_HUMAN\nNone\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nTrue\nIADHLFWSEETKSRF\nA0A075B6Q4_S57\n\n\n\n\n\n\n\n\n\nPhosphoSitePlus human phosphorylation site\n\ndf = Data.get_psp_human_site()\ndf.head(3)\n\n\n\n\n\n\n\n\ngene\nprotein\nuniprot\nsite\ngene_site\nSITE_GRP_ID\nspecies\nsite_seq\nLT_LIT\nMS_LIT\nMS_CST\nCST_CAT#\nAmbiguous_Site\n\n\n\n\n0\nYWHAB\n14-3-3 beta\nP31946\nT2\nYWHAB_T2\n15718712\nhuman\n______MtMDksELV\nNaN\n3.0\n1.0\nNone\n0\n\n\n1\nYWHAB\n14-3-3 beta\nP31946\nS6\nYWHAB_S6\n15718709\nhuman\n__MtMDksELVQkAk\nNaN\n8.0\nNaN\nNone\n0\n\n\n2\nYWHAB\n14-3-3 beta\nP31946\nY21\nYWHAB_Y21\n3426383\nhuman\nLAEQAERyDDMAAAM\nNaN\nNaN\n4.0\nNone\n0\n\n\n\n\n\n\n\n\n\nUnique sites of combined Ochoa & PhosphoSitePlus\n\ndf = Data.get_combine_site_psp_ochoa()\ndf.head(3)\n\n\n\n\n\n\n\n\nuniprot\ngene\nsite\nsite_seq\nsource\nAM_pathogenicity\nCDDM_upper\nCDDM_max_score\n\n\n\n\n0\nA0A024R4G9\nC19orf48\nS20\nITGSRLLSMVPGPAR\npsp\nNaN\nPRKX,AKT1,PKG1,P90RSK,HIPK4,AKT3,HIPK1,PKACB,H...\n2.407041\n\n\n1\nA0A075B6Q4\nNone\nS24\nVDDEKGDSNDDYDSA\nochoa\nNaN\nCK2A2,CK2A1,GRK7,GRK5,CK1G1,CK1A,IKKA,CK1G2,CA...\n2.295654\n\n\n2\nA0A075B6Q4\nNone\nS35\nYDSAGLLSDEDCMSV\nochoa\nNaN\nCK2A2,CK2A1,IKKA,ATM,IKKB,CAMK1D,MARK2,GRK7,IK...\n2.488683",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "index.html#phosphorylation-site-sequence-example",
    "href": "index.html#phosphorylation-site-sequence-example",
    "title": "KATLAS",
    "section": "Phosphorylation site sequence example",
    "text": "Phosphorylation site sequence example\nAll capital - 15 length (-7 to +7)\n\nQSEEEKLSPSPTTED\nTLQHVPDYRQNVYIP\nTMGLSARyGPQFTLQ\n\nAll capital - 10 length (-5 to +4)\n\nSRDPHYQDPH\nLDNPDyQQDF\nAAAAAsGGAG\n\nWith lowercase - (-7 to +7)\n\nQsEEEKLsPsPTTED\nTLQHVPDyRQNVYIP\nTMGLsARyGPQFTLQ\n\nWith lowercase - (-5 to +4)\n\nsRDPHyQDPH\nLDNPDyQQDF\nAAAAAsGGAG",
    "crumbs": [
      "Get Started"
    ]
  },
  {
    "objectID": "scoring.html",
    "href": "scoring.html",
    "title": "Scoring",
    "section": "",
    "text": "This module provides functions to calculate kinase scores based on substrate sequences using Position-Specific Scoring Matrices (PSSMs) from either PSPA data or kinase-substrate datasets.\n\nUtility Functions\nThese helper functions prepare and parse phosphorylation site sequences.\ncut_seq — Extracts a substring from a sequence based on positions relative to its center (the phosphorylation site).\ncut_seq(\n    input_string='AAkUuPSFSTtH',  # site sequence (15-mer or similar)\n    min_position=-5,              # start position relative to center\n    max_position=4,               # end position relative to center\n)\n# Returns: 'AkUuPSFSTt'\nSTY2sty — Converts uppercase S/T/Y (unphosphorylated) to lowercase s/t/y (phosphorylated) in a sequence.\nSTY2sty(\n    input_string='AAkUuPSFSTtH',  # sequence with uppercase STY\n)\n# Returns: 'AAkUuPsFsttH'\nget_dict — Parses a site sequence into position-annotated amino acid keys (e.g., -3P, 0s, 1Q) for PSSM lookup.\nget_dict(\n    input_string='PSVEPPLsQETFSDL',  # 15-mer phosphosite sequence\n)\n# Returns: ['-7P', '-6S', '-5V', ..., '0s', '1Q', ..., '7L']\n\nScoring Functions\nThese functions aggregate PSSM values across positions to produce a single kinase score.\nsumup — Simple summation of PSSM values at each position. Used with log-odds (LO) matrices.\nsumup(\n    values=[0.5, 1.2, -0.3, 0.8],  # PSSM values at each position\n    kinase='ATM',                  # kinase name (unused, for API consistency)\n)\n# Returns: sum of values\nmultiply — Log-space multiplication of PSSM probabilities, normalized by number of possible amino acids. Used with probability matrices.\nmultiply(\n    values=[0.04, 0.05, 0.03],  # probability values from PSSM\n    kinase='ATM',              # kinase name (unused)\n    num_aa=23,                 # number of amino acids (23 for CDDM, 20 for uppercase)\n)\n# Returns: log2(product) + normalization factor\nmultiply_pspa — Like multiply, but uses a kinase-specific normalization factor from the PSPA random amino acid library.\nmultiply_pspa(\n    values=[1, 2, 3, 4, 5],  # PSSM probability values\n    kinase='PDHK1',          # kinase name (determines normalization)\n)\n# Returns: np.float64(22.907...)\n\nSingle Sequence Prediction\npredict_kinase — Scores all kinases against a single phosphosite sequence. Returns a sorted Series of kinase scores.\npredict_kinase(\n    input_string='PSVEPPLsQETFSDL',  # 15-mer site sequence (lowercase = phosphosite)\n    ref=Data.get_pspa(),             # reference PSSM DataFrame (kinases × positions)\n    func=multiply_pspa,              # aggregation function (sumup or multiply_*)\n    to_lower=False,                  # convert STY→sty before scoring\n    to_upper=False,                  # convert all to uppercase before scoring\n    verbose=True,                    # print which positions were used\n)\n# Returns: pd.Series of scores indexed by kinase, sorted descending\n\nBatch Prediction (DataFrame)\npredict_kinase_df — Scores all kinases against multiple sequences in a DataFrame. Optimized for large-scale scoring.\npredict_kinase_df(\n    df=Data.get_human_site().head(100),  # DataFrame containing site sequences\n    seq_col='site_seq',                   # column name with sequences\n    ref=Data.get_pspa(),                  # reference PSSM DataFrame\n    func=multiply_pspa,                   # aggregation function\n    to_lower=False,                       # convert STY→sty\n    to_upper=False,                       # convert all to uppercase\n)\n# Returns: DataFrame (rows=input sites, cols=kinases) of scores\n\nPercentile Scoring\nThese functions convert raw scores to percentiles based on a reference distribution.\nget_pct — Calculates percentile rank for a single sequence against all kinases.\nget_pct(\n    site='PSVEPPLsQETFSDL',       # phosphosite sequence\n    ref=Data.get_pspa_st(),       # reference PSSM\n    func=multiply_pspa,           # scoring function\n    pct_ref=Data.get_pspa_st_pct(),  # percentile reference distribution\n)\n# Returns: DataFrame with columns ['log2(score)', 'percentile']\nget_pct_df — Converts a DataFrame of raw scores to percentile ranks (vectorized).\nget_pct_df(\n    score_df=out,                    # output from predict_kinase_df\n    pct_ref=Data.get_pspa_st_pct(),  # reference distribution for percentiles\n)\n# Returns: DataFrame of percentile ranks (same shape as score_df)\n\nConfiguration Presets\nParams — Returns pre-configured parameter dictionaries for different scoring modes.\nParams(\n    name='PSPA',  # preset name: 'CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA'\n    load=True,    # whether to load the reference DataFrame immediately\n)\n# Returns: dict with keys 'ref', 'func', and optionally 'to_upper'/'to_lower'\n\n# List available presets:\nParams() # Returns: ['CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA']\n\n\n\n\n\n\n\n\n\nPreset\nReference\nFunction\nUse Case\n\n\n\n\nCDDM\nLog-odds matrix\nsumup\nKnown phosphorylated status\n\n\nCDDM_upper\nLog-odds (uppercase)\nsumup\nAll uppercase only, unknown phosphorylated status\n\n\nPSPA_st\nPSPA S/T kinases\nmultiply_pspa\nKnown phosphorylated status; S/T only\n\n\nPSPA_y\nPSPA Y kinases\nmultiply_pspa\nKnown phosphorylated status; Y only\n\n\nPSPA\nAll PSPA kinases\nmultiply_pspa\nKnown phosphorylated status\n\n\n\n\nTypical Workflow\n# Single sequence scoring\nscores = predict_kinase(\n    input_string='PSVEPPLsQETFSDL',\n    **Params('PSPA'),\n)\n\n# Batch scoring with percentiles on S/T sites\ndf = Data.get_human_site()\nscore_df = predict_kinase_df(\n    df=df,\n    seq_col='site_seq',\n    **Params('PSPA_st'),\n)\npct_df = get_pct_df(\n    score_df=score_df,\n    pct_ref=Data.get_pspa_st_pct(),\n)",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#overview",
    "href": "scoring.html#overview",
    "title": "Scoring",
    "section": "",
    "text": "This module provides functions to calculate kinase scores based on substrate sequences using Position-Specific Scoring Matrices (PSSMs) from either PSPA data or kinase-substrate datasets.\n\nUtility Functions\nThese helper functions prepare and parse phosphorylation site sequences.\ncut_seq — Extracts a substring from a sequence based on positions relative to its center (the phosphorylation site).\ncut_seq(\n    input_string='AAkUuPSFSTtH',  # site sequence (15-mer or similar)\n    min_position=-5,              # start position relative to center\n    max_position=4,               # end position relative to center\n)\n# Returns: 'AkUuPSFSTt'\nSTY2sty — Converts uppercase S/T/Y (unphosphorylated) to lowercase s/t/y (phosphorylated) in a sequence.\nSTY2sty(\n    input_string='AAkUuPSFSTtH',  # sequence with uppercase STY\n)\n# Returns: 'AAkUuPsFsttH'\nget_dict — Parses a site sequence into position-annotated amino acid keys (e.g., -3P, 0s, 1Q) for PSSM lookup.\nget_dict(\n    input_string='PSVEPPLsQETFSDL',  # 15-mer phosphosite sequence\n)\n# Returns: ['-7P', '-6S', '-5V', ..., '0s', '1Q', ..., '7L']\n\nScoring Functions\nThese functions aggregate PSSM values across positions to produce a single kinase score.\nsumup — Simple summation of PSSM values at each position. Used with log-odds (LO) matrices.\nsumup(\n    values=[0.5, 1.2, -0.3, 0.8],  # PSSM values at each position\n    kinase='ATM',                  # kinase name (unused, for API consistency)\n)\n# Returns: sum of values\nmultiply — Log-space multiplication of PSSM probabilities, normalized by number of possible amino acids. Used with probability matrices.\nmultiply(\n    values=[0.04, 0.05, 0.03],  # probability values from PSSM\n    kinase='ATM',              # kinase name (unused)\n    num_aa=23,                 # number of amino acids (23 for CDDM, 20 for uppercase)\n)\n# Returns: log2(product) + normalization factor\nmultiply_pspa — Like multiply, but uses a kinase-specific normalization factor from the PSPA random amino acid library.\nmultiply_pspa(\n    values=[1, 2, 3, 4, 5],  # PSSM probability values\n    kinase='PDHK1',          # kinase name (determines normalization)\n)\n# Returns: np.float64(22.907...)\n\nSingle Sequence Prediction\npredict_kinase — Scores all kinases against a single phosphosite sequence. Returns a sorted Series of kinase scores.\npredict_kinase(\n    input_string='PSVEPPLsQETFSDL',  # 15-mer site sequence (lowercase = phosphosite)\n    ref=Data.get_pspa(),             # reference PSSM DataFrame (kinases × positions)\n    func=multiply_pspa,              # aggregation function (sumup or multiply_*)\n    to_lower=False,                  # convert STY→sty before scoring\n    to_upper=False,                  # convert all to uppercase before scoring\n    verbose=True,                    # print which positions were used\n)\n# Returns: pd.Series of scores indexed by kinase, sorted descending\n\nBatch Prediction (DataFrame)\npredict_kinase_df — Scores all kinases against multiple sequences in a DataFrame. Optimized for large-scale scoring.\npredict_kinase_df(\n    df=Data.get_human_site().head(100),  # DataFrame containing site sequences\n    seq_col='site_seq',                   # column name with sequences\n    ref=Data.get_pspa(),                  # reference PSSM DataFrame\n    func=multiply_pspa,                   # aggregation function\n    to_lower=False,                       # convert STY→sty\n    to_upper=False,                       # convert all to uppercase\n)\n# Returns: DataFrame (rows=input sites, cols=kinases) of scores\n\nPercentile Scoring\nThese functions convert raw scores to percentiles based on a reference distribution.\nget_pct — Calculates percentile rank for a single sequence against all kinases.\nget_pct(\n    site='PSVEPPLsQETFSDL',       # phosphosite sequence\n    ref=Data.get_pspa_st(),       # reference PSSM\n    func=multiply_pspa,           # scoring function\n    pct_ref=Data.get_pspa_st_pct(),  # percentile reference distribution\n)\n# Returns: DataFrame with columns ['log2(score)', 'percentile']\nget_pct_df — Converts a DataFrame of raw scores to percentile ranks (vectorized).\nget_pct_df(\n    score_df=out,                    # output from predict_kinase_df\n    pct_ref=Data.get_pspa_st_pct(),  # reference distribution for percentiles\n)\n# Returns: DataFrame of percentile ranks (same shape as score_df)\n\nConfiguration Presets\nParams — Returns pre-configured parameter dictionaries for different scoring modes.\nParams(\n    name='PSPA',  # preset name: 'CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA'\n    load=True,    # whether to load the reference DataFrame immediately\n)\n# Returns: dict with keys 'ref', 'func', and optionally 'to_upper'/'to_lower'\n\n# List available presets:\nParams() # Returns: ['CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA']\n\n\n\n\n\n\n\n\n\nPreset\nReference\nFunction\nUse Case\n\n\n\n\nCDDM\nLog-odds matrix\nsumup\nKnown phosphorylated status\n\n\nCDDM_upper\nLog-odds (uppercase)\nsumup\nAll uppercase only, unknown phosphorylated status\n\n\nPSPA_st\nPSPA S/T kinases\nmultiply_pspa\nKnown phosphorylated status; S/T only\n\n\nPSPA_y\nPSPA Y kinases\nmultiply_pspa\nKnown phosphorylated status; Y only\n\n\nPSPA\nAll PSPA kinases\nmultiply_pspa\nKnown phosphorylated status\n\n\n\n\nTypical Workflow\n# Single sequence scoring\nscores = predict_kinase(\n    input_string='PSVEPPLsQETFSDL',\n    **Params('PSPA'),\n)\n\n# Batch scoring with percentiles on S/T sites\ndf = Data.get_human_site()\nscore_df = predict_kinase_df(\n    df=df,\n    seq_col='site_seq',\n    **Params('PSPA_st'),\n)\npct_df = get_pct_df(\n    score_df=score_df,\n    pct_ref=Data.get_pspa_st_pct(),\n)",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#setup",
    "href": "scoring.html#setup",
    "title": "Scoring",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#utils",
    "href": "scoring.html#utils",
    "title": "Scoring",
    "section": "Utils",
    "text": "Utils\n\n\ncut_seq\n\ndef cut_seq(\n    input_string:str, # site sequence\n    min_position:int, # minimum position relative to its center\n    max_position:int, # maximum position relative to its center\n):\n\nExtract sequence based on a range relative to its center position\n\ncut_seq('AAkUuPSFSTtH',-5,4)\n\n'AkUuPSFSTt'\n\n\n\n\n\nSTY2sty\n\ndef STY2sty(\n    input_string:str\n):\n\nReplace all ‘STY’ with ‘sty’ in a sequence\n\nSTY2sty('AAkUuPSFSTtH') # convert all capital STY to sty in a string\n\n'AAkUuPsFsttH'\n\n\n\n\n\nget_dict\n\ndef get_dict(\n    input_string:str, # phosphorylation site sequence\n):\n\nGet a dictionary of input string; no need for the star in the middle; make sure it is 15 or 10 length\n\ncols = get_dict(\"PSVEPPLsQETFSDL\")\ncols\n\n['-7P',\n '-6S',\n '-5V',\n '-4E',\n '-3P',\n '-2P',\n '-1L',\n '0s',\n '1Q',\n '2E',\n '3T',\n '4F',\n '5S',\n '6D',\n '7L']",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#scoring-func",
    "href": "scoring.html#scoring-func",
    "title": "Scoring",
    "section": "Scoring func",
    "text": "Scoring func\n\nMultiply\n\n\n\nmultiply\n\ndef multiply(\n    values, # list of values, possibilities of amino acids at certain positions\n    kinase:NoneType=None, num_aa:int=23, # number of amino acids, 23 for standard CDDM, 20 for all uppercase CDDM\n):\n\nMultiply the possibilities of the amino acids at each position in a phosphorylation site\n\\[\n\\text{Score} = \\log_2 \\left( \\frac{ \\prod P_{\\text{KinX}}(\\text{AA}, \\text{Position}) }{ \\left( \\frac{1}{\\#\\text{Random AA}} \\right)^{\\text{length(Position except 0)}} } \\right)\n\\]\nThe function implement formula from Johnson et al. Nature: An atlas of substrate specificities for the human serine/threonine kinome, Supplementary Note2 (page 160)\nMultiply class, consider the dynamics of scale factor\n\n\n\nmultiply_pspa\n\ndef multiply_pspa(\n    values, kinase, num_aa_dict:NoneType=None\n):\n\nMultiply values, consider the dynamics of scale factor, which is PSPA random aa number.\n\nmultiply_pspa(values=[1,2,3,4,5],kinase='PDHK1')\n\nnp.float64(22.906890595608516)\n\n\n\n\nSum\n\n\n\nsumup\n\ndef sumup(\n    values, # list of values, possibilities of amino acids at certain positions\n    kinase:NoneType=None\n):\n\nSum up the possibilities of the amino acids at each position in a phosphorylation site sequence",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#predict-kinase",
    "href": "scoring.html#predict-kinase",
    "title": "Scoring",
    "section": "Predict kinase",
    "text": "Predict kinase\n\n\nduplicate_ref_zero\n\ndef duplicate_ref_zero(\n    df:DataFrame\n)-&gt;DataFrame:\n\nIf ‘0S’, ‘0T’, ‘0Y’ exist with non-zero values, create ‘0s’, ‘0t’, ‘0y’ with same values. If ‘0s’, ‘0t’, ‘0y’ exist with non-zero values, create ‘0S’, ‘0T’, ‘0Y’ with same values.\n\n\n\npreprocess_ref\n\ndef preprocess_ref(\n    ref\n):\n\nConvert pS/T/Y in ref columns to s/t/y if any; mirror 0S/T/Y to 0s/t/y.\n\n\n\npredict_kinase\n\ndef predict_kinase(\n    input_string:str, # site sequence\n    ref:DataFrame, # reference dataframe for scoring\n    func:Callable, # function to calculate score\n    to_lower:bool=False, # convert capital STY to lower case\n    to_upper:bool=False, # convert all letter to uppercase\n    verbose:bool=True\n):\n\nPredict kinase given a phosphorylation site sequence\nPSPA scoring:\n\npspa_ref = Data.get_pspa()\n\n\npredict_kinase(\"PSVEPPLsQETFSDL\",ref=pspa_ref,func=multiply_pspa)\n\nconsidering string: ['-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S']\n\n\nkinase\nATM       5.037\nSMG1      4.385\nDNAPK     3.818\nATR       3.507\nFAM20C    3.170\n          ...  \nPKN1     -7.275\nP70S6K   -7.295\nAKT3     -7.375\nPKCI     -7.742\nNEK3     -8.254\nLength: 303, dtype: float64\n\n\nCDDM scoring, LO + sum\n\nref=Data.get_cddm_LO() # Data.get_cddm_LO_upper()\n\n\npredict_kinase(\"PSVEPPLsQETFSDL\",ref=ref,func=sumup)\n\nconsidering string: ['-7P', '-6S', '-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S', '6D', '7L']\n\n\nATR        12.751\nATM        10.960\nDNAPK       6.039\nSRPK2       2.079\nSMMLCK      1.876\n           ...   \nROR1      -89.216\nCDC7      -91.457\nCAMK1B    -91.577\nTNNI3K   -118.835\nBRAF     -134.851\nLength: 328, dtype: float64\n\n\nCDDM scoring, PSSM + multiply (#23aa)\n\nref=Data.get_cddm() # Data.get_cddm_upper()\npredict_kinase(\"PSVEPPLsQETFSDL\",ref=ref,func=multiply_23)\n\nconsidering string: ['-7P', '-6S', '-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S', '6D', '7L']\n\n\nATR        16.824\nATM        15.033\nDNAPK      10.112\nSRPK2       6.152\nSMMLCK      5.949\n           ...   \nROR1      -85.143\nCDC7      -87.384\nCAMK1B    -87.503\nTNNI3K   -114.762\nBRAF     -130.778\nLength: 328, dtype: float64\n\n\nCDDM scoring, PSSM + multiply (#20aa)\n\nref=Data.get_cddm_upper() # Data.get_cddm_upper()\npredict_kinase(\"PSVEPPLsQETFSDL\",ref=ref,func=multiply_20)\n\nconsidering string: ['-7P', '-6S', '-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S', '6D', '7L']\n\n\nATR        16.587\nATM        14.362\nDNAPK      10.430\nSRPK2       8.044\nCHK2        7.955\n           ...   \nTTK       -43.375\nGAK       -45.159\nCAMK1B    -69.395\nTNNI3K    -70.993\nBRAF     -109.130\nLength: 328, dtype: float64",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#params",
    "href": "scoring.html#params",
    "title": "Scoring",
    "section": "Params",
    "text": "Params\nHere we provide different PSSM settings from either PSPA data or kinase-substrate dataset for kinase prediction:\n\n\nParams\n\ndef Params(\n    name:NoneType=None, load:bool=True\n):\n\n\nParams()\n\n['CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA']\n\n\n\nfor p in ['PSPA', 'CDDM','CDDM_upper']:\n    print(predict_kinase(\"PSVEPPLsQETFSDL\",**Params(p)).head())\n\nconsidering string: ['-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S']\nkinase\nATM       5.037\nSMG1      4.385\nDNAPK     3.818\nATR       3.507\nFAM20C    3.170\ndtype: float64\nconsidering string: ['-7P', '-6S', '-5V', '-4E', '-3P', '-2P', '-1L', '0s', '1Q', '2E', '3T', '4F', '5S', '6D', '7L']\nATR       12.751\nATM       10.960\nDNAPK      6.039\nSRPK2      2.079\nSMMLCK     1.876\ndtype: float64\nconsidering string: ['-7P', '-6S', '-5V', '-4E', '-3P', '-2P', '-1L', '0S', '1Q', '2E', '3T', '4F', '5S', '6D', '7L']\nATR      11.815\nATM       9.590\nDNAPK     5.659\nSRPK2     3.272\nCHK2      3.183\ndtype: float64",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#predict-kinase-in-df",
    "href": "scoring.html#predict-kinase-in-df",
    "title": "Scoring",
    "section": "Predict kinase in df",
    "text": "Predict kinase in df\n\n\nmultiply_generic\n\ndef multiply_generic(\n    merged_df, kinases, df_index, divide_factor_func\n):\n\nMultiply-based log-sum aggregation across kinases.\n\n\n\npredict_kinase_df\n\ndef predict_kinase_df(\n    df, seq_col, ref, func, to_lower:bool=False, to_upper:bool=False\n):\n\nPredict kinase scores based on reference PSSM or weight matrix. Applies preprocessing, merges long format keys, then aggregates using given func.\n\ndf=Data.get_human_site()\n\n\n# for p in ['CDDM', 'CDDM_upper', 'PSPA_st', 'PSPA_y', 'PSPA']:\n#     out = predict_kinase_df2(df.head(10), seq_col='site_seq', **Params(p))\n#     print(out.head())\n\n\nout = predict_kinase_df(df.head(100), seq_col='site_seq', **Params('PSPA'))\n\nInput dataframe has 100 rows\nPreprocessing...\nPreprocessing done. Expanding sequences...\nMerging reference...\nMerge complete.\n\n\nComputing multiply_generic: 100%|██████████| 396/396 [00:00&lt;00:00, 2108.42it/s]",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#percentile-scoring",
    "href": "scoring.html#percentile-scoring",
    "title": "Scoring",
    "section": "Percentile scoring",
    "text": "Percentile scoring\n\n\nget_pct\n\ndef get_pct(\n    site, ref, func, pct_ref\n):\n\nReplicate the precentile results from The Kinase Library.\n\nst_pct = Data.get_pspa_st_pct()\ny_pct = Data.get_pspa_tyr_pct()\n\n\nout = get_pct('PSVEPPLyQETFSDL',**Params('PSPA_y'), pct_ref=y_pct)\nout.sort_values('percentile',ascending=False)\n\nconsidering string: ['-5V', '-4E', '-3P', '-2P', '-1L', '0Y', '1Q', '2E', '3T', '4F', '5S']\n\n\n\n\n\n\n\n\n\nlog2(score)\npercentile\n\n\n\n\nABL2\n3.137\n96.568694\n\n\nBMX\n2.816\n96.117567\n\n\nBTK\n1.956\n95.693780\n\n\nCSK\n2.303\n95.174299\n\n\nMERTK\n2.509\n93.588517\n\n\n...\n...\n...\n\n\nFLT1\n-1.919\n25.358852\n\n\nPINK1_TYR\n-1.227\n21.927546\n\n\nMUSK\n-3.031\n21.298701\n\n\nTNNI3K_TYR\n-3.549\n11.004785\n\n\nPKMYT1_TYR\n-1.739\n4.798360\n\n\n\n\n93 rows × 2 columns\n\n\n\n\nget_pct('PSVEPPLsQETFSDL',**Params('PSPA_st'), pct_ref=st_pct)\n\nconsidering string: ['-5V', '-4E', '-3P', '-2P', '-1L', '0S', '1Q', '2E', '3T', '4F']\n\n\n\n\n\n\n\n\n\nlog2(score)\npercentile\n\n\n\n\nATM\n5.037\n99.822351\n\n\nSMG1\n4.385\n99.831819\n\n\nDNAPK\n3.818\n99.205315\n\n\nATR\n3.507\n99.680344\n\n\nFAM20C\n3.170\n95.370556\n\n\n...\n...\n...\n\n\nPKN1\n-7.275\n14.070436\n\n\nP70S6K\n-7.295\n4.089816\n\n\nAKT3\n-7.375\n11.432995\n\n\nPKCI\n-7.742\n8.129511\n\n\nNEK3\n-8.254\n4.637240\n\n\n\n\n303 rows × 2 columns\n\n\n\n\n\n\nget_pct_df\n\ndef get_pct_df(\n    score_df, # output from predict_kinase_df\n    pct_ref, # a reference df for percentile calculation\n):\n\nReplicate the precentile results from The Kinase Library.\n# substrate score first\nscore_df = predict_kinase_df(df_sty,'site_seq', **Params('PSPA_st'))\n\n#get percentile reference\npct_ref = Data.get_pspa_st_pct()\n\n# calculate percentile score\npct = get_pct_df(score_df,pct_ref)",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "scoring.html#end",
    "href": "scoring.html#end",
    "title": "Scoring",
    "section": "End",
    "text": "End",
    "crumbs": [
      "Modules",
      "Scoring"
    ]
  },
  {
    "objectID": "data.html",
    "href": "data.html",
    "title": "Data",
    "section": "",
    "text": "The Data class provides convenient access to various kinase and phosphorylation datasets. Data is automatically downloaded to a temporary folder on first use, or you can specify a custom location with Data.set_dir.\n\n\n\n\n\n\n\n\nCategory\nFunction\nDescription\n\n\n\n\nSetup\nData.download()\nDownload/extract dataset (use force=True to update)\n\n\nKinase Info\nData.get_kinase_info()\n523 human kinases with group, family, sequences, localization\n\n\n\nData.get_kinase_uniprot()\n672 UniProt human kinases (includes pseudokinases, lipid kinases)\n\n\n\nData.get_kd_uniprot()\nKinase domains from UniProt\n\n\nPSPA\nData.get_pspa_st()\nSer/Thr kinase positional specificity (normalized)\n\n\n\nData.get_pspa_tyr()\nTyrosine kinase positional specificity (normalized)\n\n\n\nData.get_pspa()\nCombined S/T and Y kinase specificity\n\n\n\nData.get_pspa_scale()\nPSPA scaled data (each position sums to 1)\n\n\n\nData.get_pspa_st_pct() / get_pspa_tyr_pct()\nReference scores for percentile calculation\n\n\n\nData.get_num_dict()\nDict mapping kinase → number of random AAs in PSPA\n\n\nCDDM\nData.get_cddm()\nCDDM position-specific scoring matrices\n\n\n\nData.get_cddm_upper()\nCDDM with uppercase sequences only\n\n\n\nData.get_cddm_LO() / get_cddm_LO_upper()\nCDDM log-odds scores\n\n\n\nData.get_ks_dataset()\nKinase–substrate pairs with kinase annotations\n\n\n\nData.get_ks_unique()\nUnique substrate sites\n\n\n\nData.get_ks_background()\nBackground amino acid frequencies\n\n\nAmino Acids\nData.get_aa_info()\nAmino acid properties (MW, pKa, etc.)\n\n\n\nData.get_aa_rdkit()\nRDKit molecular descriptors\n\n\n\nData.get_aa_morgan()\nMorgan fingerprints\n\n\nPhosphosites\nData.get_human_site()\nCombined Ochoa + PSP phosphosites (20-mer)\n\n\n\nData.get_psp_human_site()\nPhosphoSitePlus human sites\n\n\n\nData.get_ochoa_site()\nOchoa et al. phosphoproteomics\n\n\n\nData.get_cptac_*\nVarious CPTAC dataset views\n\n\nPathways\nData.get_reactome_pathway()\nAll Reactome pathways\n\n\n\nData.get_reactome_pathway_lo()\nLowest-level Reactome pathways\n\n\n\nThe CPTAC class provides access to cancer phosphoproteomics:\n\n\n\n\n\n\n\nFunction\nDescription\n\n\n\n\nCPTAC.list_cancer()\nList available cancer types (HNSCC, GBM, COAD, etc.)\n\n\nCPTAC.get_id(cancer, is_Tumor, is_KB)\nGet phosphosite info for a cancer type",
    "crumbs": [
      "Modules",
      "Data"
    ]
  },
  {
    "objectID": "data.html#overview",
    "href": "data.html#overview",
    "title": "Data",
    "section": "",
    "text": "The Data class provides convenient access to various kinase and phosphorylation datasets. Data is automatically downloaded to a temporary folder on first use, or you can specify a custom location with Data.set_dir.\n\n\n\n\n\n\n\n\nCategory\nFunction\nDescription\n\n\n\n\nSetup\nData.download()\nDownload/extract dataset (use force=True to update)\n\n\nKinase Info\nData.get_kinase_info()\n523 human kinases with group, family, sequences, localization\n\n\n\nData.get_kinase_uniprot()\n672 UniProt human kinases (includes pseudokinases, lipid kinases)\n\n\n\nData.get_kd_uniprot()\nKinase domains from UniProt\n\n\nPSPA\nData.get_pspa_st()\nSer/Thr kinase positional specificity (normalized)\n\n\n\nData.get_pspa_tyr()\nTyrosine kinase positional specificity (normalized)\n\n\n\nData.get_pspa()\nCombined S/T and Y kinase specificity\n\n\n\nData.get_pspa_scale()\nPSPA scaled data (each position sums to 1)\n\n\n\nData.get_pspa_st_pct() / get_pspa_tyr_pct()\nReference scores for percentile calculation\n\n\n\nData.get_num_dict()\nDict mapping kinase → number of random AAs in PSPA\n\n\nCDDM\nData.get_cddm()\nCDDM position-specific scoring matrices\n\n\n\nData.get_cddm_upper()\nCDDM with uppercase sequences only\n\n\n\nData.get_cddm_LO() / get_cddm_LO_upper()\nCDDM log-odds scores\n\n\n\nData.get_ks_dataset()\nKinase–substrate pairs with kinase annotations\n\n\n\nData.get_ks_unique()\nUnique substrate sites\n\n\n\nData.get_ks_background()\nBackground amino acid frequencies\n\n\nAmino Acids\nData.get_aa_info()\nAmino acid properties (MW, pKa, etc.)\n\n\n\nData.get_aa_rdkit()\nRDKit molecular descriptors\n\n\n\nData.get_aa_morgan()\nMorgan fingerprints\n\n\nPhosphosites\nData.get_human_site()\nCombined Ochoa + PSP phosphosites (20-mer)\n\n\n\nData.get_psp_human_site()\nPhosphoSitePlus human sites\n\n\n\nData.get_ochoa_site()\nOchoa et al. phosphoproteomics\n\n\n\nData.get_cptac_*\nVarious CPTAC dataset views\n\n\nPathways\nData.get_reactome_pathway()\nAll Reactome pathways\n\n\n\nData.get_reactome_pathway_lo()\nLowest-level Reactome pathways\n\n\n\nThe CPTAC class provides access to cancer phosphoproteomics:\n\n\n\n\n\n\n\nFunction\nDescription\n\n\n\n\nCPTAC.list_cancer()\nList available cancer types (HNSCC, GBM, COAD, etc.)\n\n\nCPTAC.get_id(cancer, is_Tumor, is_KB)\nGet phosphosite info for a cancer type",
    "crumbs": [
      "Modules",
      "Data"
    ]
  },
  {
    "objectID": "data.html#setup",
    "href": "data.html#setup",
    "title": "Data",
    "section": "Setup",
    "text": "Setup",
    "crumbs": [
      "Modules",
      "Data"
    ]
  },
  {
    "objectID": "data.html#kinase-dataset",
    "href": "data.html#kinase-dataset",
    "title": "Data",
    "section": "Kinase Dataset",
    "text": "Kinase Dataset\nWe will go through how to load kinase information data and phosphorylation sites data.\nDatasets used in this study can be accessed through Data\n\n\nData\n\ndef Data(\n    args:VAR_POSITIONAL, kwargs:VAR_KEYWORD\n):\n\nA class for fetching various datasets.\n\n\n\nData.set_dir\n\ndef set_dir(\n    path\n):\n\nThe default is a tmp folder. If you want to download to a customized folder, use:\n\n# Data.set_dir('/tmp/test')\n\n✅ Dataset path set to: /tmp/test/katlas_dataset\n\n\n\nData.DATASET_DIR\n\nPath('/tmp/test/katlas_dataset')\n\n\n\n\n\nData.download\n\ndef download(\n    download_dir:NoneType=None, # Parent directory for katlas_dataset folder\n    force:bool=False, # If True, re-download even if exists\n    verbose:bool=True, # Print status messages\n):\n\nDownload dataset zip and extract to folder.\nFor the first time download or to update data folder:\nData.download(force=True)\n\n# Data.download(force=True)\n\n\n\n\nData.read_file\n\ndef read_file(\n    rel_path\n):\n\nLoad a CSV or Parquet file from the local dataset folder.\nAutomatically infers file type from the filename extension. Renames ‘Unnamed: 0’ column to ‘kinase’ if present.\n\nData.read_file('kinase_info.csv')\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\ngene\nmodi_group\ngroup\nfamily\nsubfamily_coral\nsubfamily\nin_pspa_st\nin_pspa_tyr\nin_pspa\nin_cddm\nkd_ID\nactive_D1_D2\nactive_kd_ID\npspa_ID\npseudo\npspa_category_small\npspa_category_big\ncddm_big\ncddm_small\nlength\nhuman_uniprot_sequence\nkinasecom_domain\nnucleus\ncytosol\ncytoskeleton\nplasma membrane\nmitochondrion\nGolgi apparatus\nendoplasmic reticulum\nvesicle\ncentrosome\naggresome\nmain_location\n\n\n\n\n0\nAAK1\nAAK1\nQ2M2I8\nAAK1\nOther\nOther\nNAK\nNaN\nNAK\n1\n0\n1\n0\nQ2M2I8_AAK1_HUMAN_KD1\n1.0\nQ2M2I8_AAK1_HUMAN_KD1\nAAK1\n0\nNak\nNak\nNaN\nNaN\n961\nMKKFFDSRREQGGSGLGSGSSGGGGSTSGLGSGYIGRVFGIGRQQV...\nVTVDEVLAEGGFAIVFLVRTSNGMKCALKRMFVNNEHDLQVCKREI...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n1\nAATK\nLMR1\nQ6ZMQ8\nAATK\nTK\nTK\nLmr\nNaN\nLmr\n0\n0\n0\n0\nQ6ZMQ8_LMTK1_HUMAN_KD1\n1.0\nQ6ZMQ8_LMTK1_HUMAN_KD1\nNaN\n0\nNaN\nNaN\nNaN\nNaN\n1374\nMSSSFFNPSFAFSSHFDPDGAPLSELSWPSSLAVVAVSFSGLFAVI...\nLLYLKEIGRGWFGKVFLGEVNSGISSAQVVVKELQASASVQEQMQF...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n521\nZAK\nZAK\nQ9NYL2\nMAP3K20\nTKL\nTKL\nMLK\nZAK\nZAK\n1\n0\n1\n1\nQ9NYL2_M3K20_HUMAN_KD1\n1.0\nQ9NYL2_M3K20_HUMAN_KD1\nZAK\n0\nMap3k\nMap3k\n2.0\n9.0\n800\nMSSLGASFVQIKFDDLQFFENCGGGSFGSVYRAKWISQDKEVAVKK...\nLQFFENCGGGSFGSVYRAKWISQDKEVAVKKLLKIEKEAEILSVLS...\n5.0\n5.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nnucleus\n\n\n522\nZAP70\nZAP70\nP43403\nZAP70\nTK\nTK\nSyk\nNaN\nSyk\n0\n1\n1\n1\nP43403_ZAP70_HUMAN_KD1\n1.0\nP43403_ZAP70_HUMAN_KD1\nZAP70\n0\nSyk and fak\nSyk and fak\n1.0\n3.0\n619\nMPDPAAHLPFFYGSISRAEAEEHLKLAGMADGLFLLRQCLRSLGGY...\nLIADIELGCGNFGSVRQGVYRMRKKQIDVAIKVLKQGTEKADTEEM...\n3.0\n5.0\nNaN\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n\n\n523 rows × 36 columns\n\n\n\n\n\nKinase info\n\n\n\nData.get_kinase_info\n\ndef get_kinase_info(\n    \n):\n\nGet information of 523 human kinases on kinome tree.  Group, family, and subfamily classifications are sourced from Coral; full protein sequences are retrieved using UniProt IDs; kinase domain sequences are obtained from KinaseDomain.com; and cellular localization data is extracted from published literature.\n\nData.get_kinase_info()\n\n\n\n\n\n\n\n\nkinase\nID_coral\nuniprot\ngene\nmodi_group\ngroup\nfamily\nsubfamily_coral\nsubfamily\nin_pspa_st\nin_pspa_tyr\nin_pspa\nin_cddm\nkd_ID\nactive_D1_D2\nactive_kd_ID\npspa_ID\npseudo\npspa_category_small\npspa_category_big\ncddm_big\ncddm_small\nlength\nhuman_uniprot_sequence\nkinasecom_domain\nnucleus\ncytosol\ncytoskeleton\nplasma membrane\nmitochondrion\nGolgi apparatus\nendoplasmic reticulum\nvesicle\ncentrosome\naggresome\nmain_location\n\n\n\n\n0\nAAK1\nAAK1\nQ2M2I8\nAAK1\nOther\nOther\nNAK\nNaN\nNAK\n1\n0\n1\n0\nQ2M2I8_AAK1_HUMAN_KD1\n1.0\nQ2M2I8_AAK1_HUMAN_KD1\nAAK1\n0\nNak\nNak\nNaN\nNaN\n961\nMKKFFDSRREQGGSGLGSGSSGGGGSTSGLGSGYIGRVFGIGRQQV...\nVTVDEVLAEGGFAIVFLVRTSNGMKCALKRMFVNNEHDLQVCKREI...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n1\nAATK\nLMR1\nQ6ZMQ8\nAATK\nTK\nTK\nLmr\nNaN\nLmr\n0\n0\n0\n0\nQ6ZMQ8_LMTK1_HUMAN_KD1\n1.0\nQ6ZMQ8_LMTK1_HUMAN_KD1\nNaN\n0\nNaN\nNaN\nNaN\nNaN\n1374\nMSSSFFNPSFAFSSHFDPDGAPLSELSWPSSLAVVAVSFSGLFAVI...\nLLYLKEIGRGWFGKVFLGEVNSGISSAQVVVKELQASASVQEQMQF...\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n521\nZAK\nZAK\nQ9NYL2\nMAP3K20\nTKL\nTKL\nMLK\nZAK\nZAK\n1\n0\n1\n1\nQ9NYL2_M3K20_HUMAN_KD1\n1.0\nQ9NYL2_M3K20_HUMAN_KD1\nZAK\n0\nMap3k\nMap3k\n2.0\n9.0\n800\nMSSLGASFVQIKFDDLQFFENCGGGSFGSVYRAKWISQDKEVAVKK...\nLQFFENCGGGSFGSVYRAKWISQDKEVAVKKLLKIEKEAEILSVLS...\n5.0\n5.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nnucleus\n\n\n522\nZAP70\nZAP70\nP43403\nZAP70\nTK\nTK\nSyk\nNaN\nSyk\n0\n1\n1\n1\nP43403_ZAP70_HUMAN_KD1\n1.0\nP43403_ZAP70_HUMAN_KD1\nZAP70\n0\nSyk and fak\nSyk and fak\n1.0\n3.0\n619\nMPDPAAHLPFFYGSISRAEAEEHLKLAGMADGLFLLRQCLRSLGGY...\nLIADIELGCGNFGSVRQGVYRMRKKQIDVAIKVLKQGTEKADTEEM...\n3.0\n5.0\nNaN\n2.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\ncytosol\n\n\n\n\n523 rows × 36 columns\n\n\n\n\n\n\nData.get_kinase_uniprot\n\ndef get_kinase_uniprot(\n    \n)-&gt;DataFrame:\n\nGet information of 672 uniprot human kinases, which were retrieved from UniProt by filtering all human protein entries using the keyword ‘kinase’.  It includes additional pseudokinases and lipid kinases.\n\nData.get_kinase_uniprot()\n\n\n\n\n\n\n\n\nEntry\nEntry Name\nProtein names\nGene Names\nuniprot_keyword_kinase\non_tree\nOrganism\nKeywords\nSequence\n\n\n\n\n0\nA2RU49\nHYKK_HUMAN\nHydroxylysine kinase (5-hydroxy-L-lysine kinas...\nHYKK AGPHD1\n1\n0\nHomo sapiens (Human)\nAlternative splicing;Cytoplasm;Kinase;Proteomi...\nMSSGNYQQSEALSKPTFSEEQASALVESVFGLKVSKVRPLPSYDDQ...\n\n\n1\nA4D2B8\nPM2P1_HUMAN\nPutative postmeiotic segregation increased 2-l...\nPMS2P1 PMS2L1 PMS2L13 PMS2L6 PMS2L8 PMS3 PMS8 ...\n1\n0\nHomo sapiens (Human)\nAlternative splicing;Kinase;Reference proteome...\nMVTMCGGHRPENFLHQVLTEFGEELAGEGKSEVGGGAPRSYLQVAS...\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n670\nQ8NCB2\nCAMKV_HUMAN\nCaM kinase-like vesicle-associated protein\nCAMKV\n0\n1\nHomo sapiens (Human)\nAlternative splicing;Calmodulin-binding;Cell m...\nMPFGCVTLGDKKNYNQPSEVTDRYDLGQVIKTEEFCEIFRAKDKTT...\n\n\n671\nQ8IV63\nVRK3_HUMAN\nSerine/threonine-protein kinase VRK3 (EC 2.7.1...\nVRK3\n0\n1\nHomo sapiens (Human)\n3D-structure;Alternative splicing;Cytoplasm;Nu...\nMISFCPDCGKSIQAAFKFCPYCGNSLPVEEHVGSQTFVNPHVSSFQ...\n\n\n\n\n672 rows × 9 columns\n\n\n\n\n\n\nData.get_kd_uniprot\n\ndef get_kd_uniprot(\n    \n):\n\nKinase domains extracted from UniProt database.\n\nData.get_kd_uniprot()\n\n\n\n\n\n\n\n\nkd_ID\nUniprot\nEntry Name\nProtein names\nGene Names\nGene Names (primary)\nOrganism\nkd_note\nkd_evidence\nkd_start\nkd_end\nkd_seq\nDomain [FT]\nDomain [CC]\nRegion\nMotif\nProtein families\nReactome\nComplexPortal\nSubcellular location [CC]\nGene Ontology (biological process)\nTissue specificity\nInteracts with\nSubunit structure\nFunction [CC]\nActivity regulation\nfull_seq\nD1\nD2\nD3\nN1\nactive_D1_D2\n\n\n\n\n0\nA0A075F7E9_LERK1_ORYSI_KD1\nA0A075F7E9\nLERK1_ORYSI\nG-type lectin S-receptor-like serine/threonine...\nLECRK1 LECRK OsI_14840\nLECRK1\nOryza sativa subsp. indica (Rice)\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n523\n797\nAGFHEILGAGASGVVYKGQLEDELKTNIAVKTIHKLQPETEKEFMV...\nDOMAIN 22..149; /note=\"Bulb-type lectin\"; /evi...\nNone\nNone\nNone\nProtein kinase superfamily, Ser/Thr protein ki...\nNone\nNone\nSUBCELLULAR LOCATION: Membrane {ECO:0000255}; ...\ndefense response [GO:0006952]; response to oth...\nTISSUE SPECIFICITY: Expressed in plumules, rad...\nNone\nSUBUNIT: Interacts (via kinase domain) with AD...\nFUNCTION: Involved in innate immunity. Require...\nNone\nMVALLLFPMLLQLLSPTCAQTQKNITLGSTLAPQGPASSWLSPSGD...\n1\n1\n1\n1\n1\n\n\n1\nA0A078BQP2_GCY25_CAEEL_KD1\nA0A078BQP2\nGCY25_CAEEL\nReceptor-type guanylate cyclase gcy-25 (EC 4.6...\ngcy-25 Y105C5B.2\ngcy-25\nCaenorhabditis elegans\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n464\n749\nRVSTISTARASYSSIFSGNVAEHAIVNKQKVSVKRHVQRRAITFSR...\nDOMAIN 464..749; /note=\"Protein kinase\"; /evid...\nDOMAIN: The protein kinase domain is predicted...\nNone\nNone\nAdenylyl cyclase class-4/guanylyl cyclase family\nR-CEL-2514859;\nNone\nSUBCELLULAR LOCATION: Cell membrane {ECO:00003...\ncGMP biosynthetic process [GO:0006182]; intrac...\nTISSUE SPECIFICITY: Expressed in AQR, PQR and ...\nNone\nNone\nFUNCTION: Guanylate cyclase involved in the pr...\nNone\nMLLLLLLLKISTFVDSFQIGHLEFENSNETRILEICMKNAGSWRDH...\n0\n0\n1\n0\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n5534\nX5M5N0_WNK_CAEEL_KD1\nX5M5N0\nWNK_CAEEL\nSerine/threonine-protein kinase WNK (EC 2.7.11...\nwnk-1 C46C2.1\nwnk-1\nCaenorhabditis elegans\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n334\n596\nLKFDEELGRGSFKTVFRGLDTETGVAVAWCELQESKLNKTERQRFR...\nDOMAIN 334..596; /note=\"Protein kinase\"; /evid...\nDOMAIN: Disordered regions undergo liquid-liqu...\nNone\nNone\nProtein kinase superfamily, Ser/Thr protein ki...\nNone\nNone\nSUBCELLULAR LOCATION: Cytoplasm {ECO:0000250|U...\ncell volume homeostasis [GO:0006884]; cellular...\nTISSUE SPECIFICITY: Expressed in pharynx, nerv...\nG5EEN4\nSUBUNIT: Interacts with gck-3 (via C-terminus)...\nFUNCTION: Serine/threonine-protein kinase comp...\nACTIVITY REGULATION: Activated in response to ...\nMPDSITNGGRPPAPPSSVSSTTASTTGNFGTRRRLVNRIKKVDELH...\n1\n1\n1\n1\n1\n\n\n5535\nX5M8U1_GCY17_CAEEL_KD1\nX5M8U1\nGCY17_CAEEL\nReceptor-type guanylate cyclase gcy-17 (EC 4.6...\ngcy-17 W03F11.2\ngcy-17\nCaenorhabditis elegans\nProtein kinase\nECO:0000255|PROSITE-ProRule:PRU00159\n535\n824\nEASQRSFASGPSTSTKLTVESRTETTRFIFYIYQVRNNEVVAANKH...\nDOMAIN 535..824; /note=\"Protein kinase\"; /evid...\nDOMAIN: The protein kinase domain is predicted...\nNone\nNone\nAdenylyl cyclase class-4/guanylyl cyclase family\nR-CEL-2514859;\nNone\nSUBCELLULAR LOCATION: Cell membrane {ECO:00003...\ncGMP biosynthetic process [GO:0006182]; intrac...\nTISSUE SPECIFICITY: Expressed in PHA sensory n...\nNone\nNone\nFUNCTION: Guanylate cyclase involved in the pr...\nNone\nMLFLRLFIFTPFLILANCQARRTIKVGLLFVQNVSSLQVGIGYRTS...\n0\n1\n1\n0\n0\n\n\n\n\n5536 rows × 32 columns\n\n\n\n\n\nPSPA data\n\n\n\nget_pspa_tyr\n\ndef get_pspa_tyr(\n    \n):\n\nGet PSPA normalized data of tyrosine kinase.\n\nData.get_pspa_tyr()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n-5F\n-5Y\n-5W\n-5H\n-5K\n-5R\n-5Q\n-5N\n-5D\n-5E\n-5s\n-5t\n-5y\n-4P\n-4G\n-4A\n-4C\n-4S\n-4T\n-4V\n-4I\n-4L\n-4M\n-4F\n-4Y\n-4W\n-4H\n-4K\n-4R\n-4Q\n-4N\n-4D\n-4E\n-4s\n-4t\n-4y\n-3P\n-3G\n-3A\n-3C\n...\n4A\n4C\n4S\n4T\n4V\n4I\n4L\n4M\n4F\n4Y\n4W\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4s\n4t\n4y\n5P\n5G\n5A\n5C\n5S\n5T\n5V\n5I\n5L\n5M\n5F\n5Y\n5W\n5H\n5K\n5R\n5Q\n5N\n5D\n5E\n5s\n5t\n5y\n0S\n0T\n0Y\n0s\n0t\n0y\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nABL1\n0.0668\n0.0689\n0.0646\n0.0520\n0.0564\n0.0539\n0.0485\n0.0448\n0.0520\n0.0536\n0.0454\n0.0454\n0.0283\n0.0597\n0.0600\n0.0662\n0.0594\n0.0606\n0.0575\n0.0535\n0.0507\n0.0507\n0.0658\n0.0680\n0.0758\n0.0687\n0.0518\n0.0478\n0.0442\n0.0561\n0.0443\n0.0547\n0.0491\n0.0390\n0.0390\n0.0345\n0.0496\n0.0485\n0.0530\n0.0655\n0.0502\n0.0667\n0.0843\n0.0618\n0.0618\n0.0925\n0.0634\n0.0642\n0.0568\n0.0527\n...\n0.0526\n0.0584\n0.0563\n0.0522\n0.0514\n0.0429\n0.0510\n0.0664\n0.0645\n0.0645\n0.0600\n0.0647\n0.0647\n0.0757\n0.0607\n0.0499\n0.0322\n0.0342\n0.0217\n0.0217\n0.0306\n0.0769\n0.0707\n0.0624\n0.0493\n0.0591\n0.0661\n0.0553\n0.0378\n0.0548\n0.0603\n0.0392\n0.0392\n0.0413\n0.0613\n0.0652\n0.0756\n0.0526\n0.0512\n0.0362\n0.0339\n0.0254\n0.0254\n0.0337\n0\n0\n1\n0\n0\n1\n\n\nTNK2\n0.0679\n0.0818\n0.0627\n0.0617\n0.0529\n0.0528\n0.0419\n0.0463\n0.0437\n0.0453\n0.0539\n0.0539\n0.0598\n0.0583\n0.0624\n0.0727\n0.0537\n0.0553\n0.0451\n0.0435\n0.0430\n0.0430\n0.0555\n0.0723\n0.0682\n0.0665\n0.0567\n0.0458\n0.0423\n0.0436\n0.0426\n0.0433\n0.0495\n0.0584\n0.0584\n0.0697\n0.0556\n0.0664\n0.0757\n0.0647\n0.0532\n0.0409\n0.0413\n0.0398\n0.0398\n0.0493\n0.0755\n0.0653\n0.0572\n0.0544\n...\n0.0580\n0.0648\n0.0670\n0.0571\n0.0470\n0.0493\n0.0412\n0.0568\n0.0516\n0.0516\n0.0499\n0.0559\n0.0430\n0.0553\n0.0485\n0.0502\n0.0416\n0.0464\n0.0452\n0.0452\n0.0533\n0.0644\n0.0599\n0.0609\n0.0629\n0.0564\n0.0634\n0.0527\n0.0502\n0.0641\n0.0539\n0.0679\n0.0679\n0.0680\n0.0499\n0.0385\n0.0302\n0.0531\n0.0465\n0.0630\n0.0572\n0.0364\n0.0364\n0.0572\n0\n0\n1\n0\n0\n1\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nYES1\n0.0677\n0.0571\n0.0537\n0.0530\n0.0527\n0.0505\n0.0435\n0.0375\n0.0400\n0.0463\n0.0478\n0.0478\n0.0419\n0.0564\n0.0681\n0.0647\n0.0610\n0.0752\n0.0748\n0.0610\n0.0652\n0.0652\n0.0668\n0.0625\n0.0695\n0.0524\n0.0530\n0.0470\n0.0404\n0.0476\n0.0416\n0.0528\n0.0529\n0.0406\n0.0406\n0.0424\n0.0566\n0.0549\n0.0561\n0.0607\n0.0559\n0.0786\n0.0875\n0.0596\n0.0596\n0.0705\n0.0564\n0.0580\n0.0456\n0.0572\n...\n0.0464\n0.0747\n0.0521\n0.0561\n0.0468\n0.0452\n0.0481\n0.0716\n0.0689\n0.0689\n0.0619\n0.0623\n0.0587\n0.0757\n0.0652\n0.0499\n0.0421\n0.0492\n0.0371\n0.0371\n0.0467\n0.0762\n0.0532\n0.0533\n0.0610\n0.0596\n0.0558\n0.0416\n0.0375\n0.0467\n0.0518\n0.0627\n0.0627\n0.0456\n0.0593\n0.0662\n0.0840\n0.0559\n0.0604\n0.0422\n0.0482\n0.0374\n0.0374\n0.0411\n0\n0\n1\n0\n0\n1\n\n\nZAP70\n0.0602\n0.0880\n0.0623\n0.0496\n0.0471\n0.0514\n0.0465\n0.0380\n0.0307\n0.0526\n0.0479\n0.0479\n0.0347\n0.0641\n0.0471\n0.0452\n0.0492\n0.0703\n0.0870\n0.0777\n0.1622\n0.1622\n0.1208\n0.0977\n0.0792\n0.0865\n0.0556\n0.0487\n0.0367\n0.0375\n0.0312\n0.0317\n0.0344\n0.0274\n0.0274\n0.0347\n0.0474\n0.0338\n0.0380\n0.0571\n0.0457\n0.0929\n0.1392\n0.1432\n0.1432\n0.1685\n0.0588\n0.0610\n0.0537\n0.0581\n...\n0.0491\n0.0520\n0.0583\n0.0530\n0.0504\n0.0304\n0.0424\n0.0554\n0.0393\n0.0393\n0.0539\n0.0671\n0.0562\n0.0557\n0.0712\n0.0406\n0.0597\n0.0558\n0.0440\n0.0440\n0.0318\n0.1269\n0.0904\n0.0737\n0.0457\n0.0638\n0.0692\n0.0343\n0.0235\n0.0305\n0.0461\n0.0343\n0.0343\n0.0344\n0.0484\n0.0477\n0.0290\n0.0520\n0.0537\n0.0709\n0.0710\n0.0862\n0.0862\n0.0605\n0\n0\n1\n0\n0\n1\n\n\n\n\n93 rows × 236 columns\n\n\n\n\n\n\nget_pspa_st\n\ndef get_pspa_st(\n    \n):\n\nGet PSPA normalized data of serine/threonine kinase.\n\nData.get_pspa_st()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n-5F\n-5Y\n-5W\n-5H\n-5K\n-5R\n-5Q\n-5N\n-5D\n-5E\n-5s\n-5t\n-5y\n-4P\n-4G\n-4A\n-4C\n-4S\n-4T\n-4V\n-4I\n-4L\n-4M\n-4F\n-4Y\n-4W\n-4H\n-4K\n-4R\n-4Q\n-4N\n-4D\n-4E\n-4s\n-4t\n-4y\n-3P\n-3G\n-3A\n-3C\n...\n3A\n3C\n3S\n3T\n3V\n3I\n3L\n3M\n3F\n3Y\n3W\n3H\n3K\n3R\n3Q\n3N\n3D\n3E\n3s\n3t\n3y\n4P\n4G\n4A\n4C\n4S\n4T\n4V\n4I\n4L\n4M\n4F\n4Y\n4W\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4s\n4t\n4y\n0s\n0t\n0y\n0S\n0T\n0Y\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.0720\n0.0245\n0.0284\n0.0456\n0.0425\n0.0425\n0.0951\n0.1554\n0.0993\n0.0864\n0.0425\n0.0952\n0.0315\n0.0331\n0.0262\n0.0956\n0.0560\n0.0275\n0.0160\n0.0153\n0.0201\n0.0201\n0.0611\n0.0534\n0.0642\n0.0706\n0.0560\n0.0619\n0.0619\n0.0619\n0.0621\n0.0742\n0.0693\n0.0520\n0.0534\n0.0403\n0.0514\n0.0809\n0.0715\n0.0627\n0.0429\n0.0332\n0.0560\n0.0332\n0.0332\n0.0339\n0.1084\n0.0512\n0.1119\n0.0655\n...\n0.0582\n0.0742\n0.0582\n0.0582\n0.0610\n0.0388\n0.0489\n0.0437\n0.0430\n0.0533\n0.0481\n0.0674\n0.0739\n0.0901\n0.0623\n0.0735\n0.0405\n0.0371\n0.0335\n0.0335\n0.0359\n0.0628\n0.0702\n0.0646\n0.0603\n0.0560\n0.0560\n0.0422\n0.0415\n0.0461\n0.0464\n0.0523\n0.0521\n0.0826\n0.0560\n0.0831\n0.0928\n0.0635\n0.0592\n0.0389\n0.0457\n0.0251\n0.0251\n0.0270\n0.1013\n1.0\n0.0\n0.1013\n1.0\n0.0\n\n\nACVR2A\n0.0415\n0.0481\n0.0584\n0.0489\n0.0578\n0.0578\n0.0598\n0.0625\n0.0596\n0.0521\n0.0600\n0.0578\n0.0803\n0.0570\n0.0510\n0.0475\n0.0430\n0.0536\n0.0888\n0.0789\n0.0783\n0.0783\n0.0760\n0.0466\n0.0549\n0.0555\n0.0551\n0.0549\n0.0549\n0.0543\n0.0526\n0.0520\n0.0576\n0.0619\n0.0586\n0.0754\n0.0551\n0.0406\n0.0457\n0.0482\n0.0501\n0.1040\n0.0869\n0.0809\n0.0809\n0.0681\n0.0502\n0.0653\n0.0537\n0.0588\n...\n0.0529\n0.0481\n0.0590\n0.0590\n0.0567\n0.0554\n0.0612\n0.0589\n0.0644\n0.0654\n0.0635\n0.0590\n0.0462\n0.0387\n0.0499\n0.0524\n0.0622\n0.0870\n0.0519\n0.0519\n0.0815\n0.0758\n0.0544\n0.0498\n0.0517\n0.0563\n0.0563\n0.0516\n0.0563\n0.0512\n0.0662\n0.0523\n0.0579\n0.0800\n0.0573\n0.0527\n0.0491\n0.0616\n0.0556\n0.0640\n0.0640\n0.0703\n0.0703\n0.0589\n0.9833\n1.0\n0.0\n0.9833\n1.0\n0.0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nYSK4\n0.0593\n0.0728\n0.0744\n0.0734\n0.0597\n0.0597\n0.0517\n0.0400\n0.0433\n0.0512\n0.0636\n0.0600\n0.0755\n0.0664\n0.0525\n0.0597\n0.0481\n0.0616\n0.0692\n0.0508\n0.0703\n0.0703\n0.0474\n0.0622\n0.0683\n0.0618\n0.0652\n0.0618\n0.0618\n0.0477\n0.0412\n0.0519\n0.0570\n0.0610\n0.0620\n0.0714\n0.0626\n0.0491\n0.0523\n0.0551\n0.0649\n0.0671\n0.0645\n0.0663\n0.0663\n0.0534\n0.0561\n0.0683\n0.0571\n0.0636\n...\n0.0531\n0.0545\n0.0578\n0.0578\n0.0540\n0.0436\n0.0481\n0.0473\n0.0573\n0.0578\n0.0625\n0.0645\n0.0774\n0.0697\n0.0580\n0.0720\n0.0471\n0.0450\n0.0642\n0.0642\n0.0397\n0.0790\n0.0721\n0.0573\n0.0557\n0.0573\n0.0573\n0.0445\n0.0471\n0.0481\n0.0507\n0.0461\n0.0493\n0.0539\n0.0657\n0.0814\n0.0618\n0.0741\n0.0620\n0.0585\n0.0484\n0.0634\n0.0634\n0.0389\n0.7907\n1.0\n0.0\n0.7907\n1.0\n0.0\n\n\nZAK\n0.0604\n0.0641\n0.0659\n0.0631\n0.0597\n0.0597\n0.0454\n0.0431\n0.0477\n0.0484\n0.0544\n0.0597\n0.0673\n0.0650\n0.0815\n0.0669\n0.0538\n0.0653\n0.0591\n0.0520\n0.0716\n0.0716\n0.0611\n0.0627\n0.0682\n0.0537\n0.0621\n0.0627\n0.0627\n0.0447\n0.0423\n0.0433\n0.0500\n0.0526\n0.0564\n0.0630\n0.0663\n0.0634\n0.0653\n0.0548\n0.0701\n0.0759\n0.0673\n0.0703\n0.0703\n0.0469\n0.0723\n0.0694\n0.0593\n0.0680\n...\n0.0489\n0.0588\n0.0582\n0.0582\n0.0579\n0.0636\n0.0630\n0.0572\n0.0652\n0.0710\n0.0738\n0.0664\n0.0851\n0.0833\n0.0527\n0.0484\n0.0281\n0.0319\n0.0459\n0.0459\n0.0423\n0.0684\n0.0623\n0.0561\n0.0519\n0.0556\n0.0556\n0.0406\n0.0429\n0.0395\n0.0481\n0.0424\n0.0526\n0.0698\n0.0672\n0.1207\n0.1012\n0.0614\n0.0556\n0.0342\n0.0370\n0.0390\n0.0390\n0.0408\n0.6135\n1.0\n0.0\n0.6135\n1.0\n0.0\n\n\n\n\n303 rows × 213 columns\n\n\n\n\n\n\nget_pspa\n\ndef get_pspa(\n    \n)-&gt;DataFrame:\n\nGet PSPA normalized data of serine/threonine and tyrosine kinases. pS is duplicate of pT; For all kinases: -pS is duplicate of pT S/T kinases: - Column normalized to 17 (20 standard-S,T,C) or 16 (20-S,T,C,Y;PDHK1 & PDHK4) amino acids. - C is median of 17 or 16 (PDHK1 & PDHK4) amino acids TK (including _TYR which is non-canonical): - Column normalized to 18 (20-Y,C; canonical +TNNI3K,WEE1) or 16 (20-S,T,Y,C; IRR, JAK3, MST1R + non-canonical _TYR) aa. - Y is duplicate of F; - C is median of 18 or 16 amino acids.\n\nData.get_pspa()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n-5F\n-5Y\n-5W\n-5H\n-5K\n-5R\n-5Q\n-5N\n-5D\n-5E\n-5s\n-5t\n-5y\n-4P\n-4G\n-4A\n-4C\n-4S\n-4T\n-4V\n-4I\n-4L\n-4M\n-4F\n-4Y\n-4W\n-4H\n-4K\n-4R\n-4Q\n-4N\n-4D\n-4E\n-4s\n-4t\n-4y\n-3P\n-3G\n-3A\n-3C\n...\n4A\n4C\n4S\n4T\n4V\n4I\n4L\n4M\n4F\n4Y\n4W\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4s\n4t\n4y\n0s\n0t\n0y\n0S\n0T\n0Y\n5P\n5G\n5A\n5C\n5S\n5T\n5V\n5I\n5L\n5M\n5F\n5Y\n5W\n5H\n5K\n5R\n5Q\n5N\n5D\n5E\n5s\n5t\n5y\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.0720\n0.0245\n0.0284\n0.0456\n0.0425\n0.0425\n0.0951\n0.1554\n0.0993\n0.0864\n0.0425\n0.0952\n0.0315\n0.0331\n0.0262\n0.0956\n0.0560\n0.0275\n0.0160\n0.0153\n0.0201\n0.0201\n0.0611\n0.0534\n0.0642\n0.0706\n0.0560\n0.0619\n0.0619\n0.0619\n0.0621\n0.0742\n0.0693\n0.0520\n0.0534\n0.0403\n0.0514\n0.0809\n0.0715\n0.0627\n0.0429\n0.0332\n0.0560\n0.0332\n0.0332\n0.0339\n0.1084\n0.0512\n0.1119\n0.0655\n...\n0.0646\n0.0603\n0.0560\n0.0560\n0.0422\n0.0415\n0.0461\n0.0464\n0.0523\n0.0521\n0.0826\n0.0560\n0.0831\n0.0928\n0.0635\n0.0592\n0.0389\n0.0457\n0.0251\n0.0251\n0.0270\n0.1013\n1.0\n0.0\n0.1013\n1.0\n0.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\nACVR2A\n0.0415\n0.0481\n0.0584\n0.0489\n0.0578\n0.0578\n0.0598\n0.0625\n0.0596\n0.0521\n0.0600\n0.0578\n0.0803\n0.0570\n0.0510\n0.0475\n0.0430\n0.0536\n0.0888\n0.0789\n0.0783\n0.0783\n0.0760\n0.0466\n0.0549\n0.0555\n0.0551\n0.0549\n0.0549\n0.0543\n0.0526\n0.0520\n0.0576\n0.0619\n0.0586\n0.0754\n0.0551\n0.0406\n0.0457\n0.0482\n0.0501\n0.1040\n0.0869\n0.0809\n0.0809\n0.0681\n0.0502\n0.0653\n0.0537\n0.0588\n...\n0.0498\n0.0517\n0.0563\n0.0563\n0.0516\n0.0563\n0.0512\n0.0662\n0.0523\n0.0579\n0.0800\n0.0573\n0.0527\n0.0491\n0.0616\n0.0556\n0.0640\n0.0640\n0.0703\n0.0703\n0.0589\n0.9833\n1.0\n0.0\n0.9833\n1.0\n0.0\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nYES1\n0.0677\n0.0571\n0.0537\n0.0530\n0.0527\n0.0505\n0.0435\n0.0375\n0.0400\n0.0463\n0.0478\n0.0478\n0.0419\n0.0564\n0.0681\n0.0647\n0.0610\n0.0752\n0.0748\n0.0610\n0.0652\n0.0652\n0.0668\n0.0625\n0.0695\n0.0524\n0.0530\n0.0470\n0.0404\n0.0476\n0.0416\n0.0528\n0.0529\n0.0406\n0.0406\n0.0424\n0.0566\n0.0549\n0.0561\n0.0607\n0.0559\n0.0786\n0.0875\n0.0596\n0.0596\n0.0705\n0.0564\n0.0580\n0.0456\n0.0572\n...\n0.0464\n0.0747\n0.0521\n0.0561\n0.0468\n0.0452\n0.0481\n0.0716\n0.0689\n0.0689\n0.0619\n0.0623\n0.0587\n0.0757\n0.0652\n0.0499\n0.0421\n0.0492\n0.0371\n0.0371\n0.0467\n0.0000\n0.0\n1.0\n0.0000\n0.0\n1.0\n0.0762\n0.0532\n0.0533\n0.0610\n0.0596\n0.0558\n0.0416\n0.0375\n0.0467\n0.0518\n0.0627\n0.0627\n0.0456\n0.0593\n0.0662\n0.084\n0.0559\n0.0604\n0.0422\n0.0482\n0.0374\n0.0374\n0.0411\n\n\nZAP70\n0.0602\n0.0880\n0.0623\n0.0496\n0.0471\n0.0514\n0.0465\n0.0380\n0.0307\n0.0526\n0.0479\n0.0479\n0.0347\n0.0641\n0.0471\n0.0452\n0.0492\n0.0703\n0.0870\n0.0777\n0.1622\n0.1622\n0.1208\n0.0977\n0.0792\n0.0865\n0.0556\n0.0487\n0.0367\n0.0375\n0.0312\n0.0317\n0.0344\n0.0274\n0.0274\n0.0347\n0.0474\n0.0338\n0.0380\n0.0571\n0.0457\n0.0929\n0.1392\n0.1432\n0.1432\n0.1685\n0.0588\n0.0610\n0.0537\n0.0581\n...\n0.0491\n0.0520\n0.0583\n0.0530\n0.0504\n0.0304\n0.0424\n0.0554\n0.0393\n0.0393\n0.0539\n0.0671\n0.0562\n0.0557\n0.0712\n0.0406\n0.0597\n0.0558\n0.0440\n0.0440\n0.0318\n0.0000\n0.0\n1.0\n0.0000\n0.0\n1.0\n0.1269\n0.0904\n0.0737\n0.0457\n0.0638\n0.0692\n0.0343\n0.0235\n0.0305\n0.0461\n0.0343\n0.0343\n0.0344\n0.0484\n0.0477\n0.029\n0.0520\n0.0537\n0.0709\n0.0710\n0.0862\n0.0862\n0.0605\n\n\n\n\n396 rows × 236 columns\n\n\n\n\n\n\nget_pspa_raw\n\ndef get_pspa_raw(\n    include_s:bool=False, # pS is duplicate of pT\n)-&gt;DataFrame:\n\nGet PSPA raw data of serine/threonine and tyrosine kinases. pS is duplicate of pT;\n\n\n\nget_pspa_scale\n\ndef get_pspa_scale(\n    \n):\n\nGet PSPA (-5 to +4) scaled data from PSPA normalized data.  Each position (including both pS/pT and pS=pT) are normalized to 1.\n\nData.get_pspa_scale()\n\n\n\n\n\n\n\n\n-5P\n-5G\n-5A\n-5C\n-5S\n-5T\n-5V\n-5I\n-5L\n-5M\n-5F\n-5Y\n-5W\n-5H\n-5K\n-5R\n-5Q\n-5N\n-5D\n-5E\n-5s\n-5t\n-5y\n-4P\n-4G\n-4A\n-4C\n-4S\n-4T\n-4V\n-4I\n-4L\n-4M\n-4F\n-4Y\n-4W\n-4H\n-4K\n-4R\n-4Q\n-4N\n-4D\n-4E\n-4s\n-4t\n-4y\n-3P\n-3G\n-3A\n-3C\n...\n2E\n2s\n2t\n2y\n3P\n3G\n3A\n3C\n3S\n3T\n3V\n3I\n3L\n3M\n3F\n3Y\n3W\n3H\n3K\n3R\n3Q\n3N\n3D\n3E\n3s\n3t\n3y\n4P\n4G\n4A\n4C\n4S\n4T\n4V\n4I\n4L\n4M\n4F\n4Y\n4W\n4H\n4K\n4R\n4Q\n4N\n4D\n4E\n4s\n4t\n4y\n\n\nkinase\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAAK1\n0.05845\n0.01989\n0.02305\n0.03702\n0.03450\n0.03450\n0.07720\n0.12615\n0.08061\n0.07014\n0.03450\n0.07728\n0.02557\n0.02687\n0.02127\n0.07760\n0.04546\n0.02232\n0.01299\n0.01242\n0.01632\n0.01632\n0.04960\n0.04172\n0.05015\n0.05515\n0.04375\n0.04836\n0.04836\n0.04836\n0.04851\n0.05796\n0.05414\n0.04062\n0.04172\n0.03148\n0.04015\n0.06320\n0.05586\n0.04898\n0.03351\n0.02594\n0.04375\n0.02594\n0.02594\n0.02648\n0.08610\n0.04067\n0.08888\n0.05203\n...\n0.04025\n0.03142\n0.03142\n0.03149\n0.05264\n0.07135\n0.04499\n0.05735\n0.04499\n0.04499\n0.04715\n0.02999\n0.03780\n0.03378\n0.03324\n0.04120\n0.03718\n0.05210\n0.05712\n0.06965\n0.04816\n0.05681\n0.03131\n0.02868\n0.02589\n0.02589\n0.02775\n0.05026\n0.05618\n0.05170\n0.04826\n0.04482\n0.04482\n0.03377\n0.03321\n0.03689\n0.03713\n0.04186\n0.04170\n0.06611\n0.04482\n0.06651\n0.07427\n0.05082\n0.04738\n0.03113\n0.03657\n0.02009\n0.02009\n0.02161\n\n\nACVR2A\n0.02971\n0.03443\n0.04180\n0.03500\n0.04137\n0.04137\n0.04281\n0.04474\n0.04266\n0.03729\n0.04295\n0.04137\n0.05748\n0.04080\n0.03651\n0.03400\n0.03078\n0.03837\n0.06356\n0.05648\n0.05605\n0.05605\n0.05440\n0.03341\n0.03936\n0.03979\n0.03950\n0.03936\n0.03936\n0.03893\n0.03771\n0.03728\n0.04130\n0.04438\n0.04201\n0.05406\n0.03950\n0.02911\n0.03276\n0.03456\n0.03592\n0.07456\n0.06230\n0.05800\n0.05800\n0.04882\n0.03345\n0.04351\n0.03578\n0.03918\n...\n0.04447\n0.04786\n0.04786\n0.03799\n0.04958\n0.04381\n0.03914\n0.03559\n0.04366\n0.04366\n0.04196\n0.04099\n0.04529\n0.04358\n0.04765\n0.04839\n0.04699\n0.04366\n0.03419\n0.02864\n0.03692\n0.03877\n0.04603\n0.06438\n0.03840\n0.03840\n0.06031\n0.05559\n0.03989\n0.03652\n0.03791\n0.04129\n0.04129\n0.03784\n0.04129\n0.03755\n0.04855\n0.03835\n0.04246\n0.05867\n0.04202\n0.03865\n0.03601\n0.04517\n0.04077\n0.04693\n0.04693\n0.05155\n0.05155\n0.04319\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nYES1\n0.05216\n0.04399\n0.04137\n0.04084\n0.04060\n0.03891\n0.03352\n0.02889\n0.03082\n0.03567\n0.03683\n0.03683\n0.03228\n0.04345\n0.05247\n0.04985\n0.04700\n0.05794\n0.05763\n0.04700\n0.05023\n0.05023\n0.05147\n0.04870\n0.05416\n0.04083\n0.04130\n0.03662\n0.03148\n0.03709\n0.03242\n0.04114\n0.04122\n0.03164\n0.03164\n0.03304\n0.04411\n0.04278\n0.04372\n0.04730\n0.04356\n0.06125\n0.06818\n0.04644\n0.04644\n0.05494\n0.04363\n0.04486\n0.03527\n0.04425\n...\n0.05324\n0.05535\n0.05535\n0.05174\n0.02228\n0.02870\n0.02669\n0.03458\n0.02886\n0.03899\n0.05880\n0.06545\n0.06259\n0.04333\n0.12155\n0.12155\n0.07172\n0.04309\n0.02375\n0.03923\n0.02576\n0.02824\n0.02120\n0.02352\n0.02135\n0.02135\n0.02739\n0.03449\n0.04429\n0.03670\n0.05908\n0.04121\n0.04437\n0.03702\n0.03575\n0.03804\n0.05663\n0.05450\n0.05450\n0.04896\n0.04928\n0.04643\n0.05988\n0.05157\n0.03947\n0.03330\n0.03891\n0.02934\n0.02934\n0.03694\n\n\nZAP70\n0.03902\n0.05704\n0.04038\n0.03215\n0.03053\n0.03332\n0.03014\n0.02463\n0.01990\n0.03410\n0.03105\n0.03105\n0.02249\n0.04155\n0.03053\n0.02930\n0.03189\n0.04557\n0.05639\n0.05037\n0.10514\n0.10514\n0.07830\n0.06354\n0.05151\n0.05625\n0.03616\n0.03167\n0.02387\n0.02439\n0.02029\n0.02062\n0.02237\n0.01782\n0.01782\n0.02257\n0.03083\n0.02198\n0.02471\n0.03713\n0.02972\n0.06041\n0.09052\n0.09313\n0.09313\n0.10958\n0.03211\n0.03331\n0.02933\n0.03173\n...\n0.04035\n0.08151\n0.08151\n0.09746\n0.12355\n0.03982\n0.04552\n0.04723\n0.05148\n0.03701\n0.07326\n0.05267\n0.04518\n0.09377\n0.04374\n0.04374\n0.07471\n0.04476\n0.01838\n0.02042\n0.02961\n0.02357\n0.02051\n0.01293\n0.01719\n0.01719\n0.02374\n0.08125\n0.05210\n0.04054\n0.04294\n0.04814\n0.04376\n0.04162\n0.02510\n0.03501\n0.04574\n0.03245\n0.03245\n0.04450\n0.05540\n0.04640\n0.04599\n0.05879\n0.03352\n0.04929\n0.04607\n0.03633\n0.03633\n0.02626\n\n\n\n\n396 rows × 230 columns\n\n\n\n\n\n\nget_pspa_st_pct\n\ndef get_pspa_st_pct(\n    \n):\n\nGet PSPA reference score to calculate percentile for serine/threonine kinases.\n\nData.get_pspa_st_pct()\n\n\n\n\n\n\n\nkinase\nAAK1\nACVR2A\nACVR2B\nAKT1\nAKT2\nAKT3\nALK2\nALK4\nALPHAK3\nAMPKA1\nAMPKA2\nANKRD3\nASK1\nATM\nATR\nAURA\nAURB\nAURC\nBCKDK\nBIKE\nBMPR1A\nBMPR1B\nBMPR2\nBRAF\nBRSK1\nBRSK2\nBUB1\nCAMK1A\nCAMK1B\nCAMK1D\nCAMK1G\nCAMK2A\nCAMK2B\nCAMK2D\nCAMK2G\nCAMK4\nCAMKK1\nCAMKK2\nCAMLCK\nCDC7\nCDK1\nCDK10\nCDK12\nCDK13\nCDK14\nCDK16\nCDK17\nCDK18\nCDK19\nCDK2\n...\nRIPK1\nRIPK2\nRIPK3\nROCK1\nROCK2\nRSK2\nRSK3\nRSK4\nSBK\nSGK1\nSGK3\nSIK\nSKMLCK\nSLK\nSMG1\nSMMLCK\nSNRK\nSRPK1\nSRPK2\nSRPK3\nSSTK\nSTK33\nSTLK3\nTAK1\nTAO1\nTAO2\nTAO3\nTBK1\nTGFBR1\nTGFBR2\nTLK1\nTLK2\nTNIK\nTSSK1\nTSSK2\nTTBK1\nTTBK2\nTTK\nULK1\nULK2\nVRK1\nVRK2\nWNK1\nWNK3\nWNK4\nYANK2\nYANK3\nYSK1\nYSK4\nZAK\n\n\n\n\n0\n-10.960\n-0.581\n0.329\n-3.891\n-3.591\n-5.312\n0.814\n-0.559\n-0.933\n-2.607\n-3.167\n-0.764\n-6.366\n2.533\n0.010\n-1.164\n-4.296\n-4.302\n1.695\n-7.684\n1.713\n1.965\n0.183\n0.018\n-0.379\n-3.219\n-9.801\n-3.750\n0.149\n-0.610\n-2.746\n4.377\n4.940\n0.902\n2.957\n-2.297\n-3.196\n-3.469\n-1.716\n-0.232\n-1.378\n-9.497\n-5.727\n-4.521\n-8.698\n-7.186\n-5.666\n-5.802\n-4.029\n-4.039\n...\n-3.605\n-5.763\n-5.047\n-6.065\n-4.406\n-1.298\n-3.001\n-0.837\n-2.256\n-3.190\n-3.763\n-0.262\n-0.226\n-3.190\n-1.971\n-3.519\n-4.495\n-3.007\n-2.348\n-3.560\n-4.580\n-6.610\n-6.038\n-1.211\n-4.498\n-2.911\n0.463\n-1.287\n0.680\n-3.707\n1.479\n3.406\n-3.950\n-2.172\n-2.109\n-7.773\n-4.765\n-5.262\n-3.549\n-2.822\n-4.682\n-2.854\n-1.669\n-1.527\n-2.965\n-2.877\n-1.792\n-6.283\n-1.715\n-3.204\n\n\n1\n-6.788\n-0.166\n0.307\n-5.886\n-4.786\n-6.576\n1.561\n-0.865\n-3.399\n-3.261\n-3.464\n-4.366\n-7.176\n0.019\n-0.697\n-1.581\n-4.628\n-4.533\n-1.092\n-5.161\n1.202\n1.525\n-0.386\n-3.377\n-1.858\n-3.819\n-5.141\n-5.537\n-1.294\n-3.311\n-5.862\n-0.315\n0.517\n-0.535\n0.877\n-3.692\n-1.182\n-1.239\n-1.285\n2.578\n-4.304\n-7.431\n-4.146\n-3.498\n-6.062\n-5.981\n-5.925\n-5.136\n-4.122\n-3.122\n...\n-2.358\n-5.160\n-3.075\n-7.793\n-6.160\n-1.518\n-2.279\n-2.877\n-2.437\n-5.513\n-6.566\n-4.297\n-0.846\n-7.367\n1.751\n-4.481\n-5.585\n-4.549\n-5.719\n-5.101\n-2.420\n-6.698\n-8.190\n-4.619\n-8.130\n-4.908\n-5.247\n-1.650\n1.537\n-4.228\n-5.881\n-4.427\n-7.145\n-2.825\n-0.935\n-4.638\n-3.624\n-9.189\n-4.698\n-3.656\n-5.670\n-2.817\n-4.071\n-3.394\n-5.097\n-1.874\n-1.480\n-8.709\n-3.708\n-6.093\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n89782\n-3.753\n1.451\n1.883\n-5.583\n-5.253\n-7.164\n1.226\n-0.399\n3.341\n-5.932\n-7.009\n-1.346\n-1.257\n-1.930\n-1.086\n-5.300\n-6.268\n-6.415\n-6.027\n-2.674\n2.403\n3.097\n0.315\n0.331\n-8.989\n-9.727\n-0.962\n-6.574\n-2.149\n-5.753\n-6.502\n-3.379\n-3.798\n-4.577\n-2.381\n-5.040\n-0.197\n-0.772\n-1.802\n-0.784\n-1.720\n-6.366\n-3.784\n-2.870\n-4.482\n-2.392\n-2.803\n-2.889\n-3.985\n-2.087\n...\n-5.479\n-5.107\n-5.028\n-4.316\n-3.410\n-4.957\n-5.244\n-5.152\n-5.324\n-5.636\n-5.262\n-5.684\n-3.825\n-1.824\n-3.824\n-4.159\n-6.882\n-4.014\n-4.454\n-3.755\n-8.207\n-5.581\n-2.655\n1.240\n-2.303\n-0.338\n0.146\n-3.978\n0.138\n-3.302\n-3.075\n-1.497\n-1.209\n-6.844\n-5.322\n-4.496\n-2.852\n-1.356\n-3.828\n-3.049\n-1.930\n-1.420\n-5.949\n-4.854\n-5.401\n-1.853\n-2.068\n-2.824\n-0.340\n-1.326\n\n\n89783\n-1.540\n-2.180\n-2.014\n-2.416\n-0.592\n-1.364\n-3.320\n-0.826\n-4.438\n-1.393\n-2.058\n-2.101\n-2.838\n-3.597\n-0.664\n-4.098\n-1.564\n-2.006\n-5.130\n-2.428\n-3.192\n-2.013\n-0.868\n-2.795\n-5.958\n-6.211\n-0.309\n-1.495\n0.020\n-1.378\n-1.652\n-2.380\n-3.275\n-3.026\n-2.647\n-1.958\n-5.024\n-3.868\n0.578\n-2.915\n-3.348\n-4.227\n-5.020\n-5.209\n-1.570\n-2.480\n-2.677\n-2.574\n-5.737\n-5.213\n...\n-1.942\n-6.158\n-0.930\n-1.559\n-0.154\n0.361\n-0.754\n-0.276\n-3.035\n-1.083\n-0.965\n-3.652\n1.355\n-0.824\n-3.360\n-0.030\n-5.503\n-2.102\n-4.456\n-3.284\n-2.001\n-3.563\n-4.212\n-4.696\n-4.132\n-2.436\n-2.292\n-3.454\n-2.188\n-2.436\n-2.339\n-1.988\n-1.042\n-0.358\n-0.074\n-2.837\n-1.059\n0.434\n-5.814\n-4.250\n-1.979\n-0.661\n-2.586\n-4.076\n-2.832\n-0.575\n-0.859\n-2.415\n-2.999\n-2.550\n\n\n\n\n89784 rows × 303 columns\n\n\n\n\n\n\nget_pspa_tyr_pct\n\ndef get_pspa_tyr_pct(\n    \n):\n\nGet PSPA reference score to calculate percentile for tyrosine kinases.\n\nData.get_pspa_tyr_pct()\n\n\n\n\n\n\n\nkinase\nABL1\nTNK2\nALK\nABL2\nAXL\nBLK\nBMPR2_TYR\nPTK6\nBTK\nCSF1R\nCSK\nMATK\nDDR1\nDDR2\nEGFR\nEPHA1\nEPHA2\nEPHA3\nEPHA4\nEPHA5\nEPHA6\nEPHA7\nEPHA8\nEPHB1\nEPHB2\nEPHB3\nEPHB4\nBMX\nPTK2\nFER\nFES\nFGFR1\nFGFR2\nFGFR3\nFGFR4\nFGR\nFLT3\nFRK\nFYN\nHCK\nERBB2\nERBB4\nIGF1R\nINSR\nINSRR\nITK\nJAK1\nJAK2\nJAK3\nKIT\nLCK\nLIMK1_TYR\nLIMK2_TYR\nLTK\nLYN\nMERTK\nMET\nMAP2K4_TYR\nMAP2K6_TYR\nMAP2K7_TYR\nMST1R\nMUSK\nPKMYT1_TYR\nNEK10_TYR\nPDGFRA\nPDGFRB\nPDHK1_TYR\nPDHK3_TYR\nPDHK4_TYR\nPINK1_TYR\nPTK2B\nRET\nROS1\nSRC\nSRMS\nSYK\nTEC\nTESK1_TYR\nTEK\nTNK1\nTNNI3K_TYR\nNTRK1\nNTRK2\nNTRK3\nTXK\nTYK2\nTYRO3\nFLT1\nKDR\nFLT4\nWEE1_TYR\nYES1\nZAP70\n\n\n\n\n0\n-0.709617\n-3.624831\n-2.136338\n-0.022776\n-0.737589\n2.345905\n0.504821\n2.417165\n-0.121611\n-1.205218\n1.576014\n1.917812\n-2.449589\n-3.806540\n1.005984\n-2.925415\n-0.609664\n-1.256237\n0.491093\n0.494654\n-1.348782\n-1.938472\n0.221994\n-0.805070\n1.130282\n0.111910\n-0.253774\n0.221683\n2.233854\n2.295975\n-0.025152\n-1.738376\n-0.986921\n-0.375908\n1.631896\n2.154664\n-1.214864\n-1.185009\n6.124421\n1.940066\n-1.020647\n-0.292182\n0.761946\n-0.992736\n-0.599703\n0.298515\n-4.146873\n-2.339013\n-2.479359\n-1.082389\n1.758755\n-3.027934\n-3.701494\n-0.480120\n1.346726\n1.124192\n-1.205155\n-0.094138\n1.031112\n-0.287930\n-2.589829\n-3.379800\n-1.341062\n-3.607123\n-4.385381\n-1.978546\n1.390759\n0.259191\n0.378106\n-0.094980\n0.908537\n-0.618981\n-2.562691\n4.377146\n1.855049\n2.017083\n-0.572871\n-2.295149\n-2.833113\n-3.811383\n-6.262204\n0.683287\n-0.626250\n-0.368491\n1.187208\n-1.601712\n-1.143748\n-0.891566\n-1.888643\n-1.758264\n-1.610344\n4.545175\n0.280174\n\n\n1\n0.986158\n-1.645273\n-1.183920\n0.553010\n-1.098784\n-1.245678\n-0.276461\n-0.156496\n-1.322652\n-0.684989\n0.447463\n0.054841\n-0.295641\n-2.374194\n0.261968\n-0.444003\n0.620075\n-0.918899\n-0.266802\n-1.466189\n0.181707\n-0.884474\n-0.829816\n-1.039152\n-1.332577\n-1.553626\n-1.557679\n-1.041167\n-1.465569\n-0.573358\n-1.402839\n-1.119166\n-0.006615\n-0.690700\n0.057757\n-1.329587\n-0.752020\n-1.421231\n-1.119607\n-0.361730\n-0.067540\n-1.488971\n-1.959423\n-1.198227\n-1.250944\n-1.559043\n-1.742221\n-0.297813\n-0.737524\n0.101179\n-0.785122\n-0.803239\n-0.227134\n-0.226996\n-1.061925\n-0.749321\n-0.324825\n0.101380\n-0.753605\n-0.186826\n-0.078232\n-1.533730\n-0.949200\n1.335091\n-0.953302\n-1.471499\n-0.039170\n0.376709\n-0.653393\n-0.690604\n-0.187336\n0.372630\n-1.753648\n-0.822064\n0.291210\n-1.380433\n-0.652058\n-0.974885\n-2.822036\n-1.223497\n-2.903235\n-0.909811\n-1.158577\n-0.777541\n-0.385554\n-0.624216\n-0.737089\n-0.315447\n-1.293708\n-1.182827\n-1.891533\n-0.456570\n-2.465316\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n7313\n0.737694\n-0.477689\n-0.646850\n0.928066\n0.187149\n-1.000041\n-0.283551\n-3.053869\n-0.750475\n0.132043\n0.069439\n0.778468\n-0.572751\n-0.877774\n0.279656\n-1.905299\n-2.542936\n-0.629488\n-1.433432\n-1.319311\n-0.959149\n-1.904233\n-1.836303\n-0.665941\n-0.500875\n-1.140260\n-0.324883\n-0.138589\n-1.634647\n-1.463951\n-2.856428\n1.338733\n1.308337\n1.210296\n0.236992\n-1.117447\n0.508686\n-1.152320\n-0.680328\n-1.311162\n-1.278938\n-0.529947\n-0.707274\n-0.296606\n0.170371\n-0.406315\n0.053109\n-0.184986\n1.285550\n-1.175831\n-0.657466\n-0.059045\n-0.307151\n-0.027580\n-1.925899\n0.415170\n0.535199\n-0.446664\n0.591918\n0.316993\n0.457042\n0.960955\n-1.222173\n0.783990\n-0.043431\n1.226039\n0.035492\n0.102904\n0.600526\n0.732808\n-1.478030\n1.261671\n0.460373\n-1.074805\n-1.293450\n-1.402257\n-0.780591\n-0.107376\n-0.479018\n1.326369\n-1.912418\n-0.017800\n0.585871\n-0.122134\n-1.275022\n-0.020350\n0.483620\n-0.060204\n1.378042\n0.573273\n-2.383657\n-0.246005\n1.174693\n\n\n7314\n2.115113\n0.153795\n0.356357\n1.846239\n-0.856035\n-0.422296\n-0.985140\n0.554181\n0.381133\n-1.666383\n-0.728353\n-0.254733\n-0.999583\n0.117162\n-1.622541\n-1.882815\n-3.830351\n-1.601071\n-1.750483\n-2.748548\n-0.900263\n-1.661417\n-2.349142\n-0.825704\n-1.211989\n-1.668258\n-0.242232\n0.727625\n-2.099673\n0.240011\n-0.659603\n-1.569382\n-1.979445\n-2.605414\n-1.726131\n0.175403\n-2.030979\n-0.537023\n-0.303194\n-0.134410\n-1.497615\n-2.364148\n-3.279693\n-1.919277\n-2.157962\n0.598978\n-0.792918\n-0.965011\n-1.728287\n-1.616595\n-0.084054\n-0.968384\n-0.373329\n-0.234884\n-1.088861\n-1.129566\n-0.358743\n0.154190\n-0.787745\n-0.482053\n-1.581810\n-1.865008\n-0.707663\n-0.049274\n-1.190498\n-1.403224\n-0.849104\n-0.212996\n-0.159123\n-0.885066\n0.447393\n-0.121666\n-0.543588\n0.170109\n0.044321\n-1.576300\n1.325049\n-1.122959\n-2.962076\n-0.786136\n-1.090242\n-1.402034\n-1.365117\n-1.670434\n1.684176\n-0.508297\n-0.304215\n-2.045909\n-1.629804\n-2.227050\n-2.294855\n0.428825\n-1.789086\n\n\n\n\n7315 rows × 93 columns\n\n\n\n\n\n\nget_num_dict\n\ndef get_num_dict(\n    \n):\n\nGet a dictionary mapping kinase to number of random amino acids in PSPA.\n\nlist(Data.get_num_dict().items())[:5]\n\n[('SYK', 18), ('PTK2', 18), ('ZAP70', 18), ('ERBB2', 18), ('CSK', 18)]\n\n\n\n\nCDDM data\n\n\n\nData.get_ks_unique\n\ndef get_ks_unique(\n    \n):\n\nGet kinase substrate dataset with unique sub site ID.\n\nData.get_ks_unique()\n\n\n\n\n\n\n\n\nsub_site\nnum_kin\nbin\nsub_genes\nsite_seq\nsource_combine\nacceptor\nO00141_SGK1\nO00238_BMPR1B\nO00311_CDC7\nO00329_PIK3CD\nO00418_EEF2K\nO00443_PIK3C2A\nO00444_PLK4\nO00506_STK25\nO14578_CIT\nO14730_RIOK3\nO14733_MAP2K7\nO14757_CHEK1\nO14874_BCKDK\nO14920_IKBKB\nO14936_CASK\nO14965_AURKA\nO14976_GAK\nO15021_MAST4\nO15075_DCLK1\nO15111_CHUK\nO15146_MUSK\nO15264_MAPK13\nO15530_PDPK1\nO43283_MAP3K13\nO43293_DAPK3\nO43318_MAP3K7\nO43353_RIPK2\nO43683_BUB1\nO43781_DYRK3\nO60285_NUAK1\nO60331_PIP5K1C\nO60566_BUB1B\nO60674_JAK2\nO60885_BRD4\nO75116_ROCK2\nO75385_ULK1\nO75460_ERN1\nO75582_RPS6KA5\nO75676_RPS6KA4\nO75716_STK16\nO75914_PAK3\nO76039_CDKL5\nO94768_STK17B\n...\nQ9HBY8_SGK2\nQ9HC98_NEK6\nQ9HCP0_CSNK1G1\nQ9NQU5_PAK6\nQ9NR20_DYRK4\nQ9NRA0_SPHK2\nQ9NRM7_LATS2\nQ9NSY1_BMP2K\nQ9NWZ3_IRAK4\nQ9NYA1_SPHK1\nQ9NYL2_MAP3K20\nQ9NYV4_CDK12\nQ9NYY3_PLK2\nQ9NZJ5_EIF2AK3\nQ9P0L2_MARK1\nQ9P1W9_PIM2\nQ9P286_PAK5\nQ9P289_STK26\nQ9P2K8_EIF2AK4\nQ9UBE8_NLK\nQ9UBS0_RPS6KB2\nQ9UEE5_STK17A\nQ9UEW8_STK39\nQ9UF33_EPHA6\nQ9UHD2_TBK1\nQ9UIG0_BAZ1B\nQ9UIK4_DAPK2\nQ9UK32_RPS6KA6\nQ9UKE5_TNIK\nQ9UKI8_TLK1\nQ9UL54_TAOK2\nQ9UM73_ALK\nQ9UPE1_SRPK3\nQ9UPZ9_CILK1\nQ9UQ07_MOK\nQ9UQ88_CDK11A\nQ9UQB9_AURKC\nQ9UQM7_CAMK2A\nQ9Y243_AKT3\nQ9Y2H1_STK38L\nQ9Y2K2_SIK3\nQ9Y2U5_MAP3K2\nQ9Y3S1_WNK2\nQ9Y463_DYRK1B\nQ9Y4K4_MAP4K5\nQ9Y572_RIPK3\nQ9Y5S2_CDC42BPB\nQ9Y6E0_STK24\nQ9Y6M4_CSNK1G3\nQ9Y6R4_MAP3K4\n\n\n\n\n0\nA0A2R8Y4L2_S158\n1\n1\nHNRNPA1L3 HNRNPA1P48\nTDRGSGKKRGFAFVTFDDHDsVDKIVIQKYHTVNGHNCEVR\nSugiyama\nS\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n1\nA0A2R8Y4L2_S22\n3\n2~10\nHNRNPA1L3 HNRNPA1P48\nSKSEsPKEPEQLRKLFIGGLsFEtTDESLRSHFEQWGTLTD\nSugiyama\nS\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n29809\nQ9Y6Y9_Y131\n1\n1\nLY96 ESOP1 MD2\nETVNTTISFSFKGIKFSKGKyKCVVEAISGSPEEMLFCLEF\nNon-Sugiyama\nY\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n29810\nQ9Y6Y9_Y22\n1\n1\nLY96 ESOP1 MD2\nLPFLFFSTLFSSIFTEAQKQyWVCNSSDASISYTYCDKMQY\nNon-Sugiyama\nY\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n29811 rows × 462 columns\n\n\n\n\n\n\nData.get_ks_dataset\n\ndef get_ks_dataset(\n    add_kinase_info:bool=True\n):\n\nGet kinase–substrate dataset collected from public resources, with the option of enriching with kinase info.\n\nData.get_ks_dataset()\n\n\n\n\n\n\n\n\nkin_sub_site\nkinase_uniprot\nsubstrate_uniprot\nsite\nsource\nsubstrate_genes\nsubstrate_phosphoseq\nposition\nsite_seq\nsub_site\nsubstrate_sequence\nkinase_on_tree\nkinase_genes\nkinase_group\nkinase_family\nkinase_subfamily\nkinase_pspa_big\nkinase_pspa_small\nkinase_coral_ID\nkinase_protein\nnum_kin\n\n\n\n\n0\nO00141_A4FU28_S140\nO00141\nA4FU28\nS140\nSugiyama\nCTAGE9\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n140\nAAAEEARSLEATCEKLSRsNsELEDEILCLEKDLKEEKSKH\nA4FU28_S140\nMEEPGATPQPYLGLVLEELGRVVAALPESMRPDENPYGFPSELVVC...\n1\nSGK1 SGK\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\nSGK1\n22\n\n\n1\nO00141_O00141_S252\nO00141\nO00141\nS252\nSugiyama\nSGK1 SGK\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n252\nSQGHIVLTDFGLCKENIEHNsTtstFCGtPEyLAPEVLHKQ\nO00141_S252\nMTVKTEAAKGTLTYSRMRGMVAILIAFMKQRRMGLNDFIQKIANNS...\n1\nSGK1 SGK\nAGC\nSGK\nSGK\nBasophilic\nAkt/rock\nSGK1\nSGK1\n1\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n187064\nQ9Y6R4_Q9Y6R4_T1494\nQ9Y6R4\nQ9Y6R4\nT1494\nSIGNOR|EPSD|PSP\nMAP3K4 KIAA0213 MAPKKK4 MEKK4 MTK1\nMREAAAALVPPPAFAVTPAAAMEEPPPPPPPPPPPPEPETESEPEC...\n1494\nSGLIKLGDFGCSVKLKNNAQtMPGEVNSTLGTAAYMAPEVI\nQ9Y6R4_T1494\nMREAAAALVPPPAFAVTPAAAMEEPPPPPPPPPPPPEPETESEPEC...\n1\nMAP3K4 KIAA0213 MAPKKK4 MEKK4 MTK1\nSTE\nSTE11\nSTE11\nNaN\nNaN\nMAP3K4\nMAP3K4\n1\n\n\n187065\nQ9Y6R4_Q9Y6R4_Y1328\nQ9Y6R4\nQ9Y6R4\nY1328\nSugiyama\nMAP3K4 KIAA0213 MAPKKK4 MEKK4 MTK1\nMREAAAALVPPPAFAVTPAAAMEEPPPPPPPPPPPPEPETESEPEC...\n1328\nRYREMRRKNIIGQVCDtPKSyDNVMHVGLRKVTFKWQRGNK\nQ9Y6R4_Y1328\nMREAAAALVPPPAFAVTPAAAMEEPPPPPPPPPPPPEPETESEPEC...\n1\nMAP3K4 KIAA0213 MAPKKK4 MEKK4 MTK1\nSTE\nSTE11\nSTE11\nNaN\nNaN\nMAP3K4\nMAP3K4\n1\n\n\n\n\n187066 rows × 21 columns\n\n\n\n\n\n\nget_ks_background\n\ndef get_ks_background(\n    \n):\n\nGet kinase substrate dataset with unique sub site ID.\n\nData.get_ks_background()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\nindex\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nks_S\n0.074296\n0.068105\n0.075925\n0.014664\n0.053246\n0.038517\n0.051290\n0.040342\n0.078989\n0.020269\n0.028806\n0.016228\n0.008081\n0.023266\n0.068952\n0.056765\n0.046728\n0.036301\n0.053506\n0.082573\n0.041645\n0.015511\n0.005996\n0.067780\n0.069925\n0.072069\n0.012867\n0.056343\n0.036392\n0.049454\n0.038472\n0.084546\n0.022550\n0.025994\n0.017611\n0.008773\n0.020665\n0.066220\n0.065181\n0.048739\n0.038991\n0.052963\n0.079218\n0.042566\n0.016246\n0.006434\n0.065772\n0.069725\n0.072771\n0.012960\n...\n0.082005\n0.043003\n0.014401\n0.006134\n0.068513\n0.069249\n0.073398\n0.012980\n0.056336\n0.037803\n0.050114\n0.035996\n0.080222\n0.018801\n0.030510\n0.014720\n0.009635\n0.023752\n0.071056\n0.061087\n0.046434\n0.037535\n0.053258\n0.082363\n0.044627\n0.015656\n0.005955\n0.070061\n0.067710\n0.072412\n0.015181\n0.053469\n0.036676\n0.058910\n0.037885\n0.084906\n0.018338\n0.030093\n0.017935\n0.007926\n0.021294\n0.070330\n0.059313\n0.044200\n0.036273\n0.054880\n0.077316\n0.043461\n0.014980\n0.006449\n\n\nks_T\n0.061634\n0.065896\n0.074266\n0.016436\n0.043829\n0.034394\n0.059656\n0.040177\n0.089484\n0.024806\n0.033024\n0.019175\n0.010501\n0.020088\n0.072896\n0.056460\n0.042764\n0.035002\n0.065287\n0.076548\n0.028915\n0.018566\n0.010196\n0.060989\n0.072395\n0.072395\n0.013840\n0.046388\n0.036502\n0.062662\n0.040913\n0.081217\n0.024183\n0.031787\n0.016730\n0.007452\n0.019468\n0.080152\n0.059468\n0.044715\n0.034981\n0.055057\n0.083498\n0.033916\n0.015665\n0.005627\n0.063562\n0.070692\n0.069326\n0.015777\n...\n0.086112\n0.037420\n0.017222\n0.011116\n0.059683\n0.067222\n0.073033\n0.012879\n0.044605\n0.034867\n0.054343\n0.043191\n0.082142\n0.017905\n0.031255\n0.018847\n0.009267\n0.021988\n0.076174\n0.065023\n0.040364\n0.043349\n0.063295\n0.081200\n0.030470\n0.019632\n0.009267\n0.063397\n0.067497\n0.066393\n0.015140\n0.047784\n0.031698\n0.053304\n0.046838\n0.080902\n0.019871\n0.035483\n0.020659\n0.010093\n0.022394\n0.075067\n0.060558\n0.045261\n0.038007\n0.058666\n0.076644\n0.035483\n0.019871\n0.008989\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nhuman_ST_upper\n0.082791\n0.066656\n0.072951\n0.012749\n0.111414\n0.054709\n0.049589\n0.032810\n0.080030\n0.019268\n0.025079\n0.019063\n0.007013\n0.022010\n0.067710\n0.062114\n0.047611\n0.033510\n0.052219\n0.080702\n0.000000\n0.000000\n0.000000\n0.082364\n0.066437\n0.073391\n0.012502\n0.112851\n0.054252\n0.050835\n0.031845\n0.078539\n0.019614\n0.024361\n0.017966\n0.006609\n0.022350\n0.067405\n0.063942\n0.048713\n0.033838\n0.051655\n0.080531\n0.000000\n0.000000\n0.000000\n0.083261\n0.066199\n0.074920\n0.013477\n...\n0.081781\n0.000000\n0.000000\n0.000000\n0.081470\n0.068046\n0.070355\n0.013078\n0.113824\n0.056426\n0.049966\n0.031747\n0.078665\n0.016032\n0.025418\n0.018332\n0.006834\n0.021884\n0.066924\n0.063147\n0.048788\n0.034962\n0.052911\n0.081189\n0.000000\n0.000000\n0.000000\n0.082942\n0.067364\n0.070982\n0.012747\n0.114370\n0.054382\n0.050436\n0.032196\n0.080711\n0.016468\n0.026638\n0.018652\n0.007058\n0.021877\n0.067252\n0.064102\n0.047521\n0.032946\n0.051795\n0.079558\n0.000000\n0.000000\n0.000000\n\n\nhuman_STY_upper\n0.082206\n0.066688\n0.072961\n0.012965\n0.110244\n0.054656\n0.049733\n0.033379\n0.080515\n0.019334\n0.025206\n0.020031\n0.007049\n0.022131\n0.067141\n0.062035\n0.047677\n0.033640\n0.052120\n0.080289\n0.000000\n0.000000\n0.000000\n0.081832\n0.066727\n0.073458\n0.012827\n0.111061\n0.053752\n0.050734\n0.032307\n0.078615\n0.019802\n0.024967\n0.018880\n0.006679\n0.022410\n0.067327\n0.063718\n0.048352\n0.034185\n0.051743\n0.080624\n0.000000\n0.000000\n0.000000\n0.082377\n0.066193\n0.074272\n0.013311\n...\n0.081579\n0.000000\n0.000000\n0.000000\n0.080805\n0.067923\n0.070240\n0.013196\n0.112567\n0.056073\n0.050258\n0.032331\n0.079073\n0.016362\n0.025728\n0.019064\n0.006917\n0.021705\n0.066891\n0.062991\n0.048728\n0.035155\n0.052847\n0.081146\n0.000000\n0.000000\n0.000000\n0.082350\n0.067688\n0.070582\n0.012733\n0.112743\n0.054403\n0.050360\n0.032901\n0.080631\n0.016863\n0.026965\n0.019844\n0.007094\n0.021870\n0.067153\n0.063812\n0.047677\n0.032840\n0.052027\n0.079465\n0.000000\n0.000000\n0.000000\n\n\n\n\n20 rows × 943 columns\n\n\n\n\n\n\nget_cddm\n\ndef get_cddm(\n    \n):\n\nGet the CDDM dataset.\n\nData.get_cddm()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nSRC\n0.054538\n0.081380\n0.060077\n0.012356\n0.036216\n0.032382\n0.055816\n0.052407\n0.083511\n0.023434\n0.031530\n0.023008\n0.005965\n0.018747\n0.082659\n0.058372\n0.051555\n0.039625\n0.059651\n0.071155\n0.022582\n0.020452\n0.022582\n0.048428\n0.075616\n0.085387\n0.017417\n0.035684\n0.029737\n0.056500\n0.052676\n0.079864\n0.024214\n0.032285\n0.019966\n0.011895\n0.019541\n0.081563\n0.061597\n0.044605\n0.036534\n0.064146\n0.071793\n0.025064\n0.012744\n0.012744\n0.054968\n0.069345\n0.066808\n0.015222\n...\n0.080938\n0.030075\n0.011057\n0.010615\n0.052375\n0.071460\n0.064359\n0.017754\n0.047048\n0.035508\n0.052375\n0.050599\n0.091434\n0.024856\n0.041278\n0.015535\n0.011096\n0.015979\n0.064802\n0.066134\n0.047048\n0.035508\n0.062583\n0.074123\n0.028407\n0.011540\n0.018198\n0.05830\n0.085447\n0.064976\n0.012906\n0.041834\n0.039163\n0.043169\n0.050734\n0.074766\n0.032488\n0.040053\n0.018692\n0.008456\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.025367\n0.015576\n0.023142\n\n\nEPHA3\n0.044276\n0.088013\n0.065335\n0.008639\n0.037797\n0.036717\n0.072354\n0.048596\n0.075594\n0.026998\n0.031317\n0.022678\n0.011339\n0.021598\n0.084233\n0.059395\n0.046436\n0.036177\n0.059935\n0.064255\n0.023758\n0.018898\n0.015659\n0.047875\n0.064551\n0.087144\n0.016138\n0.031737\n0.039806\n0.051103\n0.046799\n0.080151\n0.026358\n0.035503\n0.015600\n0.010221\n0.023669\n0.090909\n0.060785\n0.042496\n0.033889\n0.067240\n0.079613\n0.020979\n0.011296\n0.016138\n0.047696\n0.060557\n0.057878\n0.018221\n...\n0.076362\n0.039304\n0.017967\n0.006738\n0.050197\n0.070502\n0.067682\n0.020305\n0.029329\n0.039481\n0.053017\n0.049069\n0.095319\n0.027637\n0.038917\n0.016920\n0.011280\n0.016920\n0.071066\n0.061478\n0.039481\n0.037225\n0.062606\n0.083474\n0.029893\n0.011844\n0.016356\n0.04918\n0.084228\n0.064443\n0.017524\n0.031656\n0.038440\n0.047484\n0.062747\n0.070661\n0.031656\n0.042962\n0.017524\n0.007914\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.025438\n0.013567\n0.015828\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nMAST2\n0.046512\n0.116279\n0.069767\n0.000000\n0.023256\n0.069767\n0.069767\n0.000000\n0.046512\n0.046512\n0.023256\n0.000000\n0.000000\n0.162791\n0.023256\n0.023256\n0.023256\n0.000000\n0.046512\n0.139535\n0.023256\n0.023256\n0.023256\n0.023256\n0.162791\n0.093023\n0.000000\n0.046512\n0.046512\n0.023256\n0.046512\n0.093023\n0.000000\n0.046512\n0.046512\n0.000000\n0.093023\n0.023256\n0.046512\n0.023256\n0.000000\n0.046512\n0.116279\n0.023256\n0.000000\n0.000000\n0.023256\n0.023256\n0.093023\n0.000000\n...\n0.146341\n0.000000\n0.000000\n0.000000\n0.000000\n0.048780\n0.121951\n0.024390\n0.073171\n0.048780\n0.048780\n0.024390\n0.073171\n0.000000\n0.146341\n0.000000\n0.000000\n0.000000\n0.097561\n0.048780\n0.000000\n0.048780\n0.073171\n0.073171\n0.048780\n0.000000\n0.000000\n0.00000\n0.024390\n0.048780\n0.024390\n0.024390\n0.097561\n0.170732\n0.024390\n0.048780\n0.048780\n0.024390\n0.000000\n0.073171\n0.000000\n0.048780\n0.219512\n0.000000\n0.048780\n0.024390\n0.024390\n0.024390\n0.000000\n0.000000\n\n\nBRAF\n0.095238\n0.071429\n0.047619\n0.000000\n0.095238\n0.047619\n0.071429\n0.000000\n0.095238\n0.047619\n0.000000\n0.000000\n0.000000\n0.023810\n0.023810\n0.071429\n0.023810\n0.023810\n0.095238\n0.095238\n0.047619\n0.000000\n0.023810\n0.071429\n0.047619\n0.023810\n0.000000\n0.000000\n0.047619\n0.000000\n0.071429\n0.047619\n0.000000\n0.023810\n0.071429\n0.000000\n0.023810\n0.095238\n0.071429\n0.000000\n0.071429\n0.023810\n0.166667\n0.119048\n0.023810\n0.000000\n0.047619\n0.071429\n0.071429\n0.000000\n...\n0.025000\n0.025000\n0.025000\n0.000000\n0.025000\n0.075000\n0.025000\n0.000000\n0.125000\n0.050000\n0.050000\n0.025000\n0.050000\n0.050000\n0.000000\n0.025000\n0.000000\n0.000000\n0.075000\n0.100000\n0.025000\n0.050000\n0.050000\n0.050000\n0.100000\n0.050000\n0.000000\n0.02500\n0.075000\n0.100000\n0.000000\n0.075000\n0.100000\n0.100000\n0.050000\n0.050000\n0.000000\n0.000000\n0.000000\n0.025000\n0.000000\n0.075000\n0.075000\n0.025000\n0.025000\n0.075000\n0.075000\n0.050000\n0.000000\n0.000000\n\n\n\n\n328 rows × 943 columns\n\n\n\n\n\n\nget_cddm_upper\n\ndef get_cddm_upper(\n    \n):\n\nGet the CDDM dataset of all uppercase sequence.\n\nData.get_cddm_upper()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nSRC\n0.054538\n0.081380\n0.060077\n0.012356\n0.058798\n0.052833\n0.055816\n0.052407\n0.083511\n0.023434\n0.031530\n0.045590\n0.005965\n0.018747\n0.082659\n0.058372\n0.051555\n0.039625\n0.059651\n0.071155\n0.0\n0.0\n0.0\n0.048428\n0.075616\n0.085387\n0.017417\n0.060748\n0.042481\n0.056500\n0.052676\n0.079864\n0.024214\n0.032285\n0.032710\n0.011895\n0.019541\n0.081563\n0.061597\n0.044605\n0.036534\n0.064146\n0.071793\n0.0\n0.0\n0.0\n0.054968\n0.069345\n0.066808\n0.015222\n...\n0.080938\n0.0\n0.0\n0.0\n0.052375\n0.071460\n0.064359\n0.017754\n0.075455\n0.047048\n0.052375\n0.050599\n0.091434\n0.024856\n0.041278\n0.033733\n0.011096\n0.015979\n0.064802\n0.066134\n0.047048\n0.035508\n0.062583\n0.074123\n0.0\n0.0\n0.0\n0.05830\n0.085447\n0.064976\n0.012906\n0.067201\n0.054740\n0.043169\n0.050734\n0.074766\n0.032488\n0.040053\n0.041834\n0.008456\n0.013351\n0.076992\n0.060970\n0.037383\n0.036938\n0.052960\n0.086337\n0.0\n0.0\n0.0\n\n\nEPHA3\n0.044276\n0.088013\n0.065335\n0.008639\n0.061555\n0.055616\n0.072354\n0.048596\n0.075594\n0.026998\n0.031317\n0.038337\n0.011339\n0.021598\n0.084233\n0.059395\n0.046436\n0.036177\n0.059935\n0.064255\n0.0\n0.0\n0.0\n0.047875\n0.064551\n0.087144\n0.016138\n0.052717\n0.051103\n0.051103\n0.046799\n0.080151\n0.026358\n0.035503\n0.031737\n0.010221\n0.023669\n0.090909\n0.060785\n0.042496\n0.033889\n0.067240\n0.079613\n0.0\n0.0\n0.0\n0.047696\n0.060557\n0.057878\n0.018221\n...\n0.076362\n0.0\n0.0\n0.0\n0.050197\n0.070502\n0.067682\n0.020305\n0.059222\n0.051325\n0.053017\n0.049069\n0.095319\n0.027637\n0.038917\n0.033277\n0.011280\n0.016920\n0.071066\n0.061478\n0.039481\n0.037225\n0.062606\n0.083474\n0.0\n0.0\n0.0\n0.04918\n0.084228\n0.064443\n0.017524\n0.057094\n0.052007\n0.047484\n0.062747\n0.070661\n0.031656\n0.042962\n0.033352\n0.007914\n0.014132\n0.083098\n0.059356\n0.031091\n0.033917\n0.056529\n0.100622\n0.0\n0.0\n0.0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nMAST2\n0.046512\n0.116279\n0.069767\n0.000000\n0.046512\n0.093023\n0.069767\n0.000000\n0.046512\n0.046512\n0.023256\n0.023256\n0.000000\n0.162791\n0.023256\n0.023256\n0.023256\n0.000000\n0.046512\n0.139535\n0.0\n0.0\n0.0\n0.023256\n0.162791\n0.093023\n0.000000\n0.069767\n0.046512\n0.023256\n0.046512\n0.093023\n0.000000\n0.046512\n0.046512\n0.000000\n0.093023\n0.023256\n0.046512\n0.023256\n0.000000\n0.046512\n0.116279\n0.0\n0.0\n0.0\n0.023256\n0.023256\n0.093023\n0.000000\n...\n0.146341\n0.0\n0.0\n0.0\n0.000000\n0.048780\n0.121951\n0.024390\n0.121951\n0.048780\n0.048780\n0.024390\n0.073171\n0.000000\n0.146341\n0.000000\n0.000000\n0.000000\n0.097561\n0.048780\n0.000000\n0.048780\n0.073171\n0.073171\n0.0\n0.0\n0.0\n0.00000\n0.024390\n0.048780\n0.024390\n0.048780\n0.097561\n0.170732\n0.024390\n0.048780\n0.048780\n0.024390\n0.000000\n0.073171\n0.000000\n0.048780\n0.219512\n0.000000\n0.048780\n0.024390\n0.024390\n0.0\n0.0\n0.0\n\n\nBRAF\n0.095238\n0.071429\n0.047619\n0.000000\n0.142857\n0.047619\n0.071429\n0.000000\n0.095238\n0.047619\n0.000000\n0.023810\n0.000000\n0.023810\n0.023810\n0.071429\n0.023810\n0.023810\n0.095238\n0.095238\n0.0\n0.0\n0.0\n0.071429\n0.047619\n0.023810\n0.000000\n0.119048\n0.071429\n0.000000\n0.071429\n0.047619\n0.000000\n0.023810\n0.071429\n0.000000\n0.023810\n0.095238\n0.071429\n0.000000\n0.071429\n0.023810\n0.166667\n0.0\n0.0\n0.0\n0.047619\n0.071429\n0.071429\n0.000000\n...\n0.025000\n0.0\n0.0\n0.0\n0.025000\n0.075000\n0.025000\n0.000000\n0.225000\n0.100000\n0.050000\n0.025000\n0.050000\n0.050000\n0.000000\n0.025000\n0.000000\n0.000000\n0.075000\n0.100000\n0.025000\n0.050000\n0.050000\n0.050000\n0.0\n0.0\n0.0\n0.02500\n0.075000\n0.100000\n0.000000\n0.125000\n0.100000\n0.100000\n0.050000\n0.050000\n0.000000\n0.000000\n0.000000\n0.025000\n0.000000\n0.075000\n0.075000\n0.025000\n0.025000\n0.075000\n0.075000\n0.0\n0.0\n0.0\n\n\n\n\n328 rows × 943 columns\n\n\n\n\n\n\nget_cddm_LO\n\ndef get_cddm_LO(\n    \n):\n\nGet CDDM Log-odds data with ‘STY’ background.\n\nData.get_cddm_LO()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nSRC\n-0.298965\n0.245926\n-0.306472\n-0.315249\n-0.436393\n-0.216885\n0.039840\n0.331979\n0.006587\n0.074104\n0.026464\n0.300781\n-0.484863\n-0.234235\n0.238737\n0.035866\n0.173786\n0.112172\n0.062717\n-0.187118\n-0.598455\n0.418275\n1.228850\n-0.394990\n0.116437\n0.241674\n0.270796\n-0.536063\n-0.295952\n0.089650\n0.359646\n-0.082026\n0.078067\n0.157708\n0.196729\n0.443758\n-0.096374\n0.191619\n-0.036922\n-0.065461\n-0.093194\n0.198348\n-0.149715\n-0.521873\n-0.217518\n0.779107\n-0.209860\n0.005564\n-0.061876\n0.087346\n...\n-0.024870\n-0.295180\n-0.362786\n0.382054\n-0.265140\n0.085462\n-0.135241\n0.341197\n-0.144617\n-0.081201\n-0.016493\n0.302052\n0.137508\n0.404226\n0.299088\n-0.066971\n0.165626\n-0.468907\n-0.152143\n0.097919\n0.055576\n-0.162821\n0.125989\n-0.139554\n-0.371114\n-0.369706\n1.148641\n-0.219858\n0.305918\n-0.086212\n-0.217325\n-0.300629\n0.133833\n-0.379744\n0.266731\n-0.143992\n0.691717\n0.259364\n-0.031653\n-0.018293\n-0.661728\n0.104673\n0.041005\n-0.236473\n-0.001987\n-0.082064\n0.136414\n-0.538512\n0.006337\n1.268341\n\n\nEPHA3\n-0.599679\n0.358959\n-0.185427\n-0.831496\n-0.374767\n-0.035616\n0.414240\n0.223052\n-0.137106\n0.278334\n0.016725\n0.279945\n0.441832\n-0.030005\n0.265960\n0.060927\n0.022921\n-0.019164\n0.069583\n-0.334271\n-0.525210\n0.304329\n0.700644\n-0.411559\n-0.111818\n0.271060\n0.160722\n-0.705150\n0.124806\n-0.055189\n0.188981\n-0.076858\n0.200475\n0.294762\n-0.159291\n0.224919\n0.180083\n0.348124\n-0.056065\n-0.135338\n-0.201591\n0.266315\n-0.000554\n-0.778526\n-0.391503\n1.119694\n-0.414603\n-0.189918\n-0.268878\n0.346775\n...\n-0.108833\n0.090914\n0.337630\n-0.273672\n-0.326395\n0.065984\n-0.062604\n0.534849\n-0.826443\n0.071809\n0.001107\n0.257761\n0.197541\n0.557236\n0.214109\n0.056291\n0.189352\n-0.386287\n-0.019033\n-0.007411\n-0.197407\n-0.094701\n0.126509\n0.031850\n-0.297539\n-0.332173\n0.994725\n-0.465271\n0.285190\n-0.098081\n0.223956\n-0.702797\n0.106930\n-0.242274\n0.573323\n-0.225459\n0.654314\n0.360504\n-0.124708\n-0.113799\n-0.579696\n0.214783\n0.002284\n-0.502364\n-0.125070\n0.012040\n0.357301\n-0.534483\n-0.192918\n0.720322\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nMAST2\n-0.528628\n0.760762\n-0.090724\n-20.552054\n-1.075446\n0.890487\n0.361717\n-21.989358\n-0.837785\n1.063081\n-0.412652\n-20.832929\n-19.671043\n2.884025\n-1.590838\n-1.291829\n-0.974740\n-21.805810\n-0.296229\n0.784477\n-0.556038\n0.603650\n1.271267\n-1.453246\n1.222693\n0.365256\n-20.461283\n-0.153747\n0.349399\n-1.190998\n0.180083\n0.138019\n-21.129349\n0.684414\n1.416774\n-19.738124\n2.154697\n-1.618709\n-0.442197\n-1.005072\n-21.893985\n-0.265423\n0.545967\n-0.629882\n-20.498936\n-19.502311\n-1.450868\n-1.570628\n0.415703\n-20.450380\n...\n0.829586\n-21.815323\n-20.439323\n-19.635590\n-22.585576\n-0.465375\n0.786858\n0.799349\n0.492504\n0.376951\n-0.119057\n-0.750758\n-0.183951\n-20.840923\n2.124971\n-20.634048\n-19.916025\n-21.076626\n0.438112\n-0.341170\n-22.110138\n0.295330\n0.351480\n-0.158216\n0.408965\n-20.507940\n-19.646705\n-22.694922\n-1.502811\n-0.499805\n0.700926\n-1.078985\n1.450633\n1.603930\n-0.789927\n-0.760077\n1.278125\n-0.456257\n-20.865612\n3.094973\n-21.010260\n-0.553723\n1.889130\n-22.070431\n0.399205\n-1.200649\n-1.687266\n-0.595170\n-20.564588\n-19.873740\n\n\nBRAF\n0.505319\n0.057744\n-0.641739\n-20.552054\n0.958501\n0.339472\n0.395665\n-21.989358\n0.196162\n1.097028\n-21.561812\n-20.832929\n-19.671043\n0.110618\n-1.556891\n0.327081\n-0.940792\n-0.622702\n0.737718\n0.233462\n0.477909\n-20.545511\n1.305214\n0.165663\n-0.550715\n-1.600796\n-20.461283\n-22.302907\n0.383346\n-22.340159\n0.798993\n-0.828033\n-21.129349\n-0.281638\n2.035683\n-19.738124\n0.188645\n0.415238\n0.176712\n-22.154233\n0.874085\n-1.231475\n1.065341\n1.725993\n0.684172\n-19.502311\n-0.416921\n0.048281\n0.034613\n-20.450380\n...\n-1.719752\n-0.561825\n0.814174\n-19.635590\n-1.332079\n0.155211\n-1.499446\n-20.418525\n1.265094\n0.412575\n-0.083433\n-0.715134\n-0.733289\n1.412574\n-21.677864\n0.619449\n-19.916025\n-21.076626\n0.058698\n0.694454\n-0.856641\n0.330954\n-0.197858\n-0.707554\n1.444589\n1.745557\n-19.646705\n-1.441424\n0.117775\n0.535819\n-20.516947\n0.541601\n1.486257\n0.832199\n0.245697\n-0.724453\n-20.939748\n-21.674130\n-20.865612\n1.545635\n-21.010260\n0.066864\n0.339792\n-0.816934\n-0.565170\n0.419937\n-0.066680\n0.440454\n-20.564588\n-19.873740\n\n\n\n\n328 rows × 943 columns\n\n\n\n\n\n\nget_cddm_LO_upper\n\ndef get_cddm_LO_upper(\n    \n):\n\nGet CDDM Log-odds data of all-uppercase sequence with ‘STY’ background.\n\nData.get_cddm_LO_upper()\n\n\n\n\n\n\n\n\n-20P\n-20G\n-20A\n-20C\n-20S\n-20T\n-20V\n-20I\n-20L\n-20M\n-20F\n-20Y\n-20W\n-20H\n-20K\n-20R\n-20Q\n-20N\n-20D\n-20E\n-20s\n-20t\n-20y\n-19P\n-19G\n-19A\n-19C\n-19S\n-19T\n-19V\n-19I\n-19L\n-19M\n-19F\n-19Y\n-19W\n-19H\n-19K\n-19R\n-19Q\n-19N\n-19D\n-19E\n-19s\n-19t\n-19y\n-18P\n-18G\n-18A\n-18C\n...\n18E\n18s\n18t\n18y\n19P\n19G\n19A\n19C\n19S\n19T\n19V\n19I\n19L\n19M\n19F\n19Y\n19W\n19H\n19K\n19R\n19Q\n19N\n19D\n19E\n19s\n19t\n19y\n20P\n20G\n20A\n20C\n20S\n20T\n20V\n20I\n20L\n20M\n20F\n20Y\n20W\n20H\n20K\n20R\n20Q\n20N\n20D\n20E\n20s\n20t\n20y\n\n\n\n\nSRC\n-0.298965\n0.245926\n-0.306472\n-0.315249\n-0.500805\n-0.002884\n0.039840\n0.331979\n0.006587\n0.074104\n0.026464\n0.687254\n-0.484863\n-0.234235\n0.238737\n0.035866\n0.173786\n0.112172\n0.062717\n-0.187118\n0.0\n0.0\n0.0\n-0.394990\n0.116437\n0.241674\n0.270796\n-0.530225\n-0.272866\n0.089650\n0.359646\n-0.082026\n0.078067\n0.157708\n0.396654\n0.443758\n-0.096374\n0.191619\n-0.036922\n-0.065461\n-0.093194\n0.198348\n-0.149715\n0.0\n0.0\n0.0\n-0.209860\n0.005564\n-0.061876\n0.087346\n...\n-0.024870\n0.0\n0.0\n0.0\n-0.265140\n0.085462\n-0.135241\n0.341197\n-0.234110\n-0.157485\n-0.016493\n0.302052\n0.137508\n0.404226\n0.299088\n0.462480\n0.165626\n-0.468907\n-0.152143\n0.097919\n0.055576\n-0.162821\n0.125989\n-0.139554\n0.0\n0.0\n0.0\n-0.219858\n0.305918\n-0.086212\n-0.217325\n-0.395092\n0.096392\n-0.379744\n0.266731\n-0.143992\n0.691717\n0.259364\n0.542941\n-0.018293\n-0.661728\n0.104673\n0.041005\n-0.236473\n-0.001987\n-0.082064\n0.136414\n0.0\n0.0\n0.0\n\n\nEPHA3\n-0.599679\n0.358959\n-0.185427\n-0.831496\n-0.434706\n0.071154\n0.414240\n0.223052\n-0.137106\n0.278334\n0.016725\n0.437268\n0.441832\n-0.030005\n0.265960\n0.060927\n0.022921\n-0.019164\n0.069583\n-0.334271\n0.0\n0.0\n0.0\n-0.411559\n-0.111818\n0.271060\n0.160722\n-0.734799\n-0.006279\n-0.055189\n0.188981\n-0.076858\n0.200475\n0.294762\n0.353099\n0.224919\n0.180083\n0.348124\n-0.056065\n-0.135338\n-0.201591\n0.266315\n-0.000554\n0.0\n0.0\n0.0\n-0.414603\n-0.189918\n-0.268878\n0.346775\n...\n-0.108833\n0.0\n0.0\n0.0\n-0.326395\n0.065984\n-0.062604\n0.534849\n-0.583601\n-0.031956\n0.001107\n0.257761\n0.197541\n0.557236\n0.214109\n0.442850\n0.189352\n-0.386287\n-0.019033\n-0.007411\n-0.197407\n-0.094701\n0.126509\n0.031850\n0.0\n0.0\n0.0\n-0.465271\n0.285190\n-0.098081\n0.223956\n-0.630220\n0.022506\n-0.242274\n0.573323\n-0.225459\n0.654314\n0.360504\n0.216062\n-0.113799\n-0.579696\n0.214783\n0.002284\n-0.502364\n-0.125070\n0.012040\n0.357301\n0.0\n0.0\n0.0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nMAST2\n-0.528628\n0.760762\n-0.090724\n-20.552054\n-0.838992\n0.813257\n0.361717\n-21.989358\n-0.837785\n1.063081\n-0.412652\n-0.283875\n-19.671043\n2.884025\n-1.590838\n-1.291829\n-0.974740\n-21.805810\n-0.296229\n0.784477\n0.0\n0.0\n0.0\n-1.453246\n1.222693\n0.365256\n-20.461283\n-0.330500\n-0.142089\n-1.190998\n0.180083\n0.138019\n-21.129349\n0.684414\n0.904502\n-19.738124\n2.154697\n-1.618709\n-0.442197\n-1.005072\n-21.893985\n-0.265423\n0.545967\n0.0\n0.0\n0.0\n-1.450868\n-1.570628\n0.415703\n-20.450380\n...\n0.829586\n0.0\n0.0\n0.0\n-22.585576\n-0.465375\n0.786858\n0.799349\n0.458506\n-0.105326\n-0.119057\n-0.750758\n-0.183951\n-20.840923\n2.124971\n-21.223241\n-19.916025\n-21.076626\n0.438112\n-0.341170\n-22.110138\n0.295330\n0.351480\n-0.158216\n0.0\n0.0\n0.0\n-22.694922\n-1.502811\n-0.499805\n0.700926\n-0.857265\n0.930110\n1.603930\n-0.789927\n-0.760077\n1.278125\n-0.456257\n-21.453288\n3.094973\n-21.010260\n-0.553723\n1.889130\n-22.070431\n0.399205\n-1.200649\n-1.687266\n0.0\n0.0\n0.0\n\n\nBRAF\n0.505319\n0.057744\n-0.641739\n-20.552054\n0.779918\n-0.152796\n0.395665\n-21.989358\n0.196162\n1.097028\n-21.561812\n-0.249928\n-19.671043\n0.110618\n-1.556891\n0.327081\n-0.940792\n-0.622702\n0.737718\n0.233462\n0.0\n0.0\n0.0\n0.165663\n-0.550715\n-1.600796\n-20.461283\n0.440412\n0.476821\n-22.340159\n0.798993\n-0.828033\n-21.129349\n-0.281638\n1.523411\n-19.738124\n0.188645\n0.415238\n0.176712\n-22.154233\n0.874085\n-1.231475\n1.065341\n0.0\n0.0\n0.0\n-0.416921\n0.048281\n0.034613\n-20.450380\n...\n-1.719752\n0.0\n0.0\n0.0\n-1.332079\n0.155211\n-1.499446\n-20.418525\n1.342127\n0.930298\n-0.083433\n-0.715134\n-0.733289\n1.412574\n-21.677864\n0.030256\n-19.916025\n-21.076626\n0.058698\n0.694454\n-0.856641\n0.330954\n-0.197858\n-0.707554\n0.0\n0.0\n0.0\n-1.441424\n0.117775\n0.535819\n-20.516947\n0.500287\n0.965734\n0.832199\n0.245697\n-0.724453\n-20.939748\n-21.674130\n-21.453288\n1.545635\n-21.010260\n0.066864\n0.339792\n-0.816934\n-0.565170\n0.419937\n-0.066680\n0.0\n0.0\n0.0\n\n\n\n\n328 rows × 943 columns\n\n\n\n\n\nAmino acid\n\n\n\nData.get_aa_info\n\ndef get_aa_info(\n    \n):\n\nGet amino acid information.\n\nData.get_aa_info()\n\n\n\n\n\n\n\n\nName\nSMILES\nMW\npKa1\npKb2\npKx3\npl4\nH\nVSC\nP1\nP2\nSASA\nNCISC\nphospho\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\nAlanine\nC[C@@H](C(=O)O)N\n89.10\n2.34\n9.69\nNaN\n6.00\n0.62\n27.5\n8.1\n0.046\n1.181\n0.007187\n0\n\n\nC\nCysteine\nC([C@@H](C(=O)O)N)S\n121.16\n1.96\n10.28\n8.18\n5.07\n0.29\n44.6\n5.5\n0.128\n1.461\n-0.036610\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nKac\nAcetyllysine\nCC(=O)NCCCC[C@H](N)C(=O)O\n188.23\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n0\n\n\nKme3\nTrimethyllysine\nC[N+](C)(C)CCCC[C@H](N)C(=O)O\n189.28\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\nNaN\n0\n\n\n\n\n25 rows × 14 columns\n\n\n\n\n\n\nData.get_aa_rdkit\n\ndef get_aa_rdkit(\n    \n):\n\nGet RDKit representations of amino acids.\n\nData.get_aa_rdkit()\n\n\n\n\n\n\n\n\nMaxAbsEStateIndex\nMinAbsEStateIndex\nMinEStateIndex\nqed\nMolWt\nMinPartialCharge\nMaxAbsPartialCharge\nFpDensityMorgan1\nFpDensityMorgan2\nFpDensityMorgan3\nBCUT2D_MWHI\nBCUT2D_MWLOW\nBCUT2D_CHGHI\nBCUT2D_CHGLO\nBCUT2D_LOGPHI\nBCUT2D_LOGPLOW\nBCUT2D_MRLOW\nAvgIpc\nBalabanJ\nBertzCT\nChi0n\nChi0v\nChi1\nChi1v\nChi2n\nChi2v\nChi3n\nChi3v\nChi4n\nChi4v\nHallKierAlpha\nIpc\nKappa1\nKappa2\nKappa3\nPEOE_VSA1\nPEOE_VSA10\nPEOE_VSA11\nPEOE_VSA12\nPEOE_VSA14\nPEOE_VSA2\nPEOE_VSA3\nPEOE_VSA4\nPEOE_VSA6\nPEOE_VSA7\nPEOE_VSA8\nPEOE_VSA9\nSMR_VSA1\nSMR_VSA10\nSMR_VSA3\n...\nSlogP_VSA2\nSlogP_VSA3\nSlogP_VSA4\nSlogP_VSA5\nSlogP_VSA8\nTPSA\nEState_VSA1\nEState_VSA10\nEState_VSA2\nEState_VSA3\nEState_VSA4\nEState_VSA5\nEState_VSA6\nEState_VSA7\nEState_VSA8\nEState_VSA9\nVSA_EState10\nVSA_EState2\nVSA_EState3\nVSA_EState4\nVSA_EState5\nVSA_EState6\nVSA_EState7\nVSA_EState8\nVSA_EState9\nFractionCSP3\nNHOHCount\nNOCount\nNumAliphaticHeterocycles\nNumAromaticCarbocycles\nNumAromaticHeterocycles\nNumAromaticRings\nNumHAcceptors\nNumHDonors\nNumHeteroatoms\nNumRotatableBonds\nRingCount\nMolLogP\nfr_Al_COO\nfr_Al_OH\nfr_Ar_N\nfr_C_O\nfr_NH0\nfr_NH1\nfr_NH2\nfr_SH\nfr_imidazole\nfr_priamide\nfr_sulfide\nfr_unbrch_alkane\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\n9.574074\n0.731481\n-0.962963\n0.451352\n89.094\n-0.480094\n0.480094\n2.000000\n2.166667\n2.166667\n16.367425\n10.385341\n1.990289\n-1.897069\n1.676610\n-2.250004\n-0.137563\n1.360964\n3.257586\n59.813538\n3.510162\n3.510162\n2.642734\n1.627090\n1.126913\n1.126913\n0.389528\n0.389528\n0.000000\n0.000000\n-0.57\n13.609640\n5.43\n1.767634\n1.721545\n10.840195\n6.041841\n0.0\n0.00000\n5.969305\n4.794537\n0.0\n0.000000\n0.0\n6.923737\n0.000000\n0.000000\n9.901065\n5.969305\n0.000000\n...\n17.117674\n4.794537\n0.0\n6.923737\n0.0\n63.32\n12.011146\n4.794537\n0.000000\n0.000000\n0.000000\n6.923737\n0.0\n0.0\n0.000000\n10.840195\n0.000000\n9.574074\n7.865741\n4.835648\n-0.962963\n-0.731481\n0.000000\n1.418981\n0.000000\n0.666667\n3.0\n3.0\n0.0\n0.0\n0.0\n0.0\n2.0\n2.0\n3.0\n1.0\n0.0\n-0.5818\n1.0\n0.0\n0.0\n1.0\n0.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n0.0\n\n\nC\n9.756435\n0.189815\n-1.004630\n0.424382\n121.161\n-0.480064\n0.480064\n2.000000\n2.428571\n2.428571\n32.116867\n10.376545\n2.056705\n-1.960761\n1.795249\n-2.309520\n-0.137419\n1.645711\n3.343417\n75.335159\n3.664483\n4.558910\n3.180739\n2.406671\n1.127305\n1.492453\n0.513894\n0.907286\n0.078093\n0.234278\n-0.22\n27.977093\n6.78\n2.872925\n2.472042\n10.840195\n6.041841\n0.0\n0.00000\n5.969305\n4.794537\n0.0\n12.628789\n0.0\n0.000000\n5.752854\n0.000000\n9.901065\n18.598094\n0.000000\n...\n22.870527\n4.794537\n0.0\n0.000000\n0.0\n63.32\n12.011146\n4.794537\n5.752854\n0.000000\n0.000000\n0.000000\n0.0\n0.0\n12.628789\n10.840195\n3.649043\n9.756435\n8.008102\n4.939815\n-0.814815\n-0.816358\n0.000000\n0.000000\n0.000000\n0.666667\n3.0\n3.0\n0.0\n0.0\n0.0\n0.0\n3.0\n3.0\n4.0\n2.0\n0.0\n-0.6719\n1.0\n0.0\n0.0\n1.0\n0.0\n0.0\n1.0\n1.0\n0.0\n0.0\n0.0\n0.0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nKac\n10.419084\n0.067099\n-0.972660\n0.499039\n188.227\n-0.480086\n0.480086\n1.461538\n2.076923\n2.538462\n16.367568\n10.120530\n2.091144\n-2.051830\n1.973906\n-2.297932\n-0.138286\n2.022803\n3.255326\n182.227953\n7.746838\n7.746838\n6.036581\n4.265665\n2.923476\n2.923476\n1.633048\n1.633048\n0.877145\n0.877145\n-1.10\n519.860388\n11.90\n6.419740\n7.266972\n16.156983\n6.041841\n0.0\n5.90718\n5.969305\n9.589074\n0.0\n0.000000\n0.0\n19.262465\n13.468494\n0.000000\n14.695602\n11.876485\n5.316789\n...\n29.569610\n9.589074\n0.0\n26.186202\n0.0\n92.42\n12.011146\n9.589074\n5.907180\n19.386400\n6.420822\n6.923737\n0.0\n0.0\n5.316789\n10.840195\n0.000000\n20.695587\n11.053315\n5.271623\n-1.039759\n-0.780252\n1.933755\n2.032398\n0.000000\n0.750000\n4.0\n5.0\n0.0\n0.0\n0.0\n0.0\n3.0\n3.0\n5.0\n6.0\n0.0\n-0.2953\n1.0\n0.0\n0.0\n2.0\n0.0\n1.0\n1.0\n0.0\n0.0\n0.0\n0.0\n2.0\n\n\nKme3\n10.361469\n0.578704\n-0.897918\n0.465620\n189.279\n-0.480086\n0.480086\n1.384615\n1.923077\n2.307692\n16.367548\n10.113915\n2.114811\n-2.232682\n2.021932\n-2.354302\n-0.870130\n1.951693\n3.414940\n163.487862\n8.785803\n8.785803\n5.827186\n4.615856\n4.454444\n4.454444\n1.911260\n1.911260\n1.073871\n1.073871\n-0.61\n396.193584\n12.39\n5.191317\n7.741185\n15.323226\n6.041841\n0.0\n0.00000\n5.969305\n4.794537\n0.0\n0.000000\n0.0\n19.262465\n0.000000\n27.687772\n14.384095\n5.969305\n0.000000\n...\n49.288477\n4.794537\n0.0\n19.262465\n0.0\n63.32\n12.011146\n4.794537\n0.000000\n6.420822\n23.869431\n0.000000\n0.0\n0.0\n21.143016\n10.840195\n0.000000\n10.361469\n8.512288\n5.361669\n-0.897918\n-0.687529\n2.502778\n1.061844\n6.366441\n0.888889\n3.0\n4.0\n0.0\n0.0\n0.0\n0.0\n2.0\n2.0\n4.0\n6.0\n0.0\n0.2748\n1.0\n0.0\n0.0\n1.0\n1.0\n0.0\n1.0\n0.0\n0.0\n0.0\n0.0\n1.0\n\n\n\n\n25 rows × 106 columns\n\n\n\n\n\n\nData.get_aa_morgan\n\ndef get_aa_morgan(\n    \n):\n\nGet Morgan fingerprint representations of amino acids.\n\nData.get_aa_morgan()\n\n\n\n\n\n\n\n\nmorgan_1\nmorgan_11\nmorgan_24\nmorgan_27\nmorgan_70\nmorgan_74\nmorgan_79\nmorgan_80\nmorgan_82\nmorgan_116\nmorgan_118\nmorgan_119\nmorgan_132\nmorgan_140\nmorgan_172\nmorgan_192\nmorgan_197\nmorgan_210\nmorgan_222\nmorgan_227\nmorgan_229\nmorgan_245\nmorgan_280\nmorgan_283\nmorgan_294\nmorgan_295\nmorgan_305\nmorgan_310\nmorgan_319\nmorgan_321\nmorgan_322\nmorgan_328\nmorgan_362\nmorgan_364\nmorgan_376\nmorgan_378\nmorgan_394\nmorgan_412\nmorgan_414\nmorgan_425\nmorgan_429\nmorgan_473\nmorgan_482\nmorgan_486\nmorgan_545\nmorgan_550\nmorgan_553\nmorgan_575\nmorgan_592\nmorgan_623\n...\nmorgan_1431\nmorgan_1451\nmorgan_1452\nmorgan_1456\nmorgan_1459\nmorgan_1507\nmorgan_1517\nmorgan_1544\nmorgan_1558\nmorgan_1564\nmorgan_1573\nmorgan_1595\nmorgan_1602\nmorgan_1607\nmorgan_1633\nmorgan_1644\nmorgan_1685\nmorgan_1693\nmorgan_1716\nmorgan_1719\nmorgan_1736\nmorgan_1737\nmorgan_1750\nmorgan_1751\nmorgan_1752\nmorgan_1754\nmorgan_1758\nmorgan_1773\nmorgan_1778\nmorgan_1783\nmorgan_1785\nmorgan_1791\nmorgan_1819\nmorgan_1838\nmorgan_1840\nmorgan_1844\nmorgan_1847\nmorgan_1849\nmorgan_1873\nmorgan_1876\nmorgan_1879\nmorgan_1882\nmorgan_1898\nmorgan_1911\nmorgan_1912\nmorgan_1926\nmorgan_1937\nmorgan_1942\nmorgan_1946\nmorgan_1970\n\n\naa\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nA\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\nC\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\nKac\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n1\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\nKme3\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n\n\n25 rows × 168 columns\n\n\n\n\n\nPhosphoproteomics\n\n\n\nData.get_cptac_ensembl_site\n\ndef get_cptac_ensembl_site(\n    \n):\n\nGet CPTAC dataset with unique EnsemblProteinID+site.\n\nData.get_cptac_ensembl_site()\n\n\n\n\n\n\n\n\ngene\nsite\nsite_seq\nprotein\ngene_name\ngene_site\nprotein_site\n\n\n\n\n0\nENSG00000003056.8\nS267\nDDQLGEESEERDDHL\nENSP00000000412.3\nM6PR\nM6PR_S267\nENSP00000000412_S267\n\n\n1\nENSG00000003056.8\nS267\nDDQLGEESEERDDHL\nENSP00000440488.2\nM6PR\nM6PR_S267\nENSP00000440488_S267\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n488584\nENSG00000143631.11\nS648\nASRNHHGSAQEQSRD\nENSP00000357789.1\nFLG\nFLG_S648\nENSP00000357789_S648\n\n\n488585\nENSG00000143520.6\nS2310\nDTTRHGHSGYGQSTQ\nENSP00000373370.4\nFLG2\nFLG2_S2310\nENSP00000373370_S2310\n\n\n\n\n488586 rows × 7 columns\n\n\n\n\n\n\nData.get_cptac_unique_site\n\ndef get_cptac_unique_site(\n    \n):\n\nGet CPTAC dataset with unique site sequences.\n\nData.get_cptac_unique_site()\n\n\n\n\n\n\n\n\nsite_seq\ngene_site\nnum_site\nacceptor\n\n\n\n\n0\nAAAAAAASFPWSAFG\nZBTB7A_S182\n1\nS\n\n\n1\nAAAAAAASGAAGGGG\nINTS3_S16\n1\nS\n\n\n...\n...\n...\n...\n...\n\n\n125474\n______MYPAGPPAG\nTIGD5_Y2\n1\nY\n\n\n125475\n_______SPASLPLA\nRFLNB_S1\n1\nS\n\n\n\n\n125476 rows × 4 columns\n\n\n\n\n\n\nData.get_cptac_gene_site\n\ndef get_cptac_gene_site(\n    \n):\n\nGet CPTAC dataset with unique Gene+site.\n\nData.get_cptac_gene_site()\n\n\n\n\n\n\n\n\ngene\nsite\nsite_seq\nprotein\ngene_name\ngene_site\nprotein_site\n\n\n\n\n0\nENSG00000003056.8\nS267\nDDQLGEESEERDDHL\nENSP00000000412.3\nM6PR\nM6PR_S267\nENSP00000000412_S267\n\n\n1\nENSG00000048028.11\nS1053\nPPTIRPNSPYDLCSR\nENSP00000003302.4\nUSP28\nUSP28_S1053\nENSP00000003302_S1053\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n126223\nENSG00000143631.11\nS648\nASRNHHGSAQEQSRD\nENSP00000357789.1\nFLG\nFLG_S648\nENSP00000357789_S648\n\n\n126224\nENSG00000143520.6\nS2310\nDTTRHGHSGYGQSTQ\nENSP00000373370.4\nFLG2\nFLG2_S2310\nENSP00000373370_S2310\n\n\n\n\n126225 rows × 7 columns\n\n\n\n\n\n\nData.get_psp_human_site\n\ndef get_psp_human_site(\n    \n):\n\nGet PhosphoSitePlus human dataset (Gene+site).\n\nData.get_psp_human_site()\n\n\n\n\n\n\n\n\ngene\nprotein\nuniprot\nsite\ngene_site\nSITE_GRP_ID\nspecies\nsite_seq\nLT_LIT\nMS_LIT\nMS_CST\nCST_CAT#\nAmbiguous_Site\n\n\n\n\n0\nYWHAB\n14-3-3 beta\nP31946\nT2\nYWHAB_T2\n15718712\nhuman\n______MtMDksELV\nNaN\n3.0\n1.0\nNone\n0\n\n\n1\nYWHAB\n14-3-3 beta\nP31946\nS6\nYWHAB_S6\n15718709\nhuman\n__MtMDksELVQkAk\nNaN\n8.0\nNaN\nNone\n0\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n240009\nZZZ3\nZZZ3\nQ8IYH5\nS677\nZZZ3_S677\n23077721\nhuman\nyPPEEVEsRRWQKIA\nNaN\nNaN\n1.0\nNone\n0\n\n\n240010\nZZZ3\nZZZ3\nQ8IYH5\nS777\nZZZ3_S777\n41455930\nhuman\nNTAVEDAsDDESIPI\nNaN\n2.0\nNaN\nNone\n0\n\n\n\n\n240011 rows × 13 columns\n\n\n\n\n\n\nData.get_ochoa_site\n\ndef get_ochoa_site(\n    \n):\n\nGet phosphoproteomics dataset from Ochoa et al.\n\nData.get_ochoa_site()\n\n\n\n\n\n\n\n\nuniprot\nposition\nresidue\nis_disopred\ndisopred_score\nlog10_hotspot_pval_min\nisHotspot\nuniprot_position\nfunctional_score\ncurrent_uniprot\nname\ngene\nSequence\nis_valid\nsite_seq\ngene_site\n\n\n\n\n0\nA0A075B6Q4\n24\nS\nTrue\n0.91\n6.839384\nTrue\nA0A075B6Q4_24\n0.149257\nA0A075B6Q4\nA0A075B6Q4_HUMAN\nNone\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nTrue\nVDDEKGDSNDDYDSA\nA0A075B6Q4_S24\n\n\n1\nA0A075B6Q4\n35\nS\nTrue\n0.87\n9.192622\nFalse\nA0A075B6Q4_35\n0.136966\nA0A075B6Q4\nA0A075B6Q4_HUMAN\nNone\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nTrue\nYDSAGLLSDEDCMSV\nA0A075B6Q4_S35\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n112279\nV9GYY5\n134\nT\nTrue\n0.83\n2.055830\nFalse\nV9GYY5_134\n0.187417\nV9GYY5\nV9GYY5_HUMAN\nNone\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\nTrue\nSEEEASSTEKPTKAL\nV9GYY5_T134\n\n\n112280\nV9GYY5\n138\nT\nTrue\n0.82\n0.726611\nFalse\nV9GYY5_138\n0.121025\nV9GYY5\nV9GYY5_HUMAN\nNone\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\nTrue\nASSTEKPTKALPRKS\nV9GYY5_T138\n\n\n\n\n112281 rows × 16 columns\n\n\n\n\n\n\nData.get_combine_site_psp_ochoa\n\ndef get_combine_site_psp_ochoa(\n    \n)-&gt;DataFrame:\n\nGet the combined dataset from Ochoa and PhosphoSitePlus.\n\nData.get_combine_site_psp_ochoa()\n\n\n\n\n\n\n\n\nuniprot\ngene\nsite\nsite_seq\nsource\nAM_pathogenicity\nCDDM_upper\nCDDM_max_score\n\n\n\n\n0\nA0A024R4G9\nC19orf48\nS20\nITGSRLLSMVPGPAR\npsp\nNaN\nPRKX,AKT1,PKG1,P90RSK,HIPK4,AKT3,HIPK1,PKACB,H...\n2.407041\n\n\n1\nA0A075B6Q4\nNone\nS24\nVDDEKGDSNDDYDSA\nochoa\nNaN\nCK2A2,CK2A1,GRK7,GRK5,CK1G1,CK1A,IKKA,CK1G2,CA...\n2.295654\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n121417\nV9GYY5\nNone\nT134\nSEEEASSTEKPTKAL\nochoa\nNaN\nASK1,PERK,EEF2K,MAP2K4,MEKK2,MST1,BMPR1B,OSR1,...\n1.832532\n\n\n121418\nV9GYY5\nNone\nT138\nASSTEKPTKALPRKS\nochoa\nNaN\nASK1,MEK2,MPSK1,TNIK,PBK,MST2,MINK,NEK4,LKB1,MEK5\n1.807565\n\n\n\n\n121419 rows × 8 columns\n\n\n\n\n\n\nData.get_combine_site_phosphorylated\n\ndef get_combine_site_phosphorylated(\n    \n):\n\nGet the combined phosphorylated dataset from Ochoa and PhosphoSitePlus.\n\nData.get_combine_site_phosphorylated()\n\n\n\n\n\n\n\n\nuniprot\ngene\nsite\nsite_seq\nsource\nAM_pathogenicity\nCDDM\nPSPA\nCDDM_max_score\nPSPA_max_score\n\n\n\n\n0\nA0A024R4G9\nC19orf48\nS20\nITGSRLLsMVPGPAR\npsp\nNaN\nPRKX,PKG1,AKT1,AKT3,HIPK4,P90RSK,PKACB,PKACA,P...\nMAPKAPK5,AKT1,RSK3,P70S6K,MAPKAPK3,AKT2,DYRK1A...\n2.339278\n3.726109\n\n\n1\nA0A075B6Q4\nNone\nS24\nVDDEKGDsNDDYDSA\nochoa\nNaN\nCK2A2,CK2A1,GRK7,GRK5,CK1G1,IKKA,CAMK1D,MARK2,...\nCAMK2B,CK2A2,CAMK2A,CK2A1,GRK7,TLK2,FAM20C,CAM...\n2.253027\n4.940056\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n120102\nV9GYY5\nNone\nT134\nsEEEAsstEKPtKAL\nochoa\nNaN\nPERK,ASK1,EEF2K,MST1,BMPR1B,PBK,MEKK2,OSR1,MST...\nCK1G2,GSK3A,ALPHAK3,GRK1,GRK7,GSK3B,BMPR1B,BMP...\n1.723089\n7.009429\n\n\n120103\nV9GYY5\nNone\nT138\nAsstEKPtKALPRKS\nochoa\nNaN\nASK1,PBK,TNIK,MPSK1,MINK,MST2,NEK4,MEK2,MST1,BUB1\nCK1G3,CK1G2,CK1A2,CK1D,CK1A,GRK3,PASK,GRK2,CK1...\n1.651888\n4.350109\n\n\n\n\n120104 rows × 10 columns\n\n\n\n\n\n\nget_human_site\n\ndef get_human_site(\n    \n):\n\nGet the combined phosphorylated dataset from Ochoa and PhosphoSitePlus (20-length version).\n\nData.get_human_site()\n\n\n\n\n\n\n\n\nsubstrate_uniprot\nsubstrate_genes\nsite\nsource\nAM_pathogenicity\nsubstrate_sequence\nsubstrate_species\nsub_site\nsubstrate_phosphoseq\nposition\nsite_seq\n\n\n\n\n0\nA0A024R4G9\nC19orf48 MGC13170 hCG_2008493\nS20\npsp\nNaN\nMTVLEAVLEIQAITGSRLLSMVPGPARPPGSCWDPTQCTRTWLLSH...\nHomo sapiens (Human)\nA0A024R4G9_S20\nMTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTRTWLLSH...\n20\n_MTVLEAVLEIQAITGSRLLsMVPGPARPPGSCWDPTQCTR\n\n\n1\nA0A075B6Q4\nNone\nS24\nochoa\nNaN\nMDIQKSENEDDSEWEDVDDEKGDSNDDYDSAGLLSDEDCMSVPGKT...\nHomo sapiens (Human)\nA0A075B6Q4_S24\nMDIQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPGKT...\n24\nQKSENEDDSEWEDVDDEKGDsNDDYDSAGLLsDEDCMSVPG\n\n\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n...\n\n\n121330\nV9GYY5\nNone\nT134\nochoa\nNaN\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\nHomo sapiens (Human)\nV9GYY5_T134\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\n134\nLGLtPPEGGAGDRsEEEAsstEKPtKALPRKSRDPLLSQRI\n\n\n121331\nV9GYY5\nNone\nT138\nochoa\nNaN\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\nHomo sapiens (Human)\nV9GYY5_T138\nKRDGDDRRPRLVLSFDEEKRREYLTGFHKRKVERKKAAIEEIKQRL...\n138\nPPEGGAGDRsEEEAsstEKPtKALPRKSRDPLLSQRISSLT\n\n\n\n\n119955 rows × 11 columns\n\n\n\n\n\nReactome\n\n\n\nget_reactome_pathway_lo\n\ndef get_reactome_pathway_lo(\n    \n)-&gt;DataFrame:\n\nGet lowest reactome pathways with Uniprot ID as identifier.\n\nData.get_reactome_pathway_lo()\n\n\n\n\n\n\n\n\nuniprot\nreactome_id\npathway\ntype\nspecies\n\n\n\n\n0\nA0A023GPK8\nR-DME-373753\nNephrin family interactions\nIEA\nDrosophila melanogaster\n\n\n1\nA0A023GRW3\nR-DME-72163\nmRNA Splicing - Major Pathway\nIEA\nDrosophila melanogaster\n\n\n...\n...\n...\n...\n...\n...\n\n\n306903\nZ4YHD9\nR-BTA-9734091\nDrug-mediated inhibition of MET activation\nIEA\nBos taurus\n\n\n306904\nZ4YJC3\nR-GGA-983168\nAntigen processing: Ubiquitination & Proteasom...\nIEA\nGallus gallus\n\n\n\n\n306905 rows × 5 columns\n\n\n\n\n\n\nget_reactome_pathway\n\ndef get_reactome_pathway(\n    \n)-&gt;DataFrame:\n\nGet all level reactome pathways with Uniprot ID as identifier.\nThe data is from from Reactome/Download_data: https://reactome.org/download-data\nDownload UniProt to All pathways under Identifier mapping files\nFor type, there are IEA (Inferred from Electronic Annotation) and TAS (Traceable Author Statement, higher confidence)\n\nData.get_reactome_pathway()\n\n\n\n\n\n\n\n\nuniprot\nreactome_id\npathway\ntype\nspecies\n\n\n\n\n0\nA0A023GPK8\nR-DME-1500931\nCell-Cell communication\nIEA\nDrosophila melanogaster\n\n\n1\nA0A023GPK8\nR-DME-373753\nNephrin family interactions\nIEA\nDrosophila melanogaster\n\n\n...\n...\n...\n...\n...\n...\n\n\n888430\nZ4YJC3\nR-GGA-983168\nAntigen processing: Ubiquitination & Proteasom...\nIEA\nGallus gallus\n\n\n888431\nZ4YJC3\nR-GGA-983169\nClass I MHC mediated antigen processing & pres...\nIEA\nGallus gallus\n\n\n\n\n888432 rows × 5 columns",
    "crumbs": [
      "Modules",
      "Data"
    ]
  },
  {
    "objectID": "data.html#cptac",
    "href": "data.html#cptac",
    "title": "Data",
    "section": "CPTAC",
    "text": "CPTAC\n\n\nCPTAC\n\ndef CPTAC(\n    args:VAR_POSITIONAL, kwargs:VAR_KEYWORD\n):\n\nA class for fetching CPTAC phosphoproteomics data.\n\n\n\nCPTAC.list_cancer\n\ndef list_cancer(\n    \n):\n\nList available CPTAC cancer type\n\nCPTAC.list_cancer()\n\n['HNSCC', 'GBM', 'COAD', 'CCRCC', 'LSCC', 'BRCA', 'UCEC', 'LUAD', 'PDAC', 'OV']\n\n\n\n\n\nCPTAC.get_id\n\ndef get_id(\n    cancer_type:str, is_Tumor:bool=True, # tumor tissue or normal\n    is_KB:bool=False, # whether it is for LinkedOmicsKB or LinkedOmics\n):\n\nGet CPTAC phosphorylation sites information given a cancer type\nUse CPTAC.get_id() to load CPTAC phosphorylation site information. Fold change of various conditions can be acquired through LinkedOmics or LinkedOmicsKB. Use is_KB to indicate whether the phosphorylation site information is for LinkedOmics or LinkedOmicsKB.\n# normal tissue\nCPTAC.get_id('CCRCC',is_KB=True, is_Tumor=False)\n# tumor\nCPTAC.get_id('CCRCC',is_KB=True, is_Tumor=True)",
    "crumbs": [
      "Modules",
      "Data"
    ]
  }
]