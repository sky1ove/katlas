<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Functions related with PSSMs">

<title>PSSM – python-katlas</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-45a6b1ee3682cc1dbb0c772b170fe9b7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
<meta property="og:title" content="PSSM – python-katlas">
<meta property="og:description" content="Functions related with PSSMs">
<meta property="og:site_name" content="python-katlas">
<meta name="twitter:title" content="PSSM – python-katlas">
<meta name="twitter:description" content="Functions related with PSSMs">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar floating nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">python-katlas</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/sky1ove/katlas"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data.html">Modules</a></li><li class="breadcrumb-item"><a href="./pssm.html">PSSM</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Get Started</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Modules</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./utils.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Utils</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pssm.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">PSSM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hierarchical.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hierarchical clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scoring.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Scoring</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./feature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Feature</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./plot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plot</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pathway.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Pathway analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Train ML</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dnn.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Train DL</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#pssm" id="toc-pssm" class="nav-link" data-scroll-target="#pssm">PSSM</a>
  <ul class="collapse">
  <li><a href="#get_prob" id="toc-get_prob" class="nav-link" data-scroll-target="#get_prob">get_prob</a></li>
  </ul></li>
  <li><a href="#transform-pssm" id="toc-transform-pssm" class="nav-link" data-scroll-target="#transform-pssm">Transform PSSM</a>
  <ul class="collapse">
  <li><a href="#psty2sty" id="toc-psty2sty" class="nav-link" data-scroll-target="#psty2sty">pSTY2sty</a></li>
  <li><a href="#flatten_pssm" id="toc-flatten_pssm" class="nav-link" data-scroll-target="#flatten_pssm">flatten_pssm</a></li>
  <li><a href="#recover_pssm" id="toc-recover_pssm" class="nav-link" data-scroll-target="#recover_pssm">recover_pssm</a></li>
  <li><a href="#clean_zero_normalize" id="toc-clean_zero_normalize" class="nav-link" data-scroll-target="#clean_zero_normalize">clean_zero_normalize</a></li>
  </ul></li>
  <li><a href="#pssm-of-log-odds" id="toc-pssm-of-log-odds" class="nav-link" data-scroll-target="#pssm-of-log-odds">PSSM of Log odds</a>
  <ul class="collapse">
  <li><a href="#get_pssm_lo" id="toc-get_pssm_lo" class="nav-link" data-scroll-target="#get_pssm_lo">get_pssm_LO</a></li>
  <li><a href="#get_pssm_lo_flat" id="toc-get_pssm_lo_flat" class="nav-link" data-scroll-target="#get_pssm_lo_flat">get_pssm_LO_flat</a></li>
  </ul></li>
  <li><a href="#pssms-of-clusters" id="toc-pssms-of-clusters" class="nav-link" data-scroll-target="#pssms-of-clusters">PSSMs of clusters</a>
  <ul class="collapse">
  <li><a href="#get_cluster_pssms" id="toc-get_cluster_pssms" class="nav-link" data-scroll-target="#get_cluster_pssms">get_cluster_pssms</a></li>
  </ul></li>
  <li><a href="#entropy" id="toc-entropy" class="nav-link" data-scroll-target="#entropy">Entropy</a>
  <ul class="collapse">
  <li><a href="#get_entropy" id="toc-get_entropy" class="nav-link" data-scroll-target="#get_entropy">get_entropy</a></li>
  <li><a href="#get_entropy_flat" id="toc-get_entropy_flat" class="nav-link" data-scroll-target="#get_entropy_flat">get_entropy_flat</a></li>
  </ul></li>
  <li><a href="#information-content" id="toc-information-content" class="nav-link" data-scroll-target="#information-content">Information Content</a>
  <ul class="collapse">
  <li><a href="#get_ic" id="toc-get_ic" class="nav-link" data-scroll-target="#get_ic">get_IC</a></li>
  <li><a href="#get_ic_flat" id="toc-get_ic_flat" class="nav-link" data-scroll-target="#get_ic_flat">get_IC_flat</a></li>
  </ul></li>
  <li><a href="#overall-specificity" id="toc-overall-specificity" class="nav-link" data-scroll-target="#overall-specificity">Overall specificity</a>
  <ul class="collapse">
  <li><a href="#get_specificity" id="toc-get_specificity" class="nav-link" data-scroll-target="#get_specificity">get_specificity</a></li>
  <li><a href="#get_specificity_flat" id="toc-get_specificity_flat" class="nav-link" data-scroll-target="#get_specificity_flat">get_specificity_flat</a></li>
  </ul></li>
  <li><a href="#plot" id="toc-plot" class="nav-link" data-scroll-target="#plot">Plot</a>
  <ul class="collapse">
  <li><a href="#heatmap" id="toc-heatmap" class="nav-link" data-scroll-target="#heatmap">Heatmap</a></li>
  <li><a href="#plot_heatmap_simple" id="toc-plot_heatmap_simple" class="nav-link" data-scroll-target="#plot_heatmap_simple">plot_heatmap_simple</a></li>
  <li><a href="#plot_heatmap" id="toc-plot_heatmap" class="nav-link" data-scroll-target="#plot_heatmap">plot_heatmap</a></li>
  <li><a href="#plot_two_heatmaps" id="toc-plot_two_heatmaps" class="nav-link" data-scroll-target="#plot_two_heatmaps">plot_two_heatmaps</a></li>
  <li><a href="#logo-motif" id="toc-logo-motif" class="nav-link" data-scroll-target="#logo-motif">Logo motif</a></li>
  <li><a href="#change_center_name" id="toc-change_center_name" class="nav-link" data-scroll-target="#change_center_name">change_center_name</a></li>
  <li><a href="#get_pos_min_max" id="toc-get_pos_min_max" class="nav-link" data-scroll-target="#get_pos_min_max">get_pos_min_max</a></li>
  <li><a href="#scale_zero_position" id="toc-scale_zero_position" class="nav-link" data-scroll-target="#scale_zero_position">scale_zero_position</a></li>
  <li><a href="#scale_pos_neg_values" id="toc-scale_pos_neg_values" class="nav-link" data-scroll-target="#scale_pos_neg_values">scale_pos_neg_values</a></li>
  <li><a href="#convert_logo_df" id="toc-convert_logo_df" class="nav-link" data-scroll-target="#convert_logo_df">convert_logo_df</a></li>
  <li><a href="#plot_logo_raw" id="toc-plot_logo_raw" class="nav-link" data-scroll-target="#plot_logo_raw">plot_logo_raw</a></li>
  <li><a href="#get_logo_ic" id="toc-get_logo_ic" class="nav-link" data-scroll-target="#get_logo_ic">get_logo_IC</a></li>
  <li><a href="#plot_logo" id="toc-plot_logo" class="nav-link" data-scroll-target="#plot_logo">plot_logo</a></li>
  <li><a href="#logo-motif-of-log-odds" id="toc-logo-motif-of-log-odds" class="nav-link" data-scroll-target="#logo-motif-of-log-odds">Logo motif of log-odds</a></li>
  <li><a href="#plot_logo_lo" id="toc-plot_logo_lo" class="nav-link" data-scroll-target="#plot_logo_lo">plot_logo_LO</a></li>
  <li><a href="#multiple-logos" id="toc-multiple-logos" class="nav-link" data-scroll-target="#multiple-logos">Multiple logos</a></li>
  <li><a href="#plot_logos_idx" id="toc-plot_logos_idx" class="nav-link" data-scroll-target="#plot_logos_idx">plot_logos_idx</a></li>
  <li><a href="#plot_logos" id="toc-plot_logos" class="nav-link" data-scroll-target="#plot_logos">plot_logos</a></li>
  <li><a href="#logo-motif-heatmap" id="toc-logo-motif-heatmap" class="nav-link" data-scroll-target="#logo-motif-heatmap">Logo motif + Heatmap</a></li>
  <li><a href="#plot_logo_heatmap" id="toc-plot_logo_heatmap" class="nav-link" data-scroll-target="#plot_logo_heatmap">plot_logo_heatmap</a></li>
  <li><a href="#plot_logo_heatmap_lo" id="toc-plot_logo_heatmap_lo" class="nav-link" data-scroll-target="#plot_logo_heatmap_lo">plot_logo_heatmap_LO</a></li>
  </ul></li>
  <li><a href="#pspa" id="toc-pspa" class="nav-link" data-scroll-target="#pspa">PSPA</a>
  <ul class="collapse">
  <li><a href="#plot-1" id="toc-plot-1" class="nav-link" data-scroll-target="#plot-1">Plot</a></li>
  <li><a href="#plot_logo_pspa" id="toc-plot_logo_pspa" class="nav-link" data-scroll-target="#plot_logo_pspa">plot_logo_pspa</a></li>
  <li><a href="#plot_logo_heatmap_pspa" id="toc-plot_logo_heatmap_pspa" class="nav-link" data-scroll-target="#plot_logo_heatmap_pspa">plot_logo_heatmap_pspa</a></li>
  <li><a href="#calculations" id="toc-calculations" class="nav-link" data-scroll-target="#calculations">Calculations</a></li>
  <li><a href="#raw2norm" id="toc-raw2norm" class="nav-link" data-scroll-target="#raw2norm">raw2norm</a></li>
  <li><a href="#get_one_kinase" id="toc-get_one_kinase" class="nav-link" data-scroll-target="#get_one_kinase">get_one_kinase</a></li>
  <li><a href="#plot-pspa-logo-motif-old" id="toc-plot-pspa-logo-motif-old" class="nav-link" data-scroll-target="#plot-pspa-logo-motif-old">Plot PSPA logo motif (old)</a></li>
  <li><a href="#get_logo" id="toc-get_logo" class="nav-link" data-scroll-target="#get_logo">get_logo</a></li>
  </ul></li>
  <li><a href="#compare-pssm" id="toc-compare-pssm" class="nav-link" data-scroll-target="#compare-pssm">Compare PSSM</a>
  <ul class="collapse">
  <li><a href="#kl-divergence" id="toc-kl-divergence" class="nav-link" data-scroll-target="#kl-divergence">KL divergence</a></li>
  <li><a href="#kl_divergence" id="toc-kl_divergence" class="nav-link" data-scroll-target="#kl_divergence">kl_divergence</a></li>
  <li><a href="#kl_divergence_flat" id="toc-kl_divergence_flat" class="nav-link" data-scroll-target="#kl_divergence_flat">kl_divergence_flat</a></li>
  <li><a href="#js-divergence" id="toc-js-divergence" class="nav-link" data-scroll-target="#js-divergence">JS divergence</a></li>
  <li><a href="#js_divergence" id="toc-js_divergence" class="nav-link" data-scroll-target="#js_divergence">js_divergence</a></li>
  <li><a href="#js_divergence_flat" id="toc-js_divergence_flat" class="nav-link" data-scroll-target="#js_divergence_flat">js_divergence_flat</a></li>
  <li><a href="#js-similarity" id="toc-js-similarity" class="nav-link" data-scroll-target="#js-similarity">JS similarity</a></li>
  <li><a href="#js_similarity" id="toc-js_similarity" class="nav-link" data-scroll-target="#js_similarity">js_similarity</a></li>
  <li><a href="#js_similarity_flat" id="toc-js_similarity_flat" class="nav-link" data-scroll-target="#js_similarity_flat">js_similarity_flat</a></li>
  <li><a href="#cosine-similarity" id="toc-cosine-similarity" class="nav-link" data-scroll-target="#cosine-similarity">Cosine similarity</a></li>
  <li><a href="#cosine_similarity" id="toc-cosine_similarity" class="nav-link" data-scroll-target="#cosine_similarity">cosine_similarity</a></li>
  <li><a href="#cosine_overall_flat" id="toc-cosine_overall_flat" class="nav-link" data-scroll-target="#cosine_overall_flat">cosine_overall_flat</a></li>
  </ul></li>
  <li><a href="#end" id="toc-end" class="nav-link" data-scroll-target="#end">End</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/sky1ove/katlas/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./data.html">Modules</a></li><li class="breadcrumb-item"><a href="./pssm.html">PSSM</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">PSSM</h1>
</div>

<div>
  <div class="description">
    Functions related with PSSMs
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->
<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> katlas.pssm <span class="im">import</span> <span class="op">*</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="pssm" class="level2">
<h2 class="anchored" data-anchor-id="pssm">PSSM</h2>
<p>We need to compute <strong>position-specific probability matrix (PSSM)</strong> from a list of aligned site sequences.</p>
<p>For each position <span class="math inline">\(i\)</span> (e.g., from <span class="math inline">\(-7\)</span> to <span class="math inline">\(+7\)</span>), the probability of observing amino acid <span class="math inline">\(x\)</span> is:</p>
<p><span class="math display">\[
P_i(x) = \frac{\text{count of amino acid } x \text{ at position } i}{\text{total counts at position } i}
\]</span></p>
<p>The following 23 amino acids are included:</p>
<ul>
<li>Standard amino acids:<br>
<code>A</code>, <code>C</code>, <code>D</code>, <code>E</code>, <code>F</code>, <code>G</code>, <code>H</code>, <code>I</code>, <code>K</code>, <code>L</code>, <code>M</code>, <code>N</code>, <code>P</code>, <code>Q</code>, <code>R</code>, <code>S</code>, <code>T</code>, <code>V</code>, <code>W</code>, <code>Y</code><br>
</li>
<li>Modified amino acids:<br>
<code>s</code>, <code>t</code>, <code>y</code> (often used to denote phosphorylated <code>S</code>, <code>T</code>, <code>Y</code>)</li>
</ul>
<p>In the output, the modified residues are renamed as: - <code>s</code> → <code>pS</code><br>
- <code>t</code> → <code>pT</code><br>
- <code>y</code> → <code>pY</code></p>
<p>The resulting matrix has: - <strong>Rows</strong>: Amino acids (including <code>pS</code>, <code>pT</code>, <code>pY</code>), - <strong>Columns</strong>: Sequence positions (centered on the phosphosite), - <strong>Values</strong>: Probabilities of each amino acid at each position.</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L45" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_prob" class="level3">
<h3 class="anchored" data-anchor-id="get_prob">get_prob</h3>
<blockquote class="blockquote">
<pre><code> get_prob (data, col:str='site_seq', aa_order=['P', 'G', 'A', 'C', 'S',
           'T', 'V', 'I', 'L', 'M', 'F', 'Y', 'W', 'H', 'K', 'R', 'Q',
           'N', 'D', 'E', 's', 't', 'y'])</code></pre>
</blockquote>
<p><em>Get the probability matrix of PSSM from phosphorylation site sequences.</em></p>
<div id="cell-7" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Data.get_ks_dataset()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-8" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>data_k <span class="op">=</span> data[data.kinase_uniprot<span class="op">==</span><span class="st">'P06493'</span>] <span class="co"># CDK1</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-9" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>get_prob(data_k[<span class="st">'site_seq'</span>].tolist())</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.100762</td>
<td>0.083686</td>
<td>0.082422</td>
<td>0.090680</td>
<td>0.079631</td>
<td>0.082008</td>
<td>0.088333</td>
<td>0.077815</td>
<td>0.091584</td>
<td>0.083128</td>
<td>0.071487</td>
<td>0.080526</td>
<td>0.085106</td>
<td>0.091354</td>
<td>0.097561</td>
<td>0.087520</td>
<td>0.091350</td>
<td>0.104116</td>
<td>0.159677</td>
<td>0.082192</td>
<td>0.000000</td>
<td>0.758065</td>
<td>0.086360</td>
<td>0.088781</td>
<td>0.084951</td>
<td>0.101297</td>
<td>0.090171</td>
<td>0.107492</td>
<td>0.086743</td>
<td>0.098280</td>
<td>0.088889</td>
<td>0.085950</td>
<td>0.091211</td>
<td>0.078138</td>
<td>0.078138</td>
<td>0.085762</td>
<td>0.096909</td>
<td>0.096477</td>
<td>0.063973</td>
<td>0.081218</td>
<td>0.094996</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.069433</td>
<td>0.073542</td>
<td>0.068966</td>
<td>0.054576</td>
<td>0.081308</td>
<td>0.064435</td>
<td>0.084167</td>
<td>0.072848</td>
<td>0.080858</td>
<td>0.075720</td>
<td>0.087099</td>
<td>0.089565</td>
<td>0.060556</td>
<td>0.075041</td>
<td>0.083740</td>
<td>0.076985</td>
<td>0.080032</td>
<td>0.082324</td>
<td>0.066935</td>
<td>0.096696</td>
<td>0.000000</td>
<td>0.031452</td>
<td>0.092817</td>
<td>0.062954</td>
<td>0.050162</td>
<td>0.081037</td>
<td>0.066613</td>
<td>0.065961</td>
<td>0.076105</td>
<td>0.066339</td>
<td>0.074074</td>
<td>0.065289</td>
<td>0.067993</td>
<td>0.087282</td>
<td>0.068994</td>
<td>0.071607</td>
<td>0.085213</td>
<td>0.060403</td>
<td>0.074074</td>
<td>0.082910</td>
<td>0.064461</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.028789</td>
<td>0.027895</td>
<td>0.031960</td>
<td>0.020151</td>
<td>0.020956</td>
<td>0.038494</td>
<td>0.019167</td>
<td>0.031457</td>
<td>0.023102</td>
<td>0.023868</td>
<td>0.032868</td>
<td>0.027938</td>
<td>0.033552</td>
<td>0.027732</td>
<td>0.038211</td>
<td>0.038088</td>
<td>0.039612</td>
<td>0.047619</td>
<td>0.045161</td>
<td>0.031426</td>
<td>0.324738</td>
<td>0.016129</td>
<td>0.037934</td>
<td>0.025827</td>
<td>0.038835</td>
<td>0.021070</td>
<td>0.035743</td>
<td>0.035831</td>
<td>0.027005</td>
<td>0.026208</td>
<td>0.023868</td>
<td>0.026446</td>
<td>0.022388</td>
<td>0.033250</td>
<td>0.023275</td>
<td>0.022481</td>
<td>0.028404</td>
<td>0.024329</td>
<td>0.028620</td>
<td>0.027919</td>
<td>0.018660</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>0.003387</td>
<td>0.005917</td>
<td>0.011775</td>
<td>0.007557</td>
<td>0.005029</td>
<td>0.010879</td>
<td>0.005000</td>
<td>0.004139</td>
<td>0.006601</td>
<td>0.009877</td>
<td>0.009860</td>
<td>0.011504</td>
<td>0.009820</td>
<td>0.006525</td>
<td>0.010569</td>
<td>0.012156</td>
<td>0.016168</td>
<td>0.008071</td>
<td>0.012097</td>
<td>0.008058</td>
<td>0.010475</td>
<td>0.004032</td>
<td>0.009685</td>
<td>0.015335</td>
<td>0.009709</td>
<td>0.014587</td>
<td>0.004874</td>
<td>0.006515</td>
<td>0.005728</td>
<td>0.007371</td>
<td>0.010700</td>
<td>0.007438</td>
<td>0.010779</td>
<td>0.007481</td>
<td>0.008313</td>
<td>0.004996</td>
<td>0.004177</td>
<td>0.002517</td>
<td>0.008418</td>
<td>0.007614</td>
<td>0.008482</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
<div id="cell-10" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>pssm_df <span class="op">=</span> get_prob(data_k) <span class="co"># or get_prob(data_k['site_seq'])</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>pssm_df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.100762</td>
<td>0.083686</td>
<td>0.082422</td>
<td>0.090680</td>
<td>0.079631</td>
<td>0.082008</td>
<td>0.088333</td>
<td>0.077815</td>
<td>0.091584</td>
<td>0.083128</td>
<td>0.071487</td>
<td>0.080526</td>
<td>0.085106</td>
<td>0.091354</td>
<td>0.097561</td>
<td>0.087520</td>
<td>0.091350</td>
<td>0.104116</td>
<td>0.159677</td>
<td>0.082192</td>
<td>0.0</td>
<td>0.758065</td>
<td>0.086360</td>
<td>0.088781</td>
<td>0.084951</td>
<td>0.101297</td>
<td>0.090171</td>
<td>0.107492</td>
<td>0.086743</td>
<td>0.098280</td>
<td>0.088889</td>
<td>0.085950</td>
<td>0.091211</td>
<td>0.078138</td>
<td>0.078138</td>
<td>0.085762</td>
<td>0.096909</td>
<td>0.096477</td>
<td>0.063973</td>
<td>0.081218</td>
<td>0.094996</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.069433</td>
<td>0.073542</td>
<td>0.068966</td>
<td>0.054576</td>
<td>0.081308</td>
<td>0.064435</td>
<td>0.084167</td>
<td>0.072848</td>
<td>0.080858</td>
<td>0.075720</td>
<td>0.087099</td>
<td>0.089565</td>
<td>0.060556</td>
<td>0.075041</td>
<td>0.083740</td>
<td>0.076985</td>
<td>0.080032</td>
<td>0.082324</td>
<td>0.066935</td>
<td>0.096696</td>
<td>0.0</td>
<td>0.031452</td>
<td>0.092817</td>
<td>0.062954</td>
<td>0.050162</td>
<td>0.081037</td>
<td>0.066613</td>
<td>0.065961</td>
<td>0.076105</td>
<td>0.066339</td>
<td>0.074074</td>
<td>0.065289</td>
<td>0.067993</td>
<td>0.087282</td>
<td>0.068994</td>
<td>0.071607</td>
<td>0.085213</td>
<td>0.060403</td>
<td>0.074074</td>
<td>0.082910</td>
<td>0.064461</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>0.075360</td>
<td>0.071006</td>
<td>0.079058</td>
<td>0.058774</td>
<td>0.070411</td>
<td>0.067782</td>
<td>0.075833</td>
<td>0.086921</td>
<td>0.068482</td>
<td>0.069959</td>
<td>0.067379</td>
<td>0.062449</td>
<td>0.069558</td>
<td>0.070962</td>
<td>0.069919</td>
<td>0.073744</td>
<td>0.074373</td>
<td>0.071832</td>
<td>0.083065</td>
<td>0.087027</td>
<td>0.0</td>
<td>0.022581</td>
<td>0.092010</td>
<td>0.056497</td>
<td>0.079288</td>
<td>0.057536</td>
<td>0.077985</td>
<td>0.072476</td>
<td>0.068740</td>
<td>0.066339</td>
<td>0.075720</td>
<td>0.071074</td>
<td>0.065506</td>
<td>0.063175</td>
<td>0.069825</td>
<td>0.072440</td>
<td>0.067669</td>
<td>0.079698</td>
<td>0.058081</td>
<td>0.061760</td>
<td>0.078880</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">C</th>
<td>0.013548</td>
<td>0.006762</td>
<td>0.007569</td>
<td>0.009236</td>
<td>0.014250</td>
<td>0.011715</td>
<td>0.008333</td>
<td>0.007450</td>
<td>0.009901</td>
<td>0.007407</td>
<td>0.010682</td>
<td>0.008217</td>
<td>0.007365</td>
<td>0.008972</td>
<td>0.010569</td>
<td>0.005673</td>
<td>0.004042</td>
<td>0.007264</td>
<td>0.013710</td>
<td>0.008864</td>
<td>0.0</td>
<td>0.001613</td>
<td>0.008878</td>
<td>0.006457</td>
<td>0.010518</td>
<td>0.009724</td>
<td>0.008936</td>
<td>0.010586</td>
<td>0.007365</td>
<td>0.010647</td>
<td>0.006584</td>
<td>0.011570</td>
<td>0.012438</td>
<td>0.004988</td>
<td>0.011638</td>
<td>0.010824</td>
<td>0.011696</td>
<td>0.009228</td>
<td>0.013468</td>
<td>0.007614</td>
<td>0.012723</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">S</th>
<td>0.041490</td>
<td>0.053254</td>
<td>0.043734</td>
<td>0.052057</td>
<td>0.035205</td>
<td>0.041004</td>
<td>0.050833</td>
<td>0.050497</td>
<td>0.043729</td>
<td>0.039506</td>
<td>0.043550</td>
<td>0.041085</td>
<td>0.040098</td>
<td>0.038336</td>
<td>0.034146</td>
<td>0.029984</td>
<td>0.034762</td>
<td>0.016949</td>
<td>0.020968</td>
<td>0.028203</td>
<td>0.0</td>
<td>0.003226</td>
<td>0.029056</td>
<td>0.025020</td>
<td>0.038026</td>
<td>0.033225</td>
<td>0.044679</td>
<td>0.041531</td>
<td>0.043372</td>
<td>0.044226</td>
<td>0.050206</td>
<td>0.041322</td>
<td>0.046434</td>
<td>0.044057</td>
<td>0.050707</td>
<td>0.045795</td>
<td>0.045948</td>
<td>0.046980</td>
<td>0.050505</td>
<td>0.054146</td>
<td>0.047498</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="transform-pssm" class="level2">
<h2 class="anchored" data-anchor-id="transform-pssm">Transform PSSM</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L80" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="psty2sty" class="level3">
<h3 class="anchored" data-anchor-id="psty2sty">pSTY2sty</h3>
<blockquote class="blockquote">
<pre><code> pSTY2sty (string)</code></pre>
</blockquote>
<p><em>Convert pS/pT/pY to s/t/y in a string.</em></p>
<div id="cell-13" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pspa_scale <span class="op">=</span> Data.get_pspa_all_scale()</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pspa_scale.columns.<span class="bu">map</span>(pSTY2sty)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['-5P', '-5G', '-5A', '-5C', '-5S', '-5T', '-5V', '-5I', '-5L', '-5M',
       ...
       '4H', '4K', '4R', '4Q', '4N', '4D', '4E', '4s', '4t', '4y'],
      dtype='object', length=230)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L85" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="flatten_pssm" class="level3">
<h3 class="anchored" data-anchor-id="flatten_pssm">flatten_pssm</h3>
<blockquote class="blockquote">
<pre><code> flatten_pssm (pssm_df, use_sty=False, column_wise=True)</code></pre>
</blockquote>
<p><em>Flatten PSSM dataframe to dictionary</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_df</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>use_sty</td>
<td>bool</td>
<td>False</td>
<td>if True, use s,t,y instead of pS,pT,pY</td>
</tr>
<tr class="odd">
<td>column_wise</td>
<td>bool</td>
<td>True</td>
<td>if True, column major flatten; else row wise flatten (for pytorch training)</td>
</tr>
</tbody>
</table>
<div id="cell-15" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>flat_pssm <span class="op">=</span> pd.Series(flatten_pssm(pssm_df))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>flat_pssm</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>-20P    0.100762
-20G    0.069433
          ...   
20pT    0.018660
20pY    0.008482
Length: 943, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L113" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="recover_pssm" class="level3">
<h3 class="anchored" data-anchor-id="recover_pssm">recover_pssm</h3>
<blockquote class="blockquote">
<pre><code> recover_pssm (flat_pssm:pandas.core.series.Series)</code></pre>
</blockquote>
<p><em>Recover 2D PSSM from flattened PSSM Series. Only includes amino acids present in <code>flat_pssm</code>, preserving canonical order.</em></p>
<div id="cell-17" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>out <span class="op">=</span> recover_pssm(flat_pssm)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>out</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.100762</td>
<td>0.083686</td>
<td>0.082422</td>
<td>0.090680</td>
<td>0.079631</td>
<td>0.082008</td>
<td>0.088333</td>
<td>0.077815</td>
<td>0.091584</td>
<td>0.083128</td>
<td>0.071487</td>
<td>0.080526</td>
<td>0.085106</td>
<td>0.091354</td>
<td>0.097561</td>
<td>0.087520</td>
<td>0.091350</td>
<td>0.104116</td>
<td>0.159677</td>
<td>0.082192</td>
<td>0.000000</td>
<td>0.758065</td>
<td>0.086360</td>
<td>0.088781</td>
<td>0.084951</td>
<td>0.101297</td>
<td>0.090171</td>
<td>0.107492</td>
<td>0.086743</td>
<td>0.098280</td>
<td>0.088889</td>
<td>0.085950</td>
<td>0.091211</td>
<td>0.078138</td>
<td>0.078138</td>
<td>0.085762</td>
<td>0.096909</td>
<td>0.096477</td>
<td>0.063973</td>
<td>0.081218</td>
<td>0.094996</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.069433</td>
<td>0.073542</td>
<td>0.068966</td>
<td>0.054576</td>
<td>0.081308</td>
<td>0.064435</td>
<td>0.084167</td>
<td>0.072848</td>
<td>0.080858</td>
<td>0.075720</td>
<td>0.087099</td>
<td>0.089565</td>
<td>0.060556</td>
<td>0.075041</td>
<td>0.083740</td>
<td>0.076985</td>
<td>0.080032</td>
<td>0.082324</td>
<td>0.066935</td>
<td>0.096696</td>
<td>0.000000</td>
<td>0.031452</td>
<td>0.092817</td>
<td>0.062954</td>
<td>0.050162</td>
<td>0.081037</td>
<td>0.066613</td>
<td>0.065961</td>
<td>0.076105</td>
<td>0.066339</td>
<td>0.074074</td>
<td>0.065289</td>
<td>0.067993</td>
<td>0.087282</td>
<td>0.068994</td>
<td>0.071607</td>
<td>0.085213</td>
<td>0.060403</td>
<td>0.074074</td>
<td>0.082910</td>
<td>0.064461</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.028789</td>
<td>0.027895</td>
<td>0.031960</td>
<td>0.020151</td>
<td>0.020956</td>
<td>0.038494</td>
<td>0.019167</td>
<td>0.031457</td>
<td>0.023102</td>
<td>0.023868</td>
<td>0.032868</td>
<td>0.027938</td>
<td>0.033552</td>
<td>0.027732</td>
<td>0.038211</td>
<td>0.038088</td>
<td>0.039612</td>
<td>0.047619</td>
<td>0.045161</td>
<td>0.031426</td>
<td>0.324738</td>
<td>0.016129</td>
<td>0.037934</td>
<td>0.025827</td>
<td>0.038835</td>
<td>0.021070</td>
<td>0.035743</td>
<td>0.035831</td>
<td>0.027005</td>
<td>0.026208</td>
<td>0.023868</td>
<td>0.026446</td>
<td>0.022388</td>
<td>0.033250</td>
<td>0.023275</td>
<td>0.022481</td>
<td>0.028404</td>
<td>0.024329</td>
<td>0.028620</td>
<td>0.027919</td>
<td>0.018660</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>0.003387</td>
<td>0.005917</td>
<td>0.011775</td>
<td>0.007557</td>
<td>0.005029</td>
<td>0.010879</td>
<td>0.005000</td>
<td>0.004139</td>
<td>0.006601</td>
<td>0.009877</td>
<td>0.009860</td>
<td>0.011504</td>
<td>0.009820</td>
<td>0.006525</td>
<td>0.010569</td>
<td>0.012156</td>
<td>0.016168</td>
<td>0.008071</td>
<td>0.012097</td>
<td>0.008058</td>
<td>0.010475</td>
<td>0.004032</td>
<td>0.009685</td>
<td>0.015335</td>
<td>0.009709</td>
<td>0.014587</td>
<td>0.004874</td>
<td>0.006515</td>
<td>0.005728</td>
<td>0.007371</td>
<td>0.010700</td>
<td>0.007438</td>
<td>0.010779</td>
<td>0.007481</td>
<td>0.008313</td>
<td>0.004996</td>
<td>0.004177</td>
<td>0.002517</td>
<td>0.008418</td>
<td>0.007614</td>
<td>0.008482</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
<div id="cell-18" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>out.loc[pssm_df.index,pssm_df.columns].equals(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>True</code></pre>
</div>
</div>
<p>Or recover from PSPA data, where s, t, y will be converted to pS, pT, and pY:</p>
<div id="cell-20" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pspa <span class="op">=</span> Data.get_pspa_all_norm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-21" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>flat_pssm_pspa <span class="op">=</span> pspa.loc[<span class="st">'AAK1'</span>].dropna()</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>flat_pssm_pspa</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>-5P    0.0720
-5G    0.0245
        ...  
0T     1.0000
0Y     0.0000
Name: AAK1, Length: 213, dtype: float64</code></pre>
</div>
</div>
<div id="cell-22" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>recovered <span class="op">=</span> recover_pssm(flat_pssm_pspa)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>recovered</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.0720</td>
<td>0.0534</td>
<td>0.1084</td>
<td>0.0226</td>
<td>0.1136</td>
<td>0.0</td>
<td>0.0463</td>
<td>0.0527</td>
<td>0.0681</td>
<td>0.0628</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.0245</td>
<td>0.0642</td>
<td>0.0512</td>
<td>0.0283</td>
<td>0.0706</td>
<td>0.0</td>
<td>0.7216</td>
<td>0.0749</td>
<td>0.0923</td>
<td>0.0702</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.0201</td>
<td>0.0332</td>
<td>0.0303</td>
<td>0.0209</td>
<td>0.0121</td>
<td>1.0</td>
<td>0.0123</td>
<td>0.0409</td>
<td>0.0335</td>
<td>0.0251</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>0.0611</td>
<td>0.0339</td>
<td>0.0274</td>
<td>0.0486</td>
<td>0.0178</td>
<td>0.0</td>
<td>0.0100</td>
<td>0.0410</td>
<td>0.0359</td>
<td>0.0270</td>
</tr>
</tbody>
</table>

<p>23 rows × 10 columns</p>
</div>
</div>
</div>
<p>PSPA is not scaled per position, and the recovered pssm_df also contained copies of pS,pT,pY in zero position (S,T,Y).</p>
<p>So we need to remove the redundant copy in zero position (leave pS/pT/pY only) and scaled to 1 per position.</p>
<div id="cell-24" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>_clean_zero(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.100762</td>
<td>0.083686</td>
<td>0.082422</td>
<td>0.090680</td>
<td>0.079631</td>
<td>0.082008</td>
<td>0.088333</td>
<td>0.077815</td>
<td>0.091584</td>
<td>0.083128</td>
<td>0.071487</td>
<td>0.080526</td>
<td>0.085106</td>
<td>0.091354</td>
<td>0.097561</td>
<td>0.087520</td>
<td>0.091350</td>
<td>0.104116</td>
<td>0.159677</td>
<td>0.082192</td>
<td>0.000000</td>
<td>0.758065</td>
<td>0.086360</td>
<td>0.088781</td>
<td>0.084951</td>
<td>0.101297</td>
<td>0.090171</td>
<td>0.107492</td>
<td>0.086743</td>
<td>0.098280</td>
<td>0.088889</td>
<td>0.085950</td>
<td>0.091211</td>
<td>0.078138</td>
<td>0.078138</td>
<td>0.085762</td>
<td>0.096909</td>
<td>0.096477</td>
<td>0.063973</td>
<td>0.081218</td>
<td>0.094996</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.069433</td>
<td>0.073542</td>
<td>0.068966</td>
<td>0.054576</td>
<td>0.081308</td>
<td>0.064435</td>
<td>0.084167</td>
<td>0.072848</td>
<td>0.080858</td>
<td>0.075720</td>
<td>0.087099</td>
<td>0.089565</td>
<td>0.060556</td>
<td>0.075041</td>
<td>0.083740</td>
<td>0.076985</td>
<td>0.080032</td>
<td>0.082324</td>
<td>0.066935</td>
<td>0.096696</td>
<td>0.000000</td>
<td>0.031452</td>
<td>0.092817</td>
<td>0.062954</td>
<td>0.050162</td>
<td>0.081037</td>
<td>0.066613</td>
<td>0.065961</td>
<td>0.076105</td>
<td>0.066339</td>
<td>0.074074</td>
<td>0.065289</td>
<td>0.067993</td>
<td>0.087282</td>
<td>0.068994</td>
<td>0.071607</td>
<td>0.085213</td>
<td>0.060403</td>
<td>0.074074</td>
<td>0.082910</td>
<td>0.064461</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.028789</td>
<td>0.027895</td>
<td>0.031960</td>
<td>0.020151</td>
<td>0.020956</td>
<td>0.038494</td>
<td>0.019167</td>
<td>0.031457</td>
<td>0.023102</td>
<td>0.023868</td>
<td>0.032868</td>
<td>0.027938</td>
<td>0.033552</td>
<td>0.027732</td>
<td>0.038211</td>
<td>0.038088</td>
<td>0.039612</td>
<td>0.047619</td>
<td>0.045161</td>
<td>0.031426</td>
<td>0.324738</td>
<td>0.016129</td>
<td>0.037934</td>
<td>0.025827</td>
<td>0.038835</td>
<td>0.021070</td>
<td>0.035743</td>
<td>0.035831</td>
<td>0.027005</td>
<td>0.026208</td>
<td>0.023868</td>
<td>0.026446</td>
<td>0.022388</td>
<td>0.033250</td>
<td>0.023275</td>
<td>0.022481</td>
<td>0.028404</td>
<td>0.024329</td>
<td>0.028620</td>
<td>0.027919</td>
<td>0.018660</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>0.003387</td>
<td>0.005917</td>
<td>0.011775</td>
<td>0.007557</td>
<td>0.005029</td>
<td>0.010879</td>
<td>0.005000</td>
<td>0.004139</td>
<td>0.006601</td>
<td>0.009877</td>
<td>0.009860</td>
<td>0.011504</td>
<td>0.009820</td>
<td>0.006525</td>
<td>0.010569</td>
<td>0.012156</td>
<td>0.016168</td>
<td>0.008071</td>
<td>0.012097</td>
<td>0.008058</td>
<td>0.010475</td>
<td>0.004032</td>
<td>0.009685</td>
<td>0.015335</td>
<td>0.009709</td>
<td>0.014587</td>
<td>0.004874</td>
<td>0.006515</td>
<td>0.005728</td>
<td>0.007371</td>
<td>0.010700</td>
<td>0.007438</td>
<td>0.010779</td>
<td>0.007481</td>
<td>0.008313</td>
<td>0.004996</td>
<td>0.004177</td>
<td>0.002517</td>
<td>0.008418</td>
<td>0.007614</td>
<td>0.008482</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L146" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="clean_zero_normalize" class="level3">
<h3 class="anchored" data-anchor-id="clean_zero_normalize">clean_zero_normalize</h3>
<blockquote class="blockquote">
<pre><code> clean_zero_normalize (pssm_df)</code></pre>
</blockquote>
<p><em>Zero out non-last three values in position 0 (keep only s,t,y values at center), and normalize per position</em></p>
<p>This function applies phosphosite-specific cleaning and normalization to a PSSM.</p>
<p>At the center position (<span class="math inline">\(i = 0\)</span>), only the last three rows of the matrix — corresponding to phosphorylatable residues <code>s</code>, <code>t</code>, and <code>y</code> — are retained. All other amino acid values at position 0 are set to 0.</p>
<p>After masking, the matrix is column-normalized to ensure the probabilities at each position sum to 1:</p>
<p><span class="math display">\[
P_i(x) = \frac{P_i(x)}{\sum_{x'} P_i(x')}
\]</span></p>
<div id="cell-27" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>norm_pssm <span class="op">=</span> clean_zero_normalize(recovered)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>norm_pssm.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.058446</td>
<td>0.041715</td>
<td>0.086100</td>
<td>0.017935</td>
<td>0.096068</td>
<td>0.0</td>
<td>0.042649</td>
<td>0.040482</td>
<td>0.052640</td>
<td>0.050260</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.019888</td>
<td>0.050152</td>
<td>0.040667</td>
<td>0.022459</td>
<td>0.059704</td>
<td>0.0</td>
<td>0.664702</td>
<td>0.057536</td>
<td>0.071346</td>
<td>0.056182</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>0.023054</td>
<td>0.055152</td>
<td>0.088880</td>
<td>0.042695</td>
<td>0.032558</td>
<td>0.0</td>
<td>0.028740</td>
<td>0.057613</td>
<td>0.044987</td>
<td>0.051701</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">C</th>
<td>0.037016</td>
<td>0.043747</td>
<td>0.052025</td>
<td>0.046663</td>
<td>0.026469</td>
<td>0.0</td>
<td>0.020542</td>
<td>0.052543</td>
<td>0.057355</td>
<td>0.048259</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">S</th>
<td>0.034500</td>
<td>0.048356</td>
<td>0.041859</td>
<td>0.044044</td>
<td>0.046089</td>
<td>0.0</td>
<td>0.013172</td>
<td>0.042403</td>
<td>0.044987</td>
<td>0.044818</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="pssm-of-log-odds" class="level2">
<h2 class="anchored" data-anchor-id="pssm-of-log-odds">PSSM of Log odds</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L155" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_pssm_lo" class="level3">
<h3 class="anchored" data-anchor-id="get_pssm_lo">get_pssm_LO</h3>
<blockquote class="blockquote">
<pre><code> get_pssm_LO (pssm_df, site_type)</code></pre>
</blockquote>
<p><em>Get log odds PSSM: log2 (freq pssm/background pssm).</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_df</td>
<td></td>
</tr>
<tr class="even">
<td>site_type</td>
<td>S, T, Y, ST, or STY</td>
</tr>
</tbody>
</table>
<p>Let <span class="math inline">\(P_i(x)\)</span> be the frequency of amino acid <span class="math inline">\(x\)</span> at position <span class="math inline">\(i\)</span> in the input PSSM, and let <span class="math inline">\(B_i(x)\)</span> be the background frequency of amino acid <span class="math inline">\(x\)</span> at the same position, derived from a background model corresponding to the specified site type (<code>S</code>, <code>T</code>, <code>Y</code>, or <code>STY</code>).</p>
<p>The log-odds score at each position <span class="math inline">\(i\)</span> for amino acid <span class="math inline">\(x\)</span> is computed as:</p>
<p><span class="math display">\[
\mathrm{LO}_i(x) = \log_2 \left( \frac{P_i(x) + \varepsilon}{B_i(x) + \varepsilon} \right)
\]</span></p>
<p>where <span class="math inline">\(\varepsilon = 10^{-8}\)</span> is a small constant added for numerical stability and to avoid division by zero.</p>
<p>This results in a matrix where:</p>
<ul>
<li>Positive values indicate enrichment over background,</li>
<li>Negative values indicate depletion relative to background,</li>
<li>Zero indicates no difference from the expected background.</li>
</ul>
<div id="cell-31" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>data_y <span class="op">=</span> data_k[data_k.site.<span class="bu">str</span>[<span class="dv">0</span>]<span class="op">==</span><span class="st">'Y'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-32" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>pssm_y <span class="op">=</span> get_prob(data_y,<span class="st">'site_seq'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-33" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pssm_LO <span class="op">=</span> get_pssm_LO(pssm_y,<span class="st">'Y'</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>pssm_LO.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>3.346408</td>
<td>-22.443930</td>
<td>-22.483757</td>
<td>-22.372869</td>
<td>-22.330630</td>
<td>-22.389350</td>
<td>-22.374998</td>
<td>-22.472709</td>
<td>-22.395309</td>
<td>1.987578</td>
<td>-22.494346</td>
<td>0.445197</td>
<td>-22.568837</td>
<td>1.592465</td>
<td>0.481417</td>
<td>-22.533689</td>
<td>-22.473171</td>
<td>0.558965</td>
<td>0.126645</td>
<td>-22.159026</td>
<td>0.0</td>
<td>-21.219306</td>
<td>-22.470595</td>
<td>-22.994372</td>
<td>-22.573771</td>
<td>0.385159</td>
<td>2.042311</td>
<td>-22.444570</td>
<td>-22.627742</td>
<td>-22.737503</td>
<td>-22.549071</td>
<td>-22.614291</td>
<td>-22.347248</td>
<td>-22.450324</td>
<td>-22.595771</td>
<td>-22.811749</td>
<td>-22.536017</td>
<td>-22.489922</td>
<td>-22.515220</td>
<td>-22.349670</td>
<td>-22.682968</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>-22.787984</td>
<td>-22.672109</td>
<td>-22.655669</td>
<td>-22.817496</td>
<td>-22.708532</td>
<td>-22.680581</td>
<td>-22.968862</td>
<td>-22.718379</td>
<td>-22.624127</td>
<td>-22.752478</td>
<td>-22.755633</td>
<td>-22.704314</td>
<td>1.820249</td>
<td>-22.602035</td>
<td>1.706290</td>
<td>-22.640845</td>
<td>1.574374</td>
<td>2.033874</td>
<td>2.576212</td>
<td>-22.485306</td>
<td>0.0</td>
<td>1.630733</td>
<td>1.522227</td>
<td>-22.301926</td>
<td>-22.682104</td>
<td>-22.810346</td>
<td>0.400104</td>
<td>0.432959</td>
<td>1.787902</td>
<td>-22.691406</td>
<td>-22.606718</td>
<td>-22.871788</td>
<td>2.968486</td>
<td>-22.716477</td>
<td>0.361061</td>
<td>0.294925</td>
<td>-22.713856</td>
<td>0.228288</td>
<td>-22.828378</td>
<td>0.399785</td>
<td>-22.816906</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>-22.752579</td>
<td>-22.787101</td>
<td>2.244467</td>
<td>-22.501932</td>
<td>1.566475</td>
<td>0.633103</td>
<td>0.209785</td>
<td>-22.641046</td>
<td>-22.668327</td>
<td>-22.755401</td>
<td>-22.862340</td>
<td>-22.751717</td>
<td>0.302850</td>
<td>-22.576040</td>
<td>-22.685439</td>
<td>-22.680965</td>
<td>-22.568254</td>
<td>-22.719280</td>
<td>-22.719076</td>
<td>-22.414048</td>
<td>0.0</td>
<td>-22.708920</td>
<td>1.140178</td>
<td>0.379419</td>
<td>0.404062</td>
<td>-22.548438</td>
<td>1.174414</td>
<td>1.373115</td>
<td>-22.526813</td>
<td>-22.873080</td>
<td>-22.715532</td>
<td>-22.607643</td>
<td>1.739891</td>
<td>-22.700813</td>
<td>0.116988</td>
<td>-22.679525</td>
<td>3.016130</td>
<td>1.791966</td>
<td>-22.670499</td>
<td>-22.569718</td>
<td>0.388038</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">C</th>
<td>-20.604884</td>
<td>2.946480</td>
<td>-20.610481</td>
<td>-20.696340</td>
<td>-20.705479</td>
<td>-20.613911</td>
<td>-20.674559</td>
<td>-20.555965</td>
<td>-20.395309</td>
<td>-20.465246</td>
<td>-20.723212</td>
<td>-20.683076</td>
<td>-20.273082</td>
<td>-20.562865</td>
<td>-20.151208</td>
<td>-20.637713</td>
<td>-20.490617</td>
<td>-20.197935</td>
<td>-20.073742</td>
<td>-20.197731</td>
<td>0.0</td>
<td>-20.723779</td>
<td>-20.427527</td>
<td>-20.857363</td>
<td>-20.533508</td>
<td>-20.380203</td>
<td>-20.784654</td>
<td>-20.540430</td>
<td>-20.325180</td>
<td>-20.087586</td>
<td>-20.474525</td>
<td>-20.292364</td>
<td>-20.675574</td>
<td>-20.827394</td>
<td>-20.497208</td>
<td>-20.411330</td>
<td>-20.843591</td>
<td>-20.777410</td>
<td>-20.951953</td>
<td>-20.735729</td>
<td>-20.464922</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">S</th>
<td>-22.084627</td>
<td>-22.150318</td>
<td>-22.199808</td>
<td>-22.059594</td>
<td>-22.210853</td>
<td>-22.220374</td>
<td>-22.174129</td>
<td>0.711760</td>
<td>-22.086471</td>
<td>-21.971941</td>
<td>-21.907636</td>
<td>-21.850281</td>
<td>-22.021350</td>
<td>-22.147827</td>
<td>-21.770936</td>
<td>-21.831141</td>
<td>-21.924603</td>
<td>-21.627747</td>
<td>-21.621229</td>
<td>-21.092120</td>
<td>0.0</td>
<td>-21.500400</td>
<td>-21.519269</td>
<td>-21.615861</td>
<td>-22.015041</td>
<td>-22.077133</td>
<td>-21.879565</td>
<td>-21.929472</td>
<td>-21.962609</td>
<td>-21.994476</td>
<td>-21.856395</td>
<td>-22.144041</td>
<td>-22.079396</td>
<td>-22.071062</td>
<td>-22.125238</td>
<td>-22.129558</td>
<td>-22.149269</td>
<td>-22.204520</td>
<td>-22.361597</td>
<td>-22.234534</td>
<td>-22.274444</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-34" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>pssm_y[<span class="dv">0</span>][pssm_y[<span class="dv">0</span>]<span class="op">==</span><span class="dv">1</span>].index</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Index(['pY'], dtype='object', name='aa')</code></pre>
</div>
</div>
<div id="cell-35" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>pssm_LO[<span class="dv">0</span>].sort_values() <span class="co"># log-odds is zero at center position when single site log-odds pssm</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>aa
P     0.0
G     0.0
     ... 
pT    0.0
pY    0.0
Name: 0, Length: 23, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L169" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_pssm_lo_flat" class="level3">
<h3 class="anchored" data-anchor-id="get_pssm_lo_flat">get_pssm_LO_flat</h3>
<blockquote class="blockquote">
<pre><code> get_pssm_LO_flat (flat_pssm, site_type)</code></pre>
</blockquote>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flat_pssm</td>
<td></td>
</tr>
<tr class="even">
<td>site_type</td>
<td>S, T, Y, ST, or STY</td>
</tr>
</tbody>
</table>
<div id="cell-37" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pssm_LO <span class="op">=</span> get_pssm_LO_flat(flat_pssm,<span class="st">'STY'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-38" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>pssm_LO</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.586661</td>
<td>0.394140</td>
<td>0.374573</td>
<td>0.453820</td>
<td>0.289470</td>
<td>0.358996</td>
<td>0.482618</td>
<td>0.248724</td>
<td>0.474829</td>
<td>0.389672</td>
<td>0.109081</td>
<td>0.301898</td>
<td>0.336760</td>
<td>0.501053</td>
<td>0.515588</td>
<td>0.480427</td>
<td>0.515543</td>
<td>0.755197</td>
<td>1.058815</td>
<td>0.375288</td>
<td>0.000000</td>
<td>2.390017</td>
<td>0.400188</td>
<td>0.338692</td>
<td>0.471584</td>
<td>0.492282</td>
<td>0.449106</td>
<td>0.719679</td>
<td>0.363679</td>
<td>0.522566</td>
<td>0.321624</td>
<td>0.304491</td>
<td>0.525998</td>
<td>0.281515</td>
<td>0.236806</td>
<td>0.264957</td>
<td>0.545151</td>
<td>0.560067</td>
<td>-0.022594</td>
<td>0.367797</td>
<td>0.484510</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.016858</td>
<td>0.076312</td>
<td>-0.002345</td>
<td>-0.350629</td>
<td>0.235031</td>
<td>-0.081357</td>
<td>0.200054</td>
<td>0.090158</td>
<td>0.242282</td>
<td>0.091220</td>
<td>0.285770</td>
<td>0.325105</td>
<td>-0.114557</td>
<td>0.097086</td>
<td>0.230386</td>
<td>0.205338</td>
<td>0.155133</td>
<td>0.172609</td>
<td>0.046828</td>
<td>0.230478</td>
<td>0.000000</td>
<td>-1.025210</td>
<td>0.477712</td>
<td>-0.167647</td>
<td>-0.357066</td>
<td>0.253819</td>
<td>0.024980</td>
<td>-0.031828</td>
<td>0.169769</td>
<td>-0.015015</td>
<td>0.151653</td>
<td>-0.064451</td>
<td>0.045944</td>
<td>0.379475</td>
<td>0.067256</td>
<td>0.072006</td>
<td>0.275037</td>
<td>-0.179219</td>
<td>0.127575</td>
<td>0.299872</td>
<td>-0.100680</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.911584</td>
<td>0.912650</td>
<td>1.056510</td>
<td>0.470853</td>
<td>0.670212</td>
<td>1.311175</td>
<td>0.429132</td>
<td>1.116517</td>
<td>0.677640</td>
<td>0.513274</td>
<td>0.960222</td>
<td>0.625347</td>
<td>0.681687</td>
<td>0.332545</td>
<td>0.822099</td>
<td>0.639714</td>
<td>0.489330</td>
<td>0.812538</td>
<td>0.380904</td>
<td>0.113449</td>
<td>0.517671</td>
<td>-0.851332</td>
<td>0.094978</td>
<td>-0.048091</td>
<td>0.336723</td>
<td>-0.327027</td>
<td>0.592702</td>
<td>0.869663</td>
<td>0.410747</td>
<td>0.426680</td>
<td>0.319514</td>
<td>0.750686</td>
<td>0.527680</td>
<td>1.073488</td>
<td>0.566722</td>
<td>0.518353</td>
<td>0.979661</td>
<td>0.740521</td>
<td>1.009246</td>
<td>0.904865</td>
<td>0.266921</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>-1.508258</td>
<td>-0.327763</td>
<td>0.479616</td>
<td>-0.163146</td>
<td>-0.511691</td>
<td>0.115212</td>
<td>-0.743236</td>
<td>-0.951924</td>
<td>-0.347715</td>
<td>-0.199543</td>
<td>-0.067569</td>
<td>0.148547</td>
<td>0.000651</td>
<td>-0.746039</td>
<td>-0.322579</td>
<td>-0.285517</td>
<td>0.017292</td>
<td>-1.040118</td>
<td>-0.684355</td>
<td>-1.496942</td>
<td>-4.500376</td>
<td>-2.396887</td>
<td>-1.123007</td>
<td>-0.237850</td>
<td>-0.777896</td>
<td>-0.000605</td>
<td>-1.465025</td>
<td>-0.917736</td>
<td>-0.957110</td>
<td>-0.367131</td>
<td>0.108010</td>
<td>-0.646108</td>
<td>0.325134</td>
<td>-0.135098</td>
<td>-0.112158</td>
<td>-0.764045</td>
<td>-1.033425</td>
<td>-1.598003</td>
<td>0.047446</td>
<td>-0.108367</td>
<td>-0.179734</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="pssms-of-clusters" class="level2">
<h2 class="anchored" data-anchor-id="pssms-of-clusters">PSSMs of clusters</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L176" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_cluster_pssms" class="level3">
<h3 class="anchored" data-anchor-id="get_cluster_pssms">get_cluster_pssms</h3>
<blockquote class="blockquote">
<pre><code> get_cluster_pssms (df, cluster_col, seq_col='site_seq',
                    id_col='sub_site', count_thr=10, valid_thr=None,
                    IC_thr=None, plot=False)</code></pre>
</blockquote>
<p><em>Extract motifs from clusters in a dataframe</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>cluster_col</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>seq_col</td>
<td>str</td>
<td>site_seq</td>
<td></td>
</tr>
<tr class="even">
<td>id_col</td>
<td>str</td>
<td>sub_site</td>
<td></td>
</tr>
<tr class="odd">
<td>count_thr</td>
<td>int</td>
<td>10</td>
<td>if less than the count threshold, not include in the return</td>
</tr>
<tr class="even">
<td>valid_thr</td>
<td>NoneType</td>
<td>None</td>
<td>percentage of not-nan values in pssm</td>
</tr>
<tr class="odd">
<td>IC_thr</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>plot</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-41" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data_10 <span class="op">=</span> data.head(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-42" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>get_cluster_pssms(data,<span class="st">'kinase_group'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>100%|█████████████████████████████████████████████████████████████| 10/10 [00:00&lt;00:00, 10.17it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">-20P</th>
<th data-quarto-table-cell-role="th">-20G</th>
<th data-quarto-table-cell-role="th">-20A</th>
<th data-quarto-table-cell-role="th">-20C</th>
<th data-quarto-table-cell-role="th">-20S</th>
<th data-quarto-table-cell-role="th">-20T</th>
<th data-quarto-table-cell-role="th">-20V</th>
<th data-quarto-table-cell-role="th">-20I</th>
<th data-quarto-table-cell-role="th">-20L</th>
<th data-quarto-table-cell-role="th">-20M</th>
<th data-quarto-table-cell-role="th">-20F</th>
<th data-quarto-table-cell-role="th">-20Y</th>
<th data-quarto-table-cell-role="th">-20W</th>
<th data-quarto-table-cell-role="th">-20H</th>
<th data-quarto-table-cell-role="th">-20K</th>
<th data-quarto-table-cell-role="th">-20R</th>
<th data-quarto-table-cell-role="th">-20Q</th>
<th data-quarto-table-cell-role="th">-20N</th>
<th data-quarto-table-cell-role="th">-20D</th>
<th data-quarto-table-cell-role="th">-20E</th>
<th data-quarto-table-cell-role="th">-20pS</th>
<th data-quarto-table-cell-role="th">-20pT</th>
<th data-quarto-table-cell-role="th">-20pY</th>
<th data-quarto-table-cell-role="th">-19P</th>
<th data-quarto-table-cell-role="th">-19G</th>
<th data-quarto-table-cell-role="th">-19A</th>
<th data-quarto-table-cell-role="th">-19C</th>
<th data-quarto-table-cell-role="th">-19S</th>
<th data-quarto-table-cell-role="th">-19T</th>
<th data-quarto-table-cell-role="th">-19V</th>
<th data-quarto-table-cell-role="th">-19I</th>
<th data-quarto-table-cell-role="th">-19L</th>
<th data-quarto-table-cell-role="th">-19M</th>
<th data-quarto-table-cell-role="th">-19F</th>
<th data-quarto-table-cell-role="th">-19Y</th>
<th data-quarto-table-cell-role="th">-19W</th>
<th data-quarto-table-cell-role="th">-19H</th>
<th data-quarto-table-cell-role="th">-19K</th>
<th data-quarto-table-cell-role="th">-19R</th>
<th data-quarto-table-cell-role="th">-19Q</th>
<th data-quarto-table-cell-role="th">-19N</th>
<th data-quarto-table-cell-role="th">-19D</th>
<th data-quarto-table-cell-role="th">-19E</th>
<th data-quarto-table-cell-role="th">-19pS</th>
<th data-quarto-table-cell-role="th">-19pT</th>
<th data-quarto-table-cell-role="th">-19pY</th>
<th data-quarto-table-cell-role="th">-18P</th>
<th data-quarto-table-cell-role="th">-18G</th>
<th data-quarto-table-cell-role="th">-18A</th>
<th data-quarto-table-cell-role="th">-18C</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">18E</th>
<th data-quarto-table-cell-role="th">18pS</th>
<th data-quarto-table-cell-role="th">18pT</th>
<th data-quarto-table-cell-role="th">18pY</th>
<th data-quarto-table-cell-role="th">19P</th>
<th data-quarto-table-cell-role="th">19G</th>
<th data-quarto-table-cell-role="th">19A</th>
<th data-quarto-table-cell-role="th">19C</th>
<th data-quarto-table-cell-role="th">19S</th>
<th data-quarto-table-cell-role="th">19T</th>
<th data-quarto-table-cell-role="th">19V</th>
<th data-quarto-table-cell-role="th">19I</th>
<th data-quarto-table-cell-role="th">19L</th>
<th data-quarto-table-cell-role="th">19M</th>
<th data-quarto-table-cell-role="th">19F</th>
<th data-quarto-table-cell-role="th">19Y</th>
<th data-quarto-table-cell-role="th">19W</th>
<th data-quarto-table-cell-role="th">19H</th>
<th data-quarto-table-cell-role="th">19K</th>
<th data-quarto-table-cell-role="th">19R</th>
<th data-quarto-table-cell-role="th">19Q</th>
<th data-quarto-table-cell-role="th">19N</th>
<th data-quarto-table-cell-role="th">19D</th>
<th data-quarto-table-cell-role="th">19E</th>
<th data-quarto-table-cell-role="th">19pS</th>
<th data-quarto-table-cell-role="th">19pT</th>
<th data-quarto-table-cell-role="th">19pY</th>
<th data-quarto-table-cell-role="th">20P</th>
<th data-quarto-table-cell-role="th">20G</th>
<th data-quarto-table-cell-role="th">20A</th>
<th data-quarto-table-cell-role="th">20C</th>
<th data-quarto-table-cell-role="th">20S</th>
<th data-quarto-table-cell-role="th">20T</th>
<th data-quarto-table-cell-role="th">20V</th>
<th data-quarto-table-cell-role="th">20I</th>
<th data-quarto-table-cell-role="th">20L</th>
<th data-quarto-table-cell-role="th">20M</th>
<th data-quarto-table-cell-role="th">20F</th>
<th data-quarto-table-cell-role="th">20Y</th>
<th data-quarto-table-cell-role="th">20W</th>
<th data-quarto-table-cell-role="th">20H</th>
<th data-quarto-table-cell-role="th">20K</th>
<th data-quarto-table-cell-role="th">20R</th>
<th data-quarto-table-cell-role="th">20Q</th>
<th data-quarto-table-cell-role="th">20N</th>
<th data-quarto-table-cell-role="th">20D</th>
<th data-quarto-table-cell-role="th">20E</th>
<th data-quarto-table-cell-role="th">20pS</th>
<th data-quarto-table-cell-role="th">20pT</th>
<th data-quarto-table-cell-role="th">20pY</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">TK</th>
<td>0.056754</td>
<td>0.069067</td>
<td>0.070474</td>
<td>0.016886</td>
<td>0.045028</td>
<td>0.039400</td>
<td>0.058630</td>
<td>0.049836</td>
<td>0.083255</td>
<td>0.024038</td>
<td>0.032716</td>
<td>0.023335</td>
<td>0.007974</td>
<td>0.021107</td>
<td>0.069184</td>
<td>0.056168</td>
<td>0.045966</td>
<td>0.036585</td>
<td>0.058865</td>
<td>0.081027</td>
<td>0.024508</td>
<td>0.011843</td>
<td>0.017355</td>
<td>0.057915</td>
<td>0.067158</td>
<td>0.073125</td>
<td>0.016731</td>
<td>0.045396</td>
<td>0.037440</td>
<td>0.053001</td>
<td>0.049959</td>
<td>0.087633</td>
<td>0.023751</td>
<td>0.031356</td>
<td>0.018018</td>
<td>0.009594</td>
<td>0.022230</td>
<td>0.074529</td>
<td>0.063999</td>
<td>0.043173</td>
<td>0.041652</td>
<td>0.060840</td>
<td>0.073359</td>
<td>0.025389</td>
<td>0.010881</td>
<td>0.012870</td>
<td>0.058123</td>
<td>0.067810</td>
<td>0.062792</td>
<td>0.014006</td>
<td>...</td>
<td>0.080097</td>
<td>0.027670</td>
<td>0.012621</td>
<td>0.012743</td>
<td>0.058601</td>
<td>0.065424</td>
<td>0.065302</td>
<td>0.014864</td>
<td>0.045078</td>
<td>0.038986</td>
<td>0.056408</td>
<td>0.048124</td>
<td>0.087354</td>
<td>0.018884</td>
<td>0.042276</td>
<td>0.017178</td>
<td>0.008894</td>
<td>0.018519</td>
<td>0.073830</td>
<td>0.061769</td>
<td>0.047149</td>
<td>0.040327</td>
<td>0.059698</td>
<td>0.078216</td>
<td>0.028509</td>
<td>0.010599</td>
<td>0.014011</td>
<td>0.066015</td>
<td>0.072738</td>
<td>0.065037</td>
<td>0.013692</td>
<td>0.048900</td>
<td>0.037897</td>
<td>0.054523</td>
<td>0.050122</td>
<td>0.077262</td>
<td>0.023227</td>
<td>0.039364</td>
<td>0.018337</td>
<td>0.008435</td>
<td>0.019071</td>
<td>0.070905</td>
<td>0.059413</td>
<td>0.040465</td>
<td>0.038509</td>
<td>0.056357</td>
<td>0.083496</td>
<td>0.025917</td>
<td>0.012836</td>
<td>0.017482</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CMGC</th>
<td>0.080589</td>
<td>0.070340</td>
<td>0.083792</td>
<td>0.013709</td>
<td>0.050865</td>
<td>0.035874</td>
<td>0.053812</td>
<td>0.035874</td>
<td>0.074824</td>
<td>0.022037</td>
<td>0.029468</td>
<td>0.015247</td>
<td>0.007559</td>
<td>0.020884</td>
<td>0.069058</td>
<td>0.057143</td>
<td>0.044331</td>
<td>0.032031</td>
<td>0.053299</td>
<td>0.078668</td>
<td>0.042921</td>
<td>0.020115</td>
<td>0.007559</td>
<td>0.079718</td>
<td>0.075496</td>
<td>0.072937</td>
<td>0.012028</td>
<td>0.058733</td>
<td>0.035061</td>
<td>0.053871</td>
<td>0.032885</td>
<td>0.074472</td>
<td>0.021753</td>
<td>0.026104</td>
<td>0.013436</td>
<td>0.007806</td>
<td>0.021241</td>
<td>0.064491</td>
<td>0.063596</td>
<td>0.046449</td>
<td>0.037492</td>
<td>0.055534</td>
<td>0.080614</td>
<td>0.042482</td>
<td>0.018298</td>
<td>0.005502</td>
<td>0.074292</td>
<td>0.068930</td>
<td>0.074419</td>
<td>0.013786</td>
<td>...</td>
<td>0.084768</td>
<td>0.052185</td>
<td>0.016556</td>
<td>0.005960</td>
<td>0.074212</td>
<td>0.073813</td>
<td>0.074212</td>
<td>0.011970</td>
<td>0.053731</td>
<td>0.034047</td>
<td>0.050805</td>
<td>0.031520</td>
<td>0.074345</td>
<td>0.017423</td>
<td>0.028195</td>
<td>0.015029</td>
<td>0.010374</td>
<td>0.020215</td>
<td>0.070887</td>
<td>0.063173</td>
<td>0.045884</td>
<td>0.033914</td>
<td>0.056124</td>
<td>0.086980</td>
<td>0.048278</td>
<td>0.018619</td>
<td>0.006251</td>
<td>0.082465</td>
<td>0.066961</td>
<td>0.074980</td>
<td>0.012563</td>
<td>0.050789</td>
<td>0.034215</td>
<td>0.050521</td>
<td>0.038626</td>
<td>0.079925</td>
<td>0.019246</td>
<td>0.028869</td>
<td>0.016840</td>
<td>0.006816</td>
<td>0.023924</td>
<td>0.072307</td>
<td>0.060011</td>
<td>0.046111</td>
<td>0.035285</td>
<td>0.057070</td>
<td>0.074044</td>
<td>0.043972</td>
<td>0.018043</td>
<td>0.006415</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">CK1</th>
<td>0.057860</td>
<td>0.076419</td>
<td>0.076965</td>
<td>0.014192</td>
<td>0.039847</td>
<td>0.037118</td>
<td>0.063865</td>
<td>0.052402</td>
<td>0.070961</td>
<td>0.017467</td>
<td>0.027293</td>
<td>0.012555</td>
<td>0.014192</td>
<td>0.024017</td>
<td>0.079694</td>
<td>0.050764</td>
<td>0.033297</td>
<td>0.035480</td>
<td>0.058406</td>
<td>0.086790</td>
<td>0.038210</td>
<td>0.015830</td>
<td>0.016376</td>
<td>0.061069</td>
<td>0.070883</td>
<td>0.069793</td>
<td>0.007634</td>
<td>0.033806</td>
<td>0.032715</td>
<td>0.053435</td>
<td>0.043075</td>
<td>0.087786</td>
<td>0.023991</td>
<td>0.022901</td>
<td>0.016903</td>
<td>0.010905</td>
<td>0.020720</td>
<td>0.076881</td>
<td>0.059978</td>
<td>0.056161</td>
<td>0.037077</td>
<td>0.061069</td>
<td>0.087786</td>
<td>0.041439</td>
<td>0.017448</td>
<td>0.006543</td>
<td>0.050000</td>
<td>0.067935</td>
<td>0.073913</td>
<td>0.010870</td>
<td>...</td>
<td>0.084629</td>
<td>0.041451</td>
<td>0.015544</td>
<td>0.012090</td>
<td>0.053148</td>
<td>0.068746</td>
<td>0.069324</td>
<td>0.012709</td>
<td>0.036973</td>
<td>0.021953</td>
<td>0.047371</td>
<td>0.042172</td>
<td>0.082034</td>
<td>0.017909</td>
<td>0.030040</td>
<td>0.017909</td>
<td>0.020220</td>
<td>0.019064</td>
<td>0.095321</td>
<td>0.047371</td>
<td>0.041594</td>
<td>0.034084</td>
<td>0.065280</td>
<td>0.098209</td>
<td>0.041594</td>
<td>0.021953</td>
<td>0.015020</td>
<td>0.051865</td>
<td>0.074592</td>
<td>0.088578</td>
<td>0.015152</td>
<td>0.039627</td>
<td>0.034382</td>
<td>0.055361</td>
<td>0.039627</td>
<td>0.074592</td>
<td>0.020979</td>
<td>0.034382</td>
<td>0.020396</td>
<td>0.008741</td>
<td>0.026224</td>
<td>0.079837</td>
<td>0.046620</td>
<td>0.038462</td>
<td>0.043124</td>
<td>0.067599</td>
<td>0.087995</td>
<td>0.027972</td>
<td>0.012238</td>
<td>0.011655</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">Atypical</th>
<td>0.071895</td>
<td>0.065359</td>
<td>0.063492</td>
<td>0.014939</td>
<td>0.053221</td>
<td>0.045752</td>
<td>0.058824</td>
<td>0.050420</td>
<td>0.085901</td>
<td>0.020542</td>
<td>0.017740</td>
<td>0.020542</td>
<td>0.005602</td>
<td>0.034547</td>
<td>0.049486</td>
<td>0.057890</td>
<td>0.040149</td>
<td>0.034547</td>
<td>0.059757</td>
<td>0.078431</td>
<td>0.041083</td>
<td>0.025210</td>
<td>0.004669</td>
<td>0.042870</td>
<td>0.052190</td>
<td>0.074557</td>
<td>0.013979</td>
<td>0.063374</td>
<td>0.036347</td>
<td>0.054986</td>
<td>0.031687</td>
<td>0.089469</td>
<td>0.027959</td>
<td>0.036347</td>
<td>0.015843</td>
<td>0.010252</td>
<td>0.026095</td>
<td>0.074557</td>
<td>0.056850</td>
<td>0.054054</td>
<td>0.034483</td>
<td>0.063374</td>
<td>0.068966</td>
<td>0.046598</td>
<td>0.018639</td>
<td>0.006524</td>
<td>0.051068</td>
<td>0.063138</td>
<td>0.072423</td>
<td>0.012071</td>
<td>...</td>
<td>0.072175</td>
<td>0.047483</td>
<td>0.013295</td>
<td>0.015195</td>
<td>0.059829</td>
<td>0.081671</td>
<td>0.066477</td>
<td>0.017094</td>
<td>0.047483</td>
<td>0.044634</td>
<td>0.050332</td>
<td>0.034188</td>
<td>0.063628</td>
<td>0.010446</td>
<td>0.037037</td>
<td>0.016144</td>
<td>0.006648</td>
<td>0.027540</td>
<td>0.047483</td>
<td>0.055081</td>
<td>0.057930</td>
<td>0.043685</td>
<td>0.059829</td>
<td>0.091168</td>
<td>0.039886</td>
<td>0.027540</td>
<td>0.014245</td>
<td>0.077290</td>
<td>0.060115</td>
<td>0.062977</td>
<td>0.015267</td>
<td>0.055344</td>
<td>0.029580</td>
<td>0.065840</td>
<td>0.026718</td>
<td>0.092557</td>
<td>0.017176</td>
<td>0.039122</td>
<td>0.023855</td>
<td>0.009542</td>
<td>0.016221</td>
<td>0.046756</td>
<td>0.054389</td>
<td>0.050573</td>
<td>0.055344</td>
<td>0.062977</td>
<td>0.068702</td>
<td>0.040076</td>
<td>0.020992</td>
<td>0.008588</td>
</tr>
</tbody>
</table>

<p>10 rows × 943 columns</p>
</div>
</div>
</div>
</section>
</section>
<section id="entropy" class="level2">
<h2 class="anchored" data-anchor-id="entropy">Entropy</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L217" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_entropy" class="level3">
<h3 class="anchored" data-anchor-id="get_entropy">get_entropy</h3>
<blockquote class="blockquote">
<pre><code> get_entropy (pssm_df, return_min=False, exclude_zero=False,
              clean_zero=True)</code></pre>
</blockquote>
<p><em>Calculate entropy per position of a PSSM surrounding 0. The less entropy the more information it contains.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_df</td>
<td></td>
<td></td>
<td>a dataframe of pssm with index as aa and column as position</td>
</tr>
<tr class="even">
<td>return_min</td>
<td>bool</td>
<td>False</td>
<td>return min entropy as a single value or return all entropy as a pd.series</td>
</tr>
<tr class="odd">
<td>exclude_zero</td>
<td>bool</td>
<td>False</td>
<td>exclude the column of 0 (center position) in the entropy calculation</td>
</tr>
<tr class="even">
<td>clean_zero</td>
<td>bool</td>
<td>True</td>
<td>if true, zero out non-last three values in position 0 (keep only s,t,y values at center)</td>
</tr>
</tbody>
</table>
<p>Let <span class="math inline">\(P_i(x)\)</span> be the probability of amino acid <span class="math inline">\(x\)</span> at position <span class="math inline">\(i\)</span> in the PSSM, with <span class="math inline">\(i \in \{-k, \dots, -1, 0, +1, \dots, +k\}\)</span>. The entropy at each position <span class="math inline">\(i\)</span> is defined as:</p>
<p><span class="math display">\[
H_i = - \sum_{x} P_i(x) \log_2 \left( P_i(x) + \varepsilon \right)
\]</span></p>
<p>where <span class="math inline">\(\varepsilon = 10^{-8}\)</span> is a small constant added for numerical stability.</p>
<p>If <code>exclude_zero=True</code>, the central position <span class="math inline">\(i = 0\)</span> is omitted from the entropy calculation.</p>
<p>If <code>clean_zero=True</code>, all values at position <span class="math inline">\(i = 0\)</span> are zeroed out except for amino acids Serine (S), Threonine (T), and Tyrosine (Y), typically the only possible phospho-acceptors in kinase motif analysis.</p>
<p>If <code>return_min=True</code>, the function returns the minimum entropy across all positions:</p>
<p><span class="math display">\[
H_{\text{spec}} = \min_i H_i
\]</span></p>
<p>Otherwise, the function returns the full vector <span class="math inline">\(\{H_i\}\)</span> for each position <span class="math inline">\(i\)</span>, reflecting how much information (or uncertainty) is contained at each position in the motif.</p>
<div id="cell-46" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get entropy per position</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>get_entropy(pssm_df).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
 0     0.987416
 1     1.740698
         ...   
-18    4.284598
 14    4.285491
Length: 41, dtype: float64</code></pre>
</div>
</div>
<div id="cell-47" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate minimum entropy of surrouding positions</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>get_entropy(pssm_df,return_min<span class="op">=</span><span class="va">True</span>,exclude_zero<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>1.7406981100302623</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L241" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_entropy_flat" class="level3">
<h3 class="anchored" data-anchor-id="get_entropy_flat">get_entropy_flat</h3>
<blockquote class="blockquote">
<pre><code> get_entropy_flat (flat_pssm:pandas.core.series.Series, return_min=False,
                   exclude_zero=False, clean_zero=True)</code></pre>
</blockquote>
<p><em>Calculate entropy per position of a flat PSSM surrounding 0</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flat_pssm</td>
<td>Series</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>return_min</td>
<td>bool</td>
<td>False</td>
<td>return min entropy as a single value or return all entropy as a pd.series</td>
</tr>
<tr class="odd">
<td>exclude_zero</td>
<td>bool</td>
<td>False</td>
<td>exclude the column of 0 (center position) in the entropy calculation</td>
</tr>
<tr class="even">
<td>clean_zero</td>
<td>bool</td>
<td>True</td>
<td>if true, zero out non-last three values in position 0 (keep only s,t,y values at center)</td>
</tr>
</tbody>
</table>
<div id="cell-49" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>get_entropy_flat(flat_pssm).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
 0     0.987416
 1     1.740698
         ...   
-18    4.284598
 14    4.285491
Length: 41, dtype: float64</code></pre>
</div>
</div>
<div id="cell-50" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>get_entropy_flat(flat_pssm,return_min<span class="op">=</span><span class="va">True</span>,exclude_zero<span class="op">=</span><span class="va">True</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>1.7406981100302623</code></pre>
</div>
</div>
<div id="cell-51" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># test equal</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>(get_entropy_flat(flat_pssm).<span class="bu">round</span>(<span class="dv">5</span>) <span class="op">==</span> get_entropy(pssm_df).<span class="bu">round</span>(<span class="dv">5</span>)).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>True    41
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="information-content" class="level2">
<h2 class="anchored" data-anchor-id="information-content">Information Content</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L248" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_ic" class="level3">
<h3 class="anchored" data-anchor-id="get_ic">get_IC</h3>
<blockquote class="blockquote">
<pre><code> get_IC (pssm_df, return_min=False, exclude_zero=False, clean_zero=True)</code></pre>
</blockquote>
<p><em>Calculate the information content (bits) from a frequency matrix, using log2(3) for the middle position and log2(len(pssm_df)) for others. The higher the more information it contains.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_df</td>
<td></td>
<td></td>
<td>a dataframe of pssm with index as aa and column as position</td>
</tr>
<tr class="even">
<td>return_min</td>
<td>bool</td>
<td>False</td>
<td>return min entropy as a single value or return all entropy as a pd.series</td>
</tr>
<tr class="odd">
<td>exclude_zero</td>
<td>bool</td>
<td>False</td>
<td>exclude the column of 0 (center position) in the entropy calculation</td>
</tr>
<tr class="even">
<td>clean_zero</td>
<td>bool</td>
<td>True</td>
<td>if true, zero out non-last three values in position 0 (keep only s,t,y values at center)</td>
</tr>
</tbody>
</table>
<p>Let <span class="math inline">\(P_i(x)\)</span> be the frequency (probability) of amino acid <span class="math inline">\(x\)</span> at position <span class="math inline">\(i\)</span> in the PSSM. The standard information content (IC) at position <span class="math inline">\(i\)</span> is defined as:</p>
<p><span class="math display">\[
\mathrm{IC}_i = \max H_i - H_i
\]</span></p>
<p>which is:</p>
<p><span class="math display">\[
\mathrm{IC}_i = \log_2(N) - H_i
\]</span></p>
<p>where <span class="math inline">\(N\)</span> is the number of possible amino acids (i.e., <span class="math inline">\(N = \text{len}(P_i)\)</span>).</p>
<p>At the center position (<span class="math inline">\(i = 0\)</span>), only three amino acids (S, T, Y) are relevant, so the maximum entropy at each position is defined as:</p>
<p><span class="math display">\[
\max H_i =
\begin{cases}
\log_2(3) &amp; \text{if } i = 0 \\
\log_2(N) &amp; \text{otherwise}
\end{cases}
\]</span></p>
<div id="cell-55" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the higher the more conserved</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>get_IC(pssm_df,exclude_zero<span class="op">=</span><span class="va">True</span>).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
 14    0.238071
-18    0.238964
         ...   
 3     0.575586
 1     2.782864
Length: 40, dtype: float64</code></pre>
</div>
</div>
<p>Check all zero cases:</p>
<div id="cell-57" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>pssm_df2<span class="op">=</span>pssm_df.copy()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-58" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>pssm_df2[<span class="op">-</span><span class="dv">20</span>]<span class="op">=</span><span class="dv">0</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-59" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>get_entropy(pssm_df2,exclude_zero<span class="op">=</span><span class="va">True</span>).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
-20    0.000000
 1     1.740698
         ...   
-18    4.284598
 14    4.285491
Length: 40, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L272" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_ic_flat" class="level3">
<h3 class="anchored" data-anchor-id="get_ic_flat">get_IC_flat</h3>
<blockquote class="blockquote">
<pre><code> get_IC_flat (flat_pssm:pandas.core.series.Series, return_min=False,
              exclude_zero=False, clean_zero=True)</code></pre>
</blockquote>
<p><em>Calculate the information content (bits) from a flattened pssm pd.Series, using log2(3) for the middle position and log2(len(pssm_df)) for others.</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flat_pssm</td>
<td>Series</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>return_min</td>
<td>bool</td>
<td>False</td>
<td>return min entropy as a single value or return all entropy as a pd.series</td>
</tr>
<tr class="odd">
<td>exclude_zero</td>
<td>bool</td>
<td>False</td>
<td>exclude the column of 0 (center position) in the entropy calculation</td>
</tr>
<tr class="even">
<td>clean_zero</td>
<td>bool</td>
<td>True</td>
<td>if true, zero out non-last three values in position 0 (keep only s,t,y values at center)</td>
</tr>
</tbody>
</table>
<div id="cell-61" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>get_IC_flat(flat_pssm,exclude_zero<span class="op">=</span><span class="va">True</span>).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
 14    0.238071
-18    0.238964
         ...   
 3     0.575586
 1     2.782864
Length: 40, dtype: float64</code></pre>
</div>
</div>
<div id="cell-62" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(get_IC_flat(flat_pssm).<span class="bu">round</span>(<span class="dv">5</span>) <span class="op">==</span> get_IC(pssm_df).<span class="bu">round</span>(<span class="dv">5</span>)).value_counts()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>True    41
Name: count, dtype: int64</code></pre>
</div>
</div>
</section>
</section>
<section id="overall-specificity" class="level2">
<h2 class="anchored" data-anchor-id="overall-specificity">Overall specificity</h2>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L280" target="_blank" style="float:right; font-size:smaller">source</a></p>
<section id="get_specificity" class="level3">
<h3 class="anchored" data-anchor-id="get_specificity">get_specificity</h3>
<blockquote class="blockquote">
<pre><code> get_specificity (pssm_df)</code></pre>
</blockquote>
<p><em>Get specificity score of a pssm, excluding zero position.</em></p>
<p>We evaluated the overall specificity of a PSSM by combining two metrics: the maximum IC across surrounding positions and the variance of IC values:</p>
<p><span class="math display">\[
\text{Specificity Score} = 2 \times \max(\text{IC}) + \mathrm{Var}(\text{IC})
\]</span></p>
<div id="cell-66" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>get_specificity(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>5.7236223416577445</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L288" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_specificity_flat" class="level3">
<h3 class="anchored" data-anchor-id="get_specificity_flat">get_specificity_flat</h3>
<blockquote class="blockquote">
<pre><code> get_specificity_flat (flat_pssm)</code></pre>
</blockquote>
<p><em>Get specificity score of a pssm, excluding zero position.</em></p>
<div id="cell-68" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>get_specificity_flat(flat_pssm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>5.7236223416577445</code></pre>
</div>
</div>
</section>
</section>
<section id="plot" class="level2">
<h2 class="anchored" data-anchor-id="plot">Plot</h2>
<section id="heatmap" class="level3">
<h3 class="anchored" data-anchor-id="heatmap">Heatmap</h3>
<pre><code>/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/fastcore/docscrape.py:230: UserWarning: Unknown section See Also
  else: warn(msg)</code></pre>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L295" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_heatmap_simple" class="level3">
<h3 class="anchored" data-anchor-id="plot_heatmap_simple">plot_heatmap_simple</h3>
<blockquote class="blockquote">
<pre><code> plot_heatmap_simple (matrix, title:str='heatmap', figsize:tuple=(6, 7),
                      cmap:str='binary', vmin=None, vmax=None,
                      center=None, robust=False, annot=None, fmt='.2g',
                      annot_kws=None, linewidths=0, linecolor='white',
                      cbar=True, cbar_kws=None, cbar_ax=None,
                      square=False, xticklabels='auto',
                      yticklabels='auto', mask=None, ax=None)</code></pre>
</blockquote>
<p><em>Plot heatmap based on a matrix of values</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>matrix</td>
<td></td>
<td></td>
<td>a matrix of values</td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>heatmap</td>
<td>title of the heatmap</td>
</tr>
<tr class="odd">
<td>figsize</td>
<td>tuple</td>
<td>(6, 7)</td>
<td>(width, height)</td>
</tr>
<tr class="even">
<td>cmap</td>
<td>str</td>
<td>binary</td>
<td>color map, default is dark&amp;white</td>
</tr>
<tr class="odd">
<td>vmin</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>vmax</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="odd">
<td>center</td>
<td>NoneType</td>
<td>None</td>
<td>The value at which to center the colormap when plotting divergent data.<br>Using this parameter will change the default <code>cmap</code> if none is<br>specified.</td>
</tr>
<tr class="even">
<td>robust</td>
<td>bool</td>
<td>False</td>
<td>If True and <code>vmin</code> or <code>vmax</code> are absent, the colormap range is<br>computed with robust quantiles instead of the extreme values.</td>
</tr>
<tr class="odd">
<td>annot</td>
<td>NoneType</td>
<td>None</td>
<td>If True, write the data value in each cell. If an array-like with the<br>same shape as <code>data</code>, then use this to annotate the heatmap instead<br>of the data. Note that DataFrames will match on position, not index.</td>
</tr>
<tr class="even">
<td>fmt</td>
<td>str</td>
<td>.2g</td>
<td>String formatting code to use when adding annotations.</td>
</tr>
<tr class="odd">
<td>annot_kws</td>
<td>NoneType</td>
<td>None</td>
<td>Keyword arguments for :meth:<code>matplotlib.axes.Axes.text</code> when <code>annot</code><br>is True.</td>
</tr>
<tr class="even">
<td>linewidths</td>
<td>int</td>
<td>0</td>
<td>Width of the lines that will divide each cell.</td>
</tr>
<tr class="odd">
<td>linecolor</td>
<td>str</td>
<td>white</td>
<td>Color of the lines that will divide each cell.</td>
</tr>
<tr class="even">
<td>cbar</td>
<td>bool</td>
<td>True</td>
<td>Whether to draw a colorbar.</td>
</tr>
<tr class="odd">
<td>cbar_kws</td>
<td>NoneType</td>
<td>None</td>
<td>Keyword arguments for :meth:<code>matplotlib.figure.Figure.colorbar</code>.</td>
</tr>
<tr class="even">
<td>cbar_ax</td>
<td>NoneType</td>
<td>None</td>
<td>Axes in which to draw the colorbar, otherwise take space from the<br>main Axes.</td>
</tr>
<tr class="odd">
<td>square</td>
<td>bool</td>
<td>False</td>
<td>If True, set the Axes aspect to “equal” so each cell will be<br>square-shaped.</td>
</tr>
<tr class="even">
<td>xticklabels</td>
<td>str</td>
<td>auto</td>
<td></td>
</tr>
<tr class="odd">
<td>yticklabels</td>
<td>str</td>
<td>auto</td>
<td></td>
</tr>
<tr class="even">
<td>mask</td>
<td>NoneType</td>
<td>None</td>
<td>If passed, data will not be shown in cells where <code>mask</code> is True.<br>Cells with missing values are automatically masked.</td>
</tr>
<tr class="odd">
<td>ax</td>
<td>NoneType</td>
<td>None</td>
<td>Axes in which to draw the plot, otherwise use the currently-active<br>Axes.</td>
</tr>
<tr class="even">
<td><strong>Returns</strong></td>
<td><strong>matplotlib Axes</strong></td>
<td></td>
<td><strong>Axes object with the heatmap.</strong></td>
</tr>
</tbody>
</table>
<div id="cell-72" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_heatmap_simple(pssm_df,'kinase',figsize=(10,7))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L312" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_heatmap" class="level3">
<h3 class="anchored" data-anchor-id="plot_heatmap">plot_heatmap</h3>
<blockquote class="blockquote">
<pre><code> plot_heatmap (heatmap_df, ax=None, position_label=True, figsize=(5, 6),
               include_zero=True, scale_pos_neg=False,
               colorbar_title='Prob.')</code></pre>
</blockquote>
<p><em>Plots a heatmap with specific formatting.</em></p>
<p>This function visualizes a PSSM or log-odds matrix as a heatmap with diverging color scales centered at 0.</p>
<p><strong>Color scale behavior</strong>:</p>
<ul>
<li><p>By default (<code>scale_pos_neg=False</code>), the colormap is <strong>centered at 0</strong>, but the full data range determines the color intensity:</p>
<p><span class="math display">\[
\text{color range} = [\min(\text{data}), \max(\text{data})], \quad \text{with center at } 0
\]</span></p>
<p>This is useful when you want to emphasize whether values are <strong>above or below zero</strong>, but without enforcing symmetry.</p></li>
<li><p>If <code>scale_pos_neg=True</code>, the function uses a <strong>balanced diverging scale</strong> via <code>TwoSlopeNorm</code>, such that:</p>
<p><span class="math display">\[
\text{min color} = \min(\text{data}), \quad
\text{center} = 0, \quad
\text{max color} = \max(\text{data})
\]</span></p>
<p>The positive and negative ranges are <strong>scaled separately</strong>, ensuring that both ends of the heatmap have equal visual weight — especially helpful for symmetric data like log-odds matrices.</p></li>
</ul>
<p><strong>Additional visual features</strong>: - The center position (<span class="math inline">\(i = 0\)</span>) can be masked out using <code>include_zero=False</code>.</p>
<div id="cell-75" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_heatmap(pssm_df-0.3,scale_pos_neg=False,figsize=(20, 6));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-76" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_heatmap(pssm_df-0.3,scale_pos_neg=True,figsize=(20, 6));</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-77" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>plt.close(<span class="st">'all'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L371" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_two_heatmaps" class="level3">
<h3 class="anchored" data-anchor-id="plot_two_heatmaps">plot_two_heatmaps</h3>
<blockquote class="blockquote">
<pre><code> plot_two_heatmaps (matrix1, matrix2, kinase_name='Kinase', title1='CDDM',
                    title2='PSPA', figsize=(4, 4.5), cbar=True,
                    scale_01=False, **kwargs)</code></pre>
</blockquote>
<p><em>Plot two side-by-side heatmaps with black rectangle borders, titles on top, shared kinase label below, and only left plot showing y-axis labels.</em></p>
<div id="cell-79" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pssm1 = recover_pssm(target.loc[idx])</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pssm2 = recover_pssm(pred.loc[idx])</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_two_heatmaps(pssm1,pssm2,f'{idx}:{score:.3f}','PSP','Predicted')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="logo-motif" class="level3">
<h3 class="anchored" data-anchor-id="logo-motif">Logo motif</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L433" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="change_center_name" class="level3">
<h3 class="anchored" data-anchor-id="change_center_name">change_center_name</h3>
<blockquote class="blockquote">
<pre><code> change_center_name (df)</code></pre>
</blockquote>
<p><em>Transfer the middle pS,pT,pY to S,T,Y for plot.</em></p>
<p>Now instead of pS, pT, and pY, the center name becomes S, T and Y:</p>
<div id="cell-83" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>change_center_name(pssm_df)[<span class="dv">0</span>].sort_values(ascending<span class="op">=</span><span class="va">False</span>).head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>aa
S    0.664786
T    0.324738
Y    0.010475
A    0.000000
G    0.000000
Name: 0, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L444" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_pos_min_max" class="level3">
<h3 class="anchored" data-anchor-id="get_pos_min_max">get_pos_min_max</h3>
<blockquote class="blockquote">
<pre><code> get_pos_min_max (pssm_df)</code></pre>
</blockquote>
<p><em>Get min and max value of sum of positive and negative values across each position.</em></p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L456" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scale_zero_position" class="level3">
<h3 class="anchored" data-anchor-id="scale_zero_position">scale_zero_position</h3>
<blockquote class="blockquote">
<pre><code> scale_zero_position (pssm_df)</code></pre>
</blockquote>
<p><em>Scale position 0 so that: - Positive values match the max positive column sum of other positions - Negative values match the min (most negative) column sum of other positions</em></p>
<p>This function rescales <strong>position 0</strong> in a log-odds PSSM so that its total positive and negative stack heights match those of the most extreme positions on either side.</p>
<p>This ensures the central position visually matches the dynamic range of surrounding positions in log-odds logo plots.</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L479" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="scale_pos_neg_values" class="level3">
<h3 class="anchored" data-anchor-id="scale_pos_neg_values">scale_pos_neg_values</h3>
<blockquote class="blockquote">
<pre><code> scale_pos_neg_values (pssm_df)</code></pre>
</blockquote>
<p><em>Globally scale all positive values by max positive column sum, and negative values by min negative column sum (preserving sign).</em></p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L496" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="convert_logo_df" class="level3">
<h3 class="anchored" data-anchor-id="convert_logo_df">convert_logo_df</h3>
<blockquote class="blockquote">
<pre><code> convert_logo_df (pssm_df, scale_zero=True, scale_pos_neg=False)</code></pre>
</blockquote>
<p><em>Change center name from pS,pT,pY to S, T, Y in a pssm and scaled zero position to the max of neigbors.</em></p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L504" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_raw" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_raw">plot_logo_raw</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_raw (pssm_df, ax=None, title='Motif', ytitle='Bits',
                figsize=(10, 2))</code></pre>
</blockquote>
<p><em>Plot logo motif using Logomaker.</em></p>
<div id="cell-90" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_raw(pssm_df)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L514" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_logo_ic" class="level3">
<h3 class="anchored" data-anchor-id="get_logo_ic">get_logo_IC</h3>
<blockquote class="blockquote">
<pre><code> get_logo_IC (pssm_df)</code></pre>
</blockquote>
<p><em>For plotting purpose, calculate the scaled information content (bits) from a frequency matrix, using log2(3) for the middle position and log2(len(pssm_df)) for others.</em></p>
<p>To visualize the motif using Logomaker, the scaled PSSM is computed by weighting each amino acid’s frequency at position <span class="math inline">\(i\)</span> by the position’s information content:</p>
<p><span class="math display">\[
\text{PSSM\_scaled}_i(x) = P_i(x) \cdot \mathrm{IC}_i
\]</span></p>
<p>This results in a matrix where the total stack height at each position equals the information content, and each letter’s height is proportional to its contribution. This is the standard format used by Logomaker to generate sequence logos.</p>
<div id="cell-93" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>get_logo_IC(pssm_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Position</th>
<th data-quarto-table-cell-role="th">-20</th>
<th data-quarto-table-cell-role="th">-19</th>
<th data-quarto-table-cell-role="th">-18</th>
<th data-quarto-table-cell-role="th">-17</th>
<th data-quarto-table-cell-role="th">-16</th>
<th data-quarto-table-cell-role="th">-15</th>
<th data-quarto-table-cell-role="th">-14</th>
<th data-quarto-table-cell-role="th">-13</th>
<th data-quarto-table-cell-role="th">-12</th>
<th data-quarto-table-cell-role="th">-11</th>
<th data-quarto-table-cell-role="th">-10</th>
<th data-quarto-table-cell-role="th">-9</th>
<th data-quarto-table-cell-role="th">-8</th>
<th data-quarto-table-cell-role="th">-7</th>
<th data-quarto-table-cell-role="th">-6</th>
<th data-quarto-table-cell-role="th">-5</th>
<th data-quarto-table-cell-role="th">-4</th>
<th data-quarto-table-cell-role="th">-3</th>
<th data-quarto-table-cell-role="th">-2</th>
<th data-quarto-table-cell-role="th">-1</th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
<th data-quarto-table-cell-role="th">3</th>
<th data-quarto-table-cell-role="th">4</th>
<th data-quarto-table-cell-role="th">5</th>
<th data-quarto-table-cell-role="th">6</th>
<th data-quarto-table-cell-role="th">7</th>
<th data-quarto-table-cell-role="th">8</th>
<th data-quarto-table-cell-role="th">9</th>
<th data-quarto-table-cell-role="th">10</th>
<th data-quarto-table-cell-role="th">11</th>
<th data-quarto-table-cell-role="th">12</th>
<th data-quarto-table-cell-role="th">13</th>
<th data-quarto-table-cell-role="th">14</th>
<th data-quarto-table-cell-role="th">15</th>
<th data-quarto-table-cell-role="th">16</th>
<th data-quarto-table-cell-role="th">17</th>
<th data-quarto-table-cell-role="th">18</th>
<th data-quarto-table-cell-role="th">19</th>
<th data-quarto-table-cell-role="th">20</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">P</th>
<td>0.028979</td>
<td>0.021736</td>
<td>0.019696</td>
<td>0.026208</td>
<td>0.020191</td>
<td>0.020036</td>
<td>0.026940</td>
<td>0.020702</td>
<td>0.024652</td>
<td>0.022535</td>
<td>0.017114</td>
<td>0.021499</td>
<td>0.023403</td>
<td>0.026208</td>
<td>0.031930</td>
<td>0.024593</td>
<td>0.032412</td>
<td>0.039787</td>
<td>0.068936</td>
<td>0.029358</td>
<td>0.000000</td>
<td>2.109590</td>
<td>0.033707</td>
<td>0.051101</td>
<td>0.028948</td>
<td>0.037501</td>
<td>0.028892</td>
<td>0.036076</td>
<td>0.027630</td>
<td>0.028354</td>
<td>0.025461</td>
<td>0.025050</td>
<td>0.022227</td>
<td>0.020044</td>
<td>0.018602</td>
<td>0.024891</td>
<td>0.026862</td>
<td>0.027559</td>
<td>0.015651</td>
<td>0.022606</td>
<td>0.025402</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">G</th>
<td>0.019969</td>
<td>0.019102</td>
<td>0.016480</td>
<td>0.015774</td>
<td>0.020616</td>
<td>0.015743</td>
<td>0.025669</td>
<td>0.019380</td>
<td>0.021765</td>
<td>0.020527</td>
<td>0.020852</td>
<td>0.023912</td>
<td>0.016652</td>
<td>0.021528</td>
<td>0.027406</td>
<td>0.021633</td>
<td>0.028396</td>
<td>0.031460</td>
<td>0.028898</td>
<td>0.034539</td>
<td>0.000000</td>
<td>0.087526</td>
<td>0.036227</td>
<td>0.036235</td>
<td>0.017093</td>
<td>0.030001</td>
<td>0.021343</td>
<td>0.022138</td>
<td>0.024241</td>
<td>0.019139</td>
<td>0.021217</td>
<td>0.019028</td>
<td>0.016569</td>
<td>0.022389</td>
<td>0.016426</td>
<td>0.020782</td>
<td>0.023620</td>
<td>0.017255</td>
<td>0.018122</td>
<td>0.023077</td>
<td>0.017237</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">pT</th>
<td>0.008280</td>
<td>0.007245</td>
<td>0.007637</td>
<td>0.005824</td>
<td>0.005313</td>
<td>0.009405</td>
<td>0.005845</td>
<td>0.008369</td>
<td>0.006219</td>
<td>0.006470</td>
<td>0.007869</td>
<td>0.007459</td>
<td>0.009226</td>
<td>0.007956</td>
<td>0.012506</td>
<td>0.010703</td>
<td>0.014055</td>
<td>0.018197</td>
<td>0.019497</td>
<td>0.011225</td>
<td>0.194046</td>
<td>0.044885</td>
<td>0.014806</td>
<td>0.014866</td>
<td>0.013233</td>
<td>0.007800</td>
<td>0.011453</td>
<td>0.012025</td>
<td>0.008602</td>
<td>0.007561</td>
<td>0.006837</td>
<td>0.007708</td>
<td>0.005456</td>
<td>0.008529</td>
<td>0.005541</td>
<td>0.006525</td>
<td>0.007873</td>
<td>0.006950</td>
<td>0.007002</td>
<td>0.007771</td>
<td>0.004990</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">pY</th>
<td>0.000974</td>
<td>0.001537</td>
<td>0.002814</td>
<td>0.002184</td>
<td>0.001275</td>
<td>0.002658</td>
<td>0.001525</td>
<td>0.001101</td>
<td>0.001777</td>
<td>0.002677</td>
<td>0.002361</td>
<td>0.003071</td>
<td>0.002700</td>
<td>0.001872</td>
<td>0.003459</td>
<td>0.003416</td>
<td>0.005737</td>
<td>0.003084</td>
<td>0.005222</td>
<td>0.002878</td>
<td>0.006260</td>
<td>0.011221</td>
<td>0.003780</td>
<td>0.008827</td>
<td>0.003308</td>
<td>0.005400</td>
<td>0.001562</td>
<td>0.002186</td>
<td>0.001825</td>
<td>0.002127</td>
<td>0.003065</td>
<td>0.002168</td>
<td>0.002627</td>
<td>0.001919</td>
<td>0.001979</td>
<td>0.001450</td>
<td>0.001158</td>
<td>0.000719</td>
<td>0.002059</td>
<td>0.002119</td>
<td>0.002268</td>
</tr>
</tbody>
</table>

<p>23 rows × 41 columns</p>
</div>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L524" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo">plot_logo</h3>
<blockquote class="blockquote">
<pre><code> plot_logo (pssm_df, title='Motif', scale_zero=True, ax=None, figsize=(10,
            1))</code></pre>
</blockquote>
<p><em>Plot logo of information content given a frequency PSSM.</em></p>
<div id="cell-95" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo(pssm_df,scale_zero=False,figsize=(10,1))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Set scale_zero to default True can have better vision of the side amino acids</p>
<div id="cell-97" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo(pssm_df,figsize=(10,1))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-98" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close('all')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="logo-motif-of-log-odds" class="level3">
<h3 class="anchored" data-anchor-id="logo-motif-of-log-odds">Logo motif of log-odds</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L531" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_lo" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_lo">plot_logo_LO</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_LO (pssm_LO, title='Motif', acceptor=None, scale_zero=True,
               scale_pos_neg=True, ax=None, figsize=(10, 1))</code></pre>
</blockquote>
<p><em>Plot logo of log-odds given a frequency PSSM.</em></p>
<p>To ensure the phosphorylated residue is visible at the center of a log-odds motif (position 0), two mechanisms are used:</p>
<ol type="1">
<li><p><strong>Acceptor override</strong>: If the center column is entirely zero (e.g., masked), the user can specify an <code>acceptor</code> (<code>'S'</code>, <code>'T'</code>, <code>'Y'</code>, or <code>'STY'</code>). The function then assigns a small nonzero value (e.g., 0.1) to the corresponding phospho-residue row (<code>pS</code>, <code>pT</code>, <code>pY</code>) at position 0. This ensures the central letter appears in the logo plot, even when real log-odds values are absent.</p></li>
<li><p><strong>Stack height rescaling</strong>: To maintain visual consistency with surrounding columns, position 0 is rescaled so that its total positive and negative stack heights match the most extreme values observed elsewhere.</p></li>
</ol>
<p>Together, these adjustments ensure that: - The phospho-acceptor appears explicitly at the center, - The visual scale remains consistent with neighboring positions, - The resulting logo can faithfully reflect both biological relevance and statistical signal.</p>
<div id="cell-102" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pssm_LO <span class="op">=</span> get_pssm_LO(pssm_df,<span class="st">'STY'</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_LO(pssm_LO,scale_zero=False,scale_pos_neg=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-103" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">## with zero position scaled to the max</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_LO(pssm_LO,scale_zero=True,scale_pos_neg=False)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-104" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # scaled positive and negative values for better visualization</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_LO(pssm_LO,scale_zero=True,scale_pos_neg=True)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-105" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># for those specific site type (S,T or Y), show acceptor in the middle instead of empty</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>pssm_LO <span class="op">=</span> get_pssm_LO(pssm_y,<span class="st">'Y'</span>)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_LO(pssm_LO,acceptor='Y')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-106" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close('all')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="multiple-logos" class="level3">
<h3 class="anchored" data-anchor-id="multiple-logos">Multiple logos</h3>
<p>As multiple figures:</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L545" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logos_idx" class="level3">
<h3 class="anchored" data-anchor-id="plot_logos_idx">plot_logos_idx</h3>
<blockquote class="blockquote">
<pre><code> plot_logos_idx (pssms_df, *idxs)</code></pre>
</blockquote>
<p><em>Plot logos of a dataframe with flattened PSSMs with index ad IDs.</em></p>
<div id="cell-110" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pssms <span class="op">=</span> Data.get_cddm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-111" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logos_idx(pssms,*pssms.index[:2])</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>In one figure:</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L554" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logos" class="level3">
<h3 class="anchored" data-anchor-id="plot_logos">plot_logos</h3>
<blockquote class="blockquote">
<pre><code> plot_logos (pssms_df, count_dict=None, path=None, prefix='Motif')</code></pre>
</blockquote>
<p><em>Plot all logos from a dataframe of flattened PSSMs as subplots in a single figure.</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssms_df</td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>count_dict</td>
<td>NoneType</td>
<td>None</td>
<td>used to display n in motif title</td>
</tr>
<tr class="odd">
<td>path</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>prefix</td>
<td>str</td>
<td>Motif</td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-114" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logos(pssms.head(2))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-115" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close('all')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="logo-motif-heatmap" class="level3">
<h3 class="anchored" data-anchor-id="logo-motif-heatmap">Logo motif + Heatmap</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L577" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_heatmap" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_heatmap">plot_logo_heatmap</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_heatmap (pssm_df, title='Motif', figsize=(17, 10),
                    include_zero=False)</code></pre>
</blockquote>
<p><em>Plot logo and heatmap vertically</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_df</td>
<td></td>
<td></td>
<td>column is position, index is aa</td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Motif</td>
<td></td>
</tr>
<tr class="odd">
<td>figsize</td>
<td>tuple</td>
<td>(17, 10)</td>
<td></td>
</tr>
<tr class="even">
<td>include_zero</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-118" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_heatmap(pssm_df,'Kinase',(17,10))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L595" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_heatmap_lo" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_heatmap_lo">plot_logo_heatmap_LO</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_heatmap_LO (pssm_LO, title='Motif', acceptor=None, figsize=(17,
                       10), include_zero=False, scale_pos_neg=True)</code></pre>
</blockquote>
<p><em>Plot logo and heatmap of enrichment bits vertically</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>pssm_LO</td>
<td></td>
<td></td>
<td>pssm of log-odds</td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Motif</td>
<td></td>
</tr>
<tr class="odd">
<td>acceptor</td>
<td>NoneType</td>
<td>None</td>
<td></td>
</tr>
<tr class="even">
<td>figsize</td>
<td>tuple</td>
<td>(17, 10)</td>
<td></td>
</tr>
<tr class="odd">
<td>include_zero</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
<tr class="even">
<td>scale_pos_neg</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-120" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_heatmap_LO(pssm_LO,acceptor='Y')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-121" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>pssm_LO <span class="op">=</span> get_pssm_LO(pssm_df,<span class="st">'STY'</span>)</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_heatmap_LO(pssm_LO,scale_pos_neg=False) # normal color scale</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-122" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close('all')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="pspa" class="level2">
<h2 class="anchored" data-anchor-id="pspa">PSPA</h2>
<section id="plot-1" class="level3">
<h3 class="anchored" data-anchor-id="plot-1">Plot</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L651" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_pspa" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_pspa">plot_logo_pspa</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_pspa (row, title='Motif', figsize=(5, 2))</code></pre>
</blockquote>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L657" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="plot_logo_heatmap_pspa" class="level3">
<h3 class="anchored" data-anchor-id="plot_logo_heatmap_pspa">plot_logo_heatmap_pspa</h3>
<blockquote class="blockquote">
<pre><code> plot_logo_heatmap_pspa (row, title='Motif', figsize=(6, 10),
                         include_zero=False)</code></pre>
</blockquote>
<p><em>Plot logo and heatmap vertically</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>row</td>
<td></td>
<td></td>
<td>row of Data.get_pspa_all_norm()</td>
</tr>
<tr class="even">
<td>title</td>
<td>str</td>
<td>Motif</td>
<td></td>
</tr>
<tr class="odd">
<td>figsize</td>
<td>tuple</td>
<td>(6, 10)</td>
<td></td>
</tr>
<tr class="even">
<td>include_zero</td>
<td>bool</td>
<td>False</td>
<td></td>
</tr>
</tbody>
</table>
<div id="cell-127" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>pspa<span class="op">=</span> Data.get_pspa_all_norm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-128" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot_logo_heatmap_pspa(pspa.iloc[0],title='kinase')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="calculations" class="level3">
<h3 class="anchored" data-anchor-id="calculations">Calculations</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L678" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="raw2norm" class="level3">
<h3 class="anchored" data-anchor-id="raw2norm">raw2norm</h3>
<blockquote class="blockquote">
<pre><code> raw2norm (df:pandas.core.frame.DataFrame, PDHK:bool=False)</code></pre>
</blockquote>
<p><em>Normalize single ST kinase data</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>DataFrame</td>
<td></td>
<td>single kinase’s df has position as index, and single amino acid as columns</td>
</tr>
<tr class="even">
<td>PDHK</td>
<td>bool</td>
<td>False</td>
<td>whether this kinase belongs to PDHK family</td>
</tr>
</tbody>
</table>
<p>This function implement the normalization method from <a href="https://www.nature.com/articles/s41586-022-05575-3#Sec6">Johnson et al.&nbsp;Nature: An atlas of substrate specificities for the human serine/threonine kinome</a></p>
<p>Specifically, &gt; - matrices were column-normalized at all positions by the sum of the 17 randomized amino acids (excluding serine, threonine and cysteine), to yield PSSMs. &gt;- PDHK1 and PDHK4 were normalized to the 16 randomized amino acids (excluding serine, threonine, cysteine and additionally tyrosine) &gt;- The cysteine row was scaled by its median to be 1/17 (1/16 for PDHK1 and PDHK4). &gt;- The serine and threonine values in each position were set to be the median of that position. &gt;- The S0/T0 ratio was determined by summing the values of S and T rows in the matrix (SS and ST, respectively), accounting for the different S vs.&nbsp;T composition of the central (1:1) and peripheral (only S or only T) positions (Sctrl and Tctrl, respectively), and then normalizing to the higher value among the two (S0 and T0, respectively, Supplementary Note 1)</p>
<p>This function is usually implemented with the below function, with <code>normalize</code> being a bool argument.</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L701" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_one_kinase" class="level3">
<h3 class="anchored" data-anchor-id="get_one_kinase">get_one_kinase</h3>
<blockquote class="blockquote">
<pre><code> get_one_kinase (df:pandas.core.frame.DataFrame, kinase:str,
                 normalize:bool=False, drop_s:bool=True)</code></pre>
</blockquote>
<p><em>Obtain a specific kinase data from stacked dataframe</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 34%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>DataFrame</td>
<td></td>
<td>stacked dataframe (paper’s raw data)</td>
</tr>
<tr class="even">
<td>kinase</td>
<td>str</td>
<td></td>
<td>a specific kinase</td>
</tr>
<tr class="odd">
<td>normalize</td>
<td>bool</td>
<td>False</td>
<td>normalize according to the paper; special for PDHK1/4</td>
</tr>
<tr class="even">
<td>drop_s</td>
<td>bool</td>
<td>True</td>
<td>drop s as s is a duplicates of t in PSPA</td>
</tr>
</tbody>
</table>
<p>Retreive a single kinase data from PSPA data that has an format of kinase as index and position+amino acid as column.</p>
<div id="cell-134" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> Data.get_pspa_st_norm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-135" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>get_one_kinase(data,<span class="st">'PDHK1'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">aa</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
<th data-quarto-table-cell-role="th">E</th>
<th data-quarto-table-cell-role="th">F</th>
<th data-quarto-table-cell-role="th">G</th>
<th data-quarto-table-cell-role="th">H</th>
<th data-quarto-table-cell-role="th">I</th>
<th data-quarto-table-cell-role="th">K</th>
<th data-quarto-table-cell-role="th">L</th>
<th data-quarto-table-cell-role="th">M</th>
<th data-quarto-table-cell-role="th">N</th>
<th data-quarto-table-cell-role="th">P</th>
<th data-quarto-table-cell-role="th">Q</th>
<th data-quarto-table-cell-role="th">R</th>
<th data-quarto-table-cell-role="th">S</th>
<th data-quarto-table-cell-role="th">T</th>
<th data-quarto-table-cell-role="th">V</th>
<th data-quarto-table-cell-role="th">W</th>
<th data-quarto-table-cell-role="th">Y</th>
<th data-quarto-table-cell-role="th">t</th>
<th data-quarto-table-cell-role="th">y</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">position</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">-5</th>
<td>0.0594</td>
<td>0.0625</td>
<td>0.0589</td>
<td>0.0550</td>
<td>0.0775</td>
<td>0.0697</td>
<td>0.0687</td>
<td>0.0590</td>
<td>0.0515</td>
<td>0.0657</td>
<td>0.0687</td>
<td>0.0613</td>
<td>0.0451</td>
<td>0.0424</td>
<td>0.0594</td>
<td>0.0594</td>
<td>0.0594</td>
<td>0.0573</td>
<td>0.1001</td>
<td>0.0775</td>
<td>0.0583</td>
<td>0.0658</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">-4</th>
<td>0.0618</td>
<td>0.0621</td>
<td>0.0550</td>
<td>0.0511</td>
<td>0.0739</td>
<td>0.0715</td>
<td>0.0598</td>
<td>0.0601</td>
<td>0.0520</td>
<td>0.0614</td>
<td>0.0744</td>
<td>0.0549</td>
<td>0.0637</td>
<td>0.0552</td>
<td>0.0617</td>
<td>0.0608</td>
<td>0.0608</td>
<td>0.0519</td>
<td>0.0916</td>
<td>0.0739</td>
<td>0.0528</td>
<td>0.0752</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>0.0486</td>
<td>0.0609</td>
<td>0.0938</td>
<td>0.0684</td>
<td>0.1024</td>
<td>0.0676</td>
<td>0.0544</td>
<td>0.0583</td>
<td>0.0388</td>
<td>0.0552</td>
<td>0.0637</td>
<td>0.0505</td>
<td>0.0686</td>
<td>0.0502</td>
<td>0.0561</td>
<td>0.0588</td>
<td>0.0588</td>
<td>0.0593</td>
<td>0.0641</td>
<td>0.1024</td>
<td>0.0539</td>
<td>0.0431</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>0.0565</td>
<td>0.0749</td>
<td>0.0631</td>
<td>0.0535</td>
<td>0.0732</td>
<td>0.0655</td>
<td>0.0664</td>
<td>0.0625</td>
<td>0.0496</td>
<td>0.0552</td>
<td>0.0627</td>
<td>0.0640</td>
<td>0.0677</td>
<td>0.0553</td>
<td>0.0604</td>
<td>0.0626</td>
<td>0.0626</td>
<td>0.0579</td>
<td>0.0864</td>
<td>0.0732</td>
<td>0.0548</td>
<td>0.0575</td>
</tr>
</tbody>
</table>

<p>10 rows × 22 columns</p>
</div>
</div>
</div>
<div id="cell-136" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>pspa<span class="op">=</span>Data.get_pspa_all_norm()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="plot-pspa-logo-motif-old" class="level3">
<h3 class="anchored" data-anchor-id="plot-pspa-logo-motif-old">Plot PSPA logo motif (old)</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L722" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="get_logo" class="level3">
<h3 class="anchored" data-anchor-id="get_logo">get_logo</h3>
<blockquote class="blockquote">
<pre><code> get_logo (df:pandas.core.frame.DataFrame, kinase:str)</code></pre>
</blockquote>
<p><em>Given stacked df (index as kinase, columns as substrates), get a specific kinase’s logo</em></p>
<table class="caption-top table">
<colgroup>
<col style="width: 9%">
<col style="width: 38%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>df</td>
<td>DataFrame</td>
<td>stacked Dataframe with kinase as index, substrates as columns</td>
</tr>
<tr class="even">
<td>kinase</td>
<td>str</td>
<td>a specific kinase name in index</td>
</tr>
</tbody>
</table>
<p>This function is to replicate the motif logo from <a href="https://www.nature.com/articles/s41586-022-05575-3">Johnson et al.&nbsp;Nature: An atlas of substrate specificities for the human serine/threonine kinome</a>. Given raw PSPA data, it can output a motif logo.</p>
<div id="cell-140" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-141" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load raw PSPA data</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'https://github.com/sky1ove/katlas_raw/raw/refs/heads/main/nbs/raw/pspa_st_raw.csv'</span>).set_index(<span class="st">'kinase'</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">-5P</th>
<th data-quarto-table-cell-role="th">-5G</th>
<th data-quarto-table-cell-role="th">-5A</th>
<th data-quarto-table-cell-role="th">-5C</th>
<th data-quarto-table-cell-role="th">-5S</th>
<th data-quarto-table-cell-role="th">-5T</th>
<th data-quarto-table-cell-role="th">-5V</th>
<th data-quarto-table-cell-role="th">-5I</th>
<th data-quarto-table-cell-role="th">-5L</th>
<th data-quarto-table-cell-role="th">-5M</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">4H</th>
<th data-quarto-table-cell-role="th">4K</th>
<th data-quarto-table-cell-role="th">4R</th>
<th data-quarto-table-cell-role="th">4Q</th>
<th data-quarto-table-cell-role="th">4N</th>
<th data-quarto-table-cell-role="th">4D</th>
<th data-quarto-table-cell-role="th">4E</th>
<th data-quarto-table-cell-role="th">4s</th>
<th data-quarto-table-cell-role="th">4t</th>
<th data-quarto-table-cell-role="th">4y</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">kinase</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">AAK1</th>
<td>7614134.38</td>
<td>2590563.43</td>
<td>3001315.49</td>
<td>4696631.43</td>
<td>4944311.77</td>
<td>8315837.72</td>
<td>10056545.00</td>
<td>16433061.43</td>
<td>10499735.53</td>
<td>9133577.86</td>
<td>...</td>
<td>6020662.73</td>
<td>8938081.41</td>
<td>9983402.01</td>
<td>6833481.55</td>
<td>6364453.29</td>
<td>4189045.89</td>
<td>4921595.57</td>
<td>2705053.53</td>
<td>2705053.53</td>
<td>2909279.71</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">ACVR2A</th>
<td>4991039.28</td>
<td>5783855.86</td>
<td>7015770.78</td>
<td>8367603.09</td>
<td>7072052.48</td>
<td>7601399.57</td>
<td>7188292.41</td>
<td>7513915.73</td>
<td>7159894.71</td>
<td>6266122.81</td>
<td>...</td>
<td>6039472.76</td>
<td>5556300.56</td>
<td>5178734.62</td>
<td>6490097.70</td>
<td>5862480.97</td>
<td>6742905.78</td>
<td>6750653.36</td>
<td>7414220.16</td>
<td>7414220.16</td>
<td>6209576.97</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">ACVR2B</th>
<td>26480329.10</td>
<td>25689687.16</td>
<td>28137300.90</td>
<td>45175909.30</td>
<td>32876722.90</td>
<td>33516959.03</td>
<td>27011194.06</td>
<td>21996255.94</td>
<td>23412987.54</td>
<td>25670581.40</td>
<td>...</td>
<td>27984195.21</td>
<td>22496915.32</td>
<td>24236904.72</td>
<td>29132857.30</td>
<td>26527389.14</td>
<td>36388726.15</td>
<td>34729319.54</td>
<td>37906081.09</td>
<td>37906081.09</td>
<td>31761418.56</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">AKT1</th>
<td>18399509.29</td>
<td>18104681.05</td>
<td>16831835.48</td>
<td>17247743.90</td>
<td>22647275.57</td>
<td>17801288.32</td>
<td>13037570.99</td>
<td>13271896.32</td>
<td>14156489.52</td>
<td>15409761.84</td>
<td>...</td>
<td>29511541.69</td>
<td>50942663.29</td>
<td>48152924.11</td>
<td>32693882.62</td>
<td>28896602.57</td>
<td>19701350.30</td>
<td>13887460.52</td>
<td>17483074.60</td>
<td>17483074.60</td>
<td>11696833.54</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">AKT2</th>
<td>5439237.54</td>
<td>5569477.23</td>
<td>5805462.70</td>
<td>6301076.01</td>
<td>5004932.12</td>
<td>4812022.80</td>
<td>3906822.27</td>
<td>3776845.45</td>
<td>4450344.85</td>
<td>4629319.80</td>
<td>...</td>
<td>6812201.58</td>
<td>11590683.50</td>
<td>9932525.89</td>
<td>6544476.93</td>
<td>6252360.75</td>
<td>3629091.99</td>
<td>3510048.19</td>
<td>5499662.30</td>
<td>5499662.30</td>
<td>4188620.88</td>
</tr>
</tbody>
</table>

<p>5 rows × 207 columns</p>
</div>
</div>
</div>
<div id="cell-142" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># # plot logo of a kinase</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># get_logo(df, 'AAK1')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-143" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plt.close('all')</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
</section>
<section id="compare-pssm" class="level2">
<h2 class="anchored" data-anchor-id="compare-pssm">Compare PSSM</h2>
<div id="cell-145" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>pssms <span class="op">=</span> Data.get_pspa_all_scale()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div id="cell-146" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># one example</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>pssm_df <span class="op">=</span> recover_pssm(pssms.iloc[<span class="dv">1</span>])</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>pssm_df2 <span class="op">=</span> recover_pssm(pssms.iloc[<span class="dv">0</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="kl-divergence" class="level3">
<h3 class="anchored" data-anchor-id="kl-divergence">KL divergence</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L762" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kl_divergence" class="level3">
<h3 class="anchored" data-anchor-id="kl_divergence">kl_divergence</h3>
<blockquote class="blockquote">
<pre><code> kl_divergence (p1, p2)</code></pre>
</blockquote>
<p>*KL divergence D_KL(p1 || p2) over positions.</p>
<p>p1 and p2 are arrays (df or np) with index as aa and column as position. Returns average divergence across positions if mean=True, else per-position.*</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p1</td>
<td>target pssm p (array-like, shape: (AA, positions))</td>
</tr>
<tr class="even">
<td>p2</td>
<td>pred pssm q (array-like, same shape as p1)</td>
</tr>
</tbody>
</table>
<p>The Kullback–Leibler (KL) divergence between two probability distributions ( P ) and ( Q ) is defined as:</p>
<p><span class="math display">\[
\mathrm{KL}(P \| Q) = \sum_{x \in \mathcal{X}} P(x) \log \left( \frac{P(x)}{Q(x)} \right)
\]</span></p>
<p>This measures the information lost when ( Q ) is used to approximate ( P ). It is <strong>not symmetric</strong>, i.e.,</p>
<p><span class="math display">\[
\mathrm{KL}(P \| Q) \ne \mathrm{KL}(Q \| P)
\]</span></p>
<p>and it is <strong>non-negative</strong>, meaning:</p>
<p><span class="math display">\[
\mathrm{KL}(P \| Q) \ge 0
\]</span></p>
<p>with equality if and only if ( P = Q ) almost everywhere.</p>
<p>In practical computation, to avoid numerical instability when ( P(x) = 0 ) or ( Q(x) = 0 ), we often add a small constant ( ):</p>
<p><span class="math display">\[
\mathrm{KL}_\varepsilon(P \| Q) = \sum_{x \in \mathcal{X}} P(x) \log \left( \frac{P(x) + \varepsilon}{Q(x) + \varepsilon} \right)
\]</span></p>
<div id="cell-150" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>kl_divergence(pssm_df,pssm_df2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>array([0.29182172, 0.11138481, 0.24590698, 0.46021635, 0.36874823,
       0.53858511, 1.51571614, 0.02905442, 0.08530757, 0.07753394])</code></pre>
</div>
</div>
<div id="cell-151" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>kl_divergence(pssm_df,pssm_df2).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(0.37242752573216287)</code></pre>
</div>
</div>
<div id="cell-152" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>kl_divergence(pssm_df,pssm_df2).<span class="bu">max</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(1.5157161422110503)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L784" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="kl_divergence_flat" class="level3">
<h3 class="anchored" data-anchor-id="kl_divergence_flat">kl_divergence_flat</h3>
<blockquote class="blockquote">
<pre><code> kl_divergence_flat (p1_flat, p2_flat)</code></pre>
</blockquote>
<p><em>p1 and p2 are two flattened pd.Series with index as aa and column as position</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p1_flat</td>
<td>pd.Series of target flattened pssm p</td>
</tr>
<tr class="even">
<td>p2_flat</td>
<td>pd.Series of pred flattened pssm q</td>
</tr>
</tbody>
</table>
<div id="cell-154" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>kl_divergence_flat(pssms.iloc[<span class="dv">1</span>],pssms.iloc[<span class="dv">0</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 1.37 ms, sys: 0 ns, total: 1.37 ms
Wall time: 1.37 ms</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>0.37242752573216287</code></pre>
</div>
</div>
</section>
<section id="js-divergence" class="level3">
<h3 class="anchored" data-anchor-id="js-divergence">JS divergence</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L794" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="js_divergence" class="level3">
<h3 class="anchored" data-anchor-id="js_divergence">js_divergence</h3>
<blockquote class="blockquote">
<pre><code> js_divergence (p1, p2, index=True)</code></pre>
</blockquote>
<p><em>p1 and p2 are two arrays (df or np) with index as aa and column as position</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p1</td>
<td></td>
<td></td>
<td>pssm</td>
</tr>
<tr class="even">
<td>p2</td>
<td></td>
<td></td>
<td>pssm</td>
</tr>
<tr class="odd">
<td>index</td>
<td>bool</td>
<td>True</td>
<td></td>
</tr>
</tbody>
</table>
<p>The Jensen-Shannon divergence between two probability distributions $ P $ and $ Q $ is defined as:</p>
<p><span class="math display">\[
\mathrm{JS}(P \| Q) = \frac{1}{2} \, \mathrm{KL}(P \| M) + \frac{1}{2} \, \mathrm{KL}(Q \| M)
\]</span></p>
<p>where $ M = (P + Q) $ is the average (mixture) distribution, and $ $ denotes the Kullback–Leibler divergence:</p>
<p><span class="math display">\[
\mathrm{KL}(P \| Q) = \sum_{x \in \mathcal{X}} P(x) \log \left( \frac{P(x)}{Q(x)} \right)
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\mathrm{JS}_\varepsilon(P \| Q) = \frac{1}{2} \sum_{x \in \mathcal{X}} P(x) \log \left( \frac{P(x) + \varepsilon}{M(x) + \varepsilon} \right)
+ \frac{1}{2} \sum_{x \in \mathcal{X}} Q(x) \log \left( \frac{Q(x) + \varepsilon}{M(x) + \varepsilon} \right)
\]</span></p>
<div id="cell-158" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>js_divergence(pssm_df,pssm_df2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
-5    0.065539
-4    0.025712
        ...   
 3    0.020949
 4    0.018206
Length: 10, dtype: float64</code></pre>
</div>
</div>
<div id="cell-159" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>js_divergence(pssm_df,pssm_df2).<span class="bu">max</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(0.34404931056288773)</code></pre>
</div>
</div>
<div id="cell-160" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>js_divergence(pssm_df,pssm_df2).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(0.08286124552178498)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L813" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="js_divergence_flat" class="level3">
<h3 class="anchored" data-anchor-id="js_divergence_flat">js_divergence_flat</h3>
<blockquote class="blockquote">
<pre><code> js_divergence_flat (p1_flat, p2_flat)</code></pre>
</blockquote>
<p><em>p1 and p2 are two flattened pd.Series with index as aa and column as position</em></p>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>p1_flat</td>
<td>pd.Series of flattened pssm</td>
</tr>
<tr class="even">
<td>p2_flat</td>
<td>pd.Series of flattened pssm</td>
</tr>
</tbody>
</table>
<div id="cell-162" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>js_divergence_flat(pssms.iloc[<span class="dv">1</span>],pssms.iloc[<span class="dv">0</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: user 1.26 ms, sys: 0 ns, total: 1.26 ms
Wall time: 1.26 ms</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>0.08286124552178498</code></pre>
</div>
</div>
</section>
<section id="js-similarity" class="level3">
<h3 class="anchored" data-anchor-id="js-similarity">JS similarity</h3>
<p>To convert the Jensen–Shannon divergence into a similarity measure, we first normalize it to bits by dividing by log(2), ensuring that the divergence lies within the range [0, 1]. <span class="math display">\[
\mathrm{JS}_{\text{bits}}(P \| Q) = \frac{\mathrm{JS}(P \| Q)}{\log 2}
\]</span></p>
<p>The similarity is then defined as one minus this normalized divergence: <span class="math display">\[
\mathrm{Sim}_{\mathrm{JS}}(P, Q) = 1 - \mathrm{JS}_{\text{bits}}(P \| Q)
\]</span></p>
<p>Thus, <span class="math inline">\(\mathrm{Sim}_{\mathrm{JS}}\)</span> ranges from 0 (completely dissimilar) to 1 (identical distributions).</p>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L823" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="js_similarity" class="level3">
<h3 class="anchored" data-anchor-id="js_similarity">js_similarity</h3>
<blockquote class="blockquote">
<pre><code> js_similarity (pssm1, pssm2)</code></pre>
</blockquote>
<p><em>Convert JSD to bits to be in range (0,1) then 1-JSD.</em></p>
<div id="cell-166" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>js_similarity(pssm_df,pssm_df2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>Position
-5    0.905448
-4    0.962905
        ...   
 3    0.969777
 4    0.973734
Length: 10, dtype: float64</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L830" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="js_similarity_flat" class="level3">
<h3 class="anchored" data-anchor-id="js_similarity_flat">js_similarity_flat</h3>
<blockquote class="blockquote">
<pre><code> js_similarity_flat (p1_flat, p2_flat)</code></pre>
</blockquote>
<p><em>Convert JSD to bits to be in range (0,1) then 1-JSD.</em></p>
<div id="cell-168" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| export</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a><span class="co"># def weighted_js_similarity(pssm1,pssm2):</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a><span class="co">#     pssm = (pssm1+pssm2)/2</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="co">#     ic = get_IC(pssm)</span></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a><span class="co">#     similarity = js_similarity(pssm1,pssm2)</span></span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a><span class="co">#     return (ic*similarity)/ic.sum()</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cosine-similarity" class="level3">
<h3 class="anchored" data-anchor-id="cosine-similarity">Cosine similarity</h3>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L835" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cosine_similarity" class="level3">
<h3 class="anchored" data-anchor-id="cosine_similarity">cosine_similarity</h3>
<blockquote class="blockquote">
<pre><code> cosine_similarity (pssm1:pandas.core.frame.DataFrame,
                    pssm2:pandas.core.frame.DataFrame)</code></pre>
</blockquote>
<p><em>Compute cosine similarity per position (column) between two PSSMs.</em></p>
<p>The cosine similarity between two vectors ( P ) and ( Q ) (e.g., two PSSM columns representing amino acid probability distributions) is defined as:</p>
<p><span class="math display">\[
\mathrm{cos}(P, Q) = \frac{P \cdot Q}{\|P\| \, \|Q\|}
\]</span></p>
<p>where $ P Q = _{i=1}^{n} P_i Q_i $ is the dot product between $ P $ and $ Q $, and $ |P| = $ is the Euclidean norm of $ P $.</p>
<p>Since all entries of $ P $ and $ Q $ are nonnegative probabilities (i.e., $ P_i, Q_i $), the cosine similarity lies within the range:</p>
<p><span class="math display">\[
0 \leq \mathrm{cos}(P, Q) \leq 1
\]</span></p>
<p>Given that pssm are probabilities between 0 and 1, cosine similarity is within (0,1)</p>
<div id="cell-173" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cosine_similarity(pssm_df,pssm_df2).sort_values()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code> 1    0.130818
-2    0.606234
        ...   
 4    0.934967
 2    0.971066
Length: 10, dtype: float64</code></pre>
</div>
</div>
<div id="cell-174" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>cosine_similarity(pssm_df,pssm_df2).mean()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(0.754148470457778)</code></pre>
</div>
</div>
<hr>
<p><a href="https://github.com/sky1ove/katlas/blob/main/katlas/pssm.py#L858" target="_blank" style="float:right; font-size:smaller">source</a></p>
</section>
<section id="cosine_overall_flat" class="level3">
<h3 class="anchored" data-anchor-id="cosine_overall_flat">cosine_overall_flat</h3>
<blockquote class="blockquote">
<pre><code> cosine_overall_flat (pssm1_flat, pssm2_flat)</code></pre>
</blockquote>
<p><em>Compute overall cosine similarity between two PSSMs (flattened).</em></p>
<div id="cell-176" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb160"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>cosine_overall_flat(pssms.iloc[<span class="dv">0</span>],pssms.iloc[<span class="dv">0</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(1.0000000000000004)</code></pre>
</div>
</div>
<div id="cell-177" class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb162"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>cosine_overall_flat(pssms.iloc[<span class="dv">0</span>],pssms.iloc[<span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(0.6614783212500965)</code></pre>
</div>
</div>
</section>
</section>
<section id="end" class="level2">
<h2 class="anchored" data-anchor-id="end">End</h2>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/sky1ove\.github\.io\/katlas");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/sky1ove/katlas/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer></body></html>